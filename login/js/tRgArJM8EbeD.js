!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="766f355a-196a-4b8b-8a53-a27db81d32e0",e._sentryDebugIdIdentifier="sentry-dbid-766f355a-196a-4b8b-8a53-a27db81d32e0")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8023],{29624:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,n=i(22831),o=i(25543),a=(r=i(88005))&&"object"==typeof r&&"default"in r?r.default:r,s=i(54851),l=function(e,t){return(l=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)};function u(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}var c=function(){return(c=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function d(e,t,i,r){return new(i||(i=Promise))(function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((r=r.apply(e,t||[])).next())})}function p(e,t){var i,r,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(l){return function(s){if(i)throw TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(i=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){a.label=s[1];break}if(6===s[0]&&a.label<n[1]){a.label=n[1],n=s;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(s);break}n[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{i=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}function f(e,t,i){if(i||2==arguments.length)for(var r,n=0,o=t.length;n<o;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))}"function"==typeof SuppressedError&&SuppressedError;var h=new(function(){function e(){}return e.prototype.handleError=function(e){},e}());function g(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(!e)return{};if("function"==typeof Object.assign)return Object.assign.apply(Object,f([e],t,!1));for(var r=Object(e),n=0;n<t.length;n++){var o=t[n];if(null!=o)for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(r[a]=o[a])}return r}function m(e,t){var i,r,n;return e?(i=e,r=function(e){return e[t]},n={},i.forEach(function(e){n[r(e)]=e}),n):{}}function E(){return n.v4()}function _(e,t){for(var i=!1,r=Object.keys(e),n=0;n<r.length;n++)if(t===e[r[n]]){i=!0;break}return i}function v(e){return Object.keys(e).map(function(t){return e[t]})}function y(e,t){for(var i,r=0;r<e.length;r++){var n=e[r];if(t(n)){i=n;break}}return i}function b(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var r=0;return e.replace(/%s/g,function(){var e=t[r++],i=typeof e;return"function"===i?e():"string"===i?e:String(e)})}var I,O={assign:g,currentTimestamp:function(){return Math.round((new Date).getTime())},isSafeInteger:function(e){return"number"==typeof e&&0x20000000000000>=Math.abs(e)},uuid:E,isNumber:function(e){return"number"==typeof e}};(I=t.LogLevel||(t.LogLevel={}))[I.NOTSET=0]="NOTSET",I[I.DEBUG=1]="DEBUG",I[I.INFO=2]="INFO",I[I.WARNING=3]="WARNING",I[I.ERROR=4]="ERROR";var R={NOTSET:0,DEBUG:1,INFO:2,WARNING:3,ERROR:4};function N(e){return"string"!=typeof e?e:("WARN"===(e=e.toUpperCase())&&(e="WARNING"),R[e]?R[e]:e)}var T=function(){function e(){this.defaultLoggerFacade=new w,this.loggers={}}return e.prototype.getLogger=function(e){return e?(this.loggers[e]||(this.loggers[e]=new w({messagePrefix:e})),this.loggers[e]):this.defaultLoggerFacade},e}(),A=function(){function e(e){void 0===e&&(e={}),this.logLevel=t.LogLevel.NOTSET,void 0!==e.logLevel&&_(t.LogLevel,e.logLevel)&&this.setLogLevel(e.logLevel),this.logToConsole=void 0===e.logToConsole||!!e.logToConsole,this.prefix=void 0!==e.prefix?e.prefix:"[OPTIMIZELY]"}return e.prototype.log=function(e,t){if(this.shouldLog(e)&&this.logToConsole){var i="".concat(this.prefix," - ").concat(this.getLogLevelName(e)," ").concat(this.getTime()," ").concat(t);this.consoleLog(e,[i])}},e.prototype.setLogLevel=function(e){e=N(e),_(t.LogLevel,e)&&void 0!==e?this.logLevel=e:this.logLevel=t.LogLevel.ERROR},e.prototype.getTime=function(){return(new Date).toISOString()},e.prototype.shouldLog=function(e){return e>=this.logLevel},e.prototype.getLogLevelName=function(e){switch(e){case t.LogLevel.DEBUG:return"DEBUG";case t.LogLevel.INFO:return"INFO ";case t.LogLevel.WARNING:return"WARN ";case t.LogLevel.ERROR:return"ERROR";default:return"NOTSET"}},e.prototype.consoleLog=function(e,i){switch(e){case t.LogLevel.DEBUG:console.log.apply(console,i);break;case t.LogLevel.INFO:console.info.apply(console,i);break;case t.LogLevel.WARNING:console.warn.apply(console,i);break;case t.LogLevel.ERROR:console.error.apply(console,i);break;default:console.log.apply(console,i)}},e}(),D=t.LogLevel.NOTSET,S=null,w=function(){function e(e){void 0===e&&(e={}),this.messagePrefix="",e.messagePrefix&&(this.messagePrefix=e.messagePrefix)}return e.prototype.log=function(e,t){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];this.internalLog(N(e),{message:t,splat:i})},e.prototype.info=function(e){for(var i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];this.namedLog(t.LogLevel.INFO,e,i)},e.prototype.debug=function(e){for(var i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];this.namedLog(t.LogLevel.DEBUG,e,i)},e.prototype.warn=function(e){for(var i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];this.namedLog(t.LogLevel.WARNING,e,i)},e.prototype.error=function(e){for(var i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];this.namedLog(t.LogLevel.ERROR,e,i)},e.prototype.format=function(e){return"".concat(this.messagePrefix?this.messagePrefix+": ":"").concat(b.apply(void 0,f([e.message],e.splat,!1)))},e.prototype.internalLog=function(e,t){S&&(e<D||(S.log(e,this.format(t)),t.error&&t.error instanceof Error&&h.handleError(t.error)))},e.prototype.namedLog=function(e,t,i){var r;if(t instanceof Error)return t=(r=t).message,void this.internalLog(e,{error:r,message:t,splat:i});if(0!==i.length){var n=i[i.length-1];n instanceof Error&&(r=n,i.splice(-1)),this.internalLog(e,{message:t,error:r,splat:i})}else this.internalLog(e,{message:t,splat:i})},e}(),L=new T;function U(e){return L.getLogger(e)}function C(e){S=e}var x={setLogLevel:function(e){e=N(e),D=_(t.LogLevel,e)&&void 0!==e?e:t.LogLevel.ERROR},setLogHandler:C};function P(e,t){var i=e.context,r=t.context;return i.accountId===r.accountId&&i.projectId===r.projectId&&i.clientName===r.clientName&&i.clientVersion===r.clientVersion&&i.revision===r.revision&&i.anonymizeIP===r.anonymizeIP&&i.botFiltering===r.botFiltering}var z,k=U("EventProcessor"),M=function(){function e(e){var t=e.timeout,i=e.callback;this.timeout=Math.max(t,0),this.callback=i}return e.prototype.start=function(){this.timeoutId=setTimeout(this.callback,this.timeout)},e.prototype.refresh=function(){this.stop(),this.start()},e.prototype.stop=function(){this.timeoutId&&clearTimeout(this.timeoutId)},e}(),V=function(){function e(e){var t=e.sink;this.sink=t}return e.prototype.start=function(){return Promise.resolve()},e.prototype.stop=function(){return Promise.resolve()},e.prototype.enqueue=function(e){this.sink([e])},e}(),F=function(){function e(e){var t=e.flushInterval,i=e.maxQueueSize,r=e.sink,n=e.closingSink,o=e.batchComparator;this.buffer=[],this.maxQueueSize=Math.max(i,1),this.sink=r,this.closingSink=n,this.batchComparator=o,this.timer=new M({callback:this.flush.bind(this),timeout:t}),this.started=!1}return e.prototype.start=function(){return this.started=!0,Promise.resolve()},e.prototype.stop=function(){this.started=!1;var e=this.closingSink?this.closingSink(this.buffer):this.sink(this.buffer);return this.buffer=[],this.timer.stop(),e},e.prototype.enqueue=function(e){if(this.started){var t=this.buffer[0];t&&!this.batchComparator(t,e)&&this.flush(),0===this.buffer.length&&this.timer.refresh(),this.buffer.push(e),this.buffer.length>=this.maxQueueSize&&this.flush()}else k.warn("Queue is stopped, not accepting event")},e.prototype.flush=function(){this.sink(this.buffer),this.buffer=[],this.timer.stop()},e}(),j={NOTSET:0,DEBUG:1,INFO:2,WARNING:3,ERROR:4},B={BROWSER_ODP_MANAGER_INITIALIZATION_FAILED:"%s: Error initializing Browser ODP Manager.",CONDITION_EVALUATOR_ERROR:"%s: Error evaluating audience condition of type %s: %s",DATAFILE_AND_SDK_KEY_MISSING:"%s: You must provide at least one of sdkKey or datafile. Cannot start Optimizely",EXPERIMENT_KEY_NOT_IN_DATAFILE:"%s: Experiment key %s is not in datafile.",FEATURE_NOT_IN_DATAFILE:"%s: Feature key %s is not in datafile.",FETCH_SEGMENTS_FAILED_NETWORK_ERROR:"%s: Audience segments fetch failed. (network error)",FETCH_SEGMENTS_FAILED_DECODE_ERROR:"%s: Audience segments fetch failed. (decode error)",IMPROPERLY_FORMATTED_EXPERIMENT:"%s: Experiment key %s is improperly formatted.",INVALID_ATTRIBUTES:"%s: Provided attributes are in an invalid format.",INVALID_BUCKETING_ID:"%s: Unable to generate hash for bucketing ID %s: %s",INVALID_DATAFILE:"%s: Datafile is invalid - property %s: %s",INVALID_DATAFILE_MALFORMED:"%s: Datafile is invalid because it is malformed.",INVALID_CONFIG:"%s: Provided Optimizely config is in an invalid format.",INVALID_JSON:"%s: JSON object is not valid.",INVALID_ERROR_HANDLER:'%s: Provided "errorHandler" is in an invalid format.',INVALID_EVENT_DISPATCHER:'%s: Provided "eventDispatcher" is in an invalid format.',INVALID_EVENT_TAGS:"%s: Provided event tags are in an invalid format.",INVALID_EXPERIMENT_KEY:"%s: Experiment key %s is not in datafile. It is either invalid, paused, or archived.",INVALID_EXPERIMENT_ID:"%s: Experiment ID %s is not in datafile.",INVALID_GROUP_ID:"%s: Group ID %s is not in datafile.",INVALID_LOGGER:'%s: Provided "logger" is in an invalid format.',INVALID_ROLLOUT_ID:"%s: Invalid rollout ID %s attached to feature %s",INVALID_USER_ID:"%s: Provided user ID is in an invalid format.",INVALID_USER_PROFILE_SERVICE:"%s: Provided user profile service instance is in an invalid format: %s.",LOCAL_STORAGE_DOES_NOT_EXIST:"Error accessing window localStorage.",MISSING_INTEGRATION_KEY:"%s: Integration key missing from datafile. All integrations should include a key.",NO_DATAFILE_SPECIFIED:"%s: No datafile specified. Cannot start optimizely.",NO_JSON_PROVIDED:"%s: No JSON object to validate against schema.",NO_VARIATION_FOR_EXPERIMENT_KEY:"%s: No variation key %s defined in datafile for experiment %s.",ODP_CONFIG_NOT_AVAILABLE:"%s: ODP is not integrated to the project.",ODP_EVENT_FAILED:"ODP event send failed.",ODP_FETCH_QUALIFIED_SEGMENTS_SEGMENTS_MANAGER_MISSING:"%s: ODP unable to fetch qualified segments (Segments Manager not initialized).",ODP_IDENTIFY_FAILED_EVENT_MANAGER_MISSING:"%s: ODP identify event %s is not dispatched (Event Manager not instantiated).",ODP_INITIALIZATION_FAILED:"%s: ODP failed to initialize.",ODP_INVALID_DATA:"%s: ODP data is not valid",ODP_EVENT_FAILED_ODP_MANAGER_MISSING:"%s: ODP Event failed to send. (ODP Manager not initialized).",ODP_FETCH_QUALIFIED_SEGMENTS_FAILED_ODP_MANAGER_MISSING:"%s: ODP failed to Fetch Qualified Segments. (ODP Manager not initialized).",ODP_IDENTIFY_USER_FAILED_ODP_MANAGER_MISSING:"%s: ODP failed to Identify User. (ODP Manager not initialized).",ODP_IDENTIFY_USER_FAILED_USER_CONTEXT_INITIALIZATION:"%s: ODP failed to Identify User. (Failed during User Context Initialization).",ODP_MANAGER_UPDATE_SETTINGS_FAILED_EVENT_MANAGER_MISSING:"%s: ODP Manager failed to update OdpConfig settings for internal event manager. (Event Manager not initialized).",ODP_MANAGER_UPDATE_SETTINGS_FAILED_SEGMENTS_MANAGER_MISSING:"%s: ODP Manager failed to update OdpConfig settings for internal segments manager. (Segments Manager not initialized).",ODP_NOT_ENABLED:"ODP is not enabled",ODP_NOT_INTEGRATED:"%s: ODP is not integrated",ODP_SEND_EVENT_FAILED_EVENT_MANAGER_MISSING:"%s: ODP send event %s was not dispatched (Event Manager not instantiated).",ODP_SEND_EVENT_FAILED_UID_MISSING:"%s: ODP send event %s was not dispatched (No valid user identifier provided).",ODP_SEND_EVENT_FAILED_VUID_MISSING:"%s: ODP send event %s was not dispatched (Unable to fetch VUID).",ODP_VUID_INITIALIZATION_FAILED:"%s: ODP VUID initialization failed.",ODP_VUID_REGISTRATION_FAILED:"%s: ODP VUID failed to be registered.",ODP_VUID_REGISTRATION_FAILED_EVENT_MANAGER_MISSING:"%s: ODP register vuid failed. (Event Manager not instantiated).",UNDEFINED_ATTRIBUTE:"%s: Provided attribute: %s has an undefined value.",UNRECOGNIZED_ATTRIBUTE:"%s: Unrecognized attribute %s provided. Pruning before sending event to Optimizely.",UNABLE_TO_CAST_VALUE:"%s: Unable to cast value %s to type %s, returning null.",USER_NOT_IN_FORCED_VARIATION:"%s: User %s is not in the forced variation map. Cannot remove their forced variation.",USER_PROFILE_LOOKUP_ERROR:'%s: Error while looking up user profile for user ID "%s": %s.',USER_PROFILE_SAVE_ERROR:'%s: Error while saving user profile for user ID "%s": %s.',VARIABLE_KEY_NOT_IN_DATAFILE:'%s: Variable with key "%s" associated with feature with key "%s" is not in datafile.',VARIATION_ID_NOT_IN_DATAFILE:"%s: No variation ID %s defined in datafile for experiment %s.",VARIATION_ID_NOT_IN_DATAFILE_NO_EXPERIMENT:"%s: Variation ID %s is not in the datafile.",INVALID_INPUT_FORMAT:"%s: Provided %s is in an invalid format.",INVALID_DATAFILE_VERSION:"%s: This version of the JavaScript SDK does not support the given datafile version: %s",INVALID_VARIATION_KEY:"%s: Provided variation key is in an invalid format."},G={ACTIVATE_USER:"%s: Activating user %s in experiment %s.",DISPATCH_CONVERSION_EVENT:"%s: Dispatching conversion event to URL %s with params %s.",DISPATCH_IMPRESSION_EVENT:"%s: Dispatching impression event to URL %s with params %s.",DEPRECATED_EVENT_VALUE:"%s: Event value is deprecated in %s call.",EVENT_KEY_NOT_FOUND:"%s: Event key %s is not in datafile.",EXPERIMENT_NOT_RUNNING:"%s: Experiment %s is not running.",FEATURE_ENABLED_FOR_USER:"%s: Feature %s is enabled for user %s.",FEATURE_NOT_ENABLED_FOR_USER:"%s: Feature %s is not enabled for user %s.",FEATURE_HAS_NO_EXPERIMENTS:"%s: Feature %s is not attached to any experiments.",FAILED_TO_PARSE_VALUE:'%s: Failed to parse event value "%s" from event tags.',FAILED_TO_PARSE_REVENUE:'%s: Failed to parse revenue value "%s" from event tags.',FORCED_BUCKETING_FAILED:"%s: Variation key %s is not in datafile. Not activating user %s.",INVALID_OBJECT:"%s: Optimizely object is not valid. Failing %s.",INVALID_CLIENT_ENGINE:"%s: Invalid client engine passed: %s. Defaulting to node-sdk.",INVALID_DEFAULT_DECIDE_OPTIONS:"%s: Provided default decide options is not an array.",INVALID_DECIDE_OPTIONS:"%s: Provided decide options is not an array. Using default decide options.",INVALID_VARIATION_ID:"%s: Bucketed into an invalid variation ID. Returning null.",NOTIFICATION_LISTENER_EXCEPTION:"%s: Notification listener for (%s) threw exception: %s",NO_ROLLOUT_EXISTS:"%s: There is no rollout of feature %s.",NOT_ACTIVATING_USER:"%s: Not activating user %s for experiment %s.",NOT_TRACKING_USER:"%s: Not tracking user %s.",ODP_DISABLED:"ODP Disabled.",ODP_IDENTIFY_FAILED_ODP_DISABLED:"%s: ODP identify event for user %s is not dispatched (ODP disabled).",ODP_IDENTIFY_FAILED_ODP_NOT_INTEGRATED:"%s: ODP identify event %s is not dispatched (ODP not integrated).",ODP_SEND_EVENT_IDENTIFIER_CONVERSION_FAILED:"%s: sendOdpEvent failed to parse through and convert fs_user_id aliases",PARSED_REVENUE_VALUE:'%s: Parsed revenue value "%s" from event tags.',PARSED_NUMERIC_VALUE:'%s: Parsed event value "%s" from event tags.',RETURNING_STORED_VARIATION:'%s: Returning previously activated variation "%s" of experiment "%s" for user "%s" from user profile.',ROLLOUT_HAS_NO_EXPERIMENTS:"%s: Rollout of feature %s has no experiments",SAVED_VARIATION:'%s: Saved variation "%s" of experiment "%s" for user "%s".',SAVED_VARIATION_NOT_FOUND:"%s: User %s was previously bucketed into variation with ID %s for experiment %s, but no matching variation was found.",SHOULD_NOT_DISPATCH_ACTIVATE:'%s: Experiment %s is not in "Running" state. Not activating user.',SKIPPING_JSON_VALIDATION:"%s: Skipping JSON schema validation.",TRACK_EVENT:"%s: Tracking event %s for user %s.",UNRECOGNIZED_DECIDE_OPTION:"%s: Unrecognized decide option %s provided.",USER_ASSIGNED_TO_EXPERIMENT_BUCKET:"%s: Assigned bucket %s to user with bucketing ID %s.",USER_BUCKETED_INTO_EXPERIMENT_IN_GROUP:"%s: User %s is in experiment %s of group %s.",USER_BUCKETED_INTO_TARGETING_RULE:"%s: User %s bucketed into targeting rule %s.",USER_IN_FEATURE_EXPERIMENT:"%s: User %s is in variation %s of experiment %s on the feature %s.",USER_IN_ROLLOUT:"%s: User %s is in rollout of feature %s.",USER_NOT_BUCKETED_INTO_EVERYONE_TARGETING_RULE:"%s: User %s not bucketed into everyone targeting rule due to traffic allocation.",USER_NOT_BUCKETED_INTO_EXPERIMENT_IN_GROUP:"%s: User %s is not in experiment %s of group %s.",USER_NOT_BUCKETED_INTO_ANY_EXPERIMENT_IN_GROUP:"%s: User %s is not in any experiment of group %s.",USER_NOT_BUCKETED_INTO_TARGETING_RULE:"%s User %s not bucketed into targeting rule %s due to traffic allocation. Trying everyone rule.",USER_NOT_IN_FEATURE_EXPERIMENT:"%s: User %s is not in any experiment on the feature %s.",USER_NOT_IN_ROLLOUT:"%s: User %s is not in rollout of feature %s.",USER_FORCED_IN_VARIATION:"%s: User %s is forced in variation %s.",USER_MAPPED_TO_FORCED_VARIATION:"%s: Set variation %s for experiment %s and user %s in the forced variation map.",USER_DOESNT_MEET_CONDITIONS_FOR_TARGETING_RULE:"%s: User %s does not meet conditions for targeting rule %s.",USER_MEETS_CONDITIONS_FOR_TARGETING_RULE:"%s: User %s meets conditions for targeting rule %s.",USER_HAS_VARIATION:"%s: User %s is in variation %s of experiment %s.",USER_HAS_FORCED_DECISION_WITH_RULE_SPECIFIED:"Variation (%s) is mapped to flag (%s), rule (%s) and user (%s) in the forced decision map.",USER_HAS_FORCED_DECISION_WITH_NO_RULE_SPECIFIED:"Variation (%s) is mapped to flag (%s) and user (%s) in the forced decision map.",USER_HAS_FORCED_DECISION_WITH_RULE_SPECIFIED_BUT_INVALID:"Invalid variation is mapped to flag (%s), rule (%s) and user (%s) in the forced decision map.",USER_HAS_FORCED_DECISION_WITH_NO_RULE_SPECIFIED_BUT_INVALID:"Invalid variation is mapped to flag (%s) and user (%s) in the forced decision map.",USER_HAS_FORCED_VARIATION:"%s: Variation %s is mapped to experiment %s and user %s in the forced variation map.",USER_HAS_NO_VARIATION:"%s: User %s is in no variation of experiment %s.",USER_HAS_NO_FORCED_VARIATION:"%s: User %s is not in the forced variation map.",USER_HAS_NO_FORCED_VARIATION_FOR_EXPERIMENT:"%s: No experiment %s mapped to user %s in the forced variation map.",USER_NOT_IN_ANY_EXPERIMENT:"%s: User %s is not in any experiment of group %s.",USER_NOT_IN_EXPERIMENT:"%s: User %s does not meet conditions to be in experiment %s.",USER_RECEIVED_DEFAULT_VARIABLE_VALUE:'%s: User "%s" is not in any variation or rollout rule. Returning default value for variable "%s" of feature flag "%s".',FEATURE_NOT_ENABLED_RETURN_DEFAULT_VARIABLE_VALUE:'%s: Feature "%s" is not enabled for user %s. Returning the default variable value "%s".',VARIABLE_NOT_USED_RETURN_DEFAULT_VARIABLE_VALUE:'%s: Variable "%s" is not used in variation "%s". Returning default value.',USER_RECEIVED_VARIABLE_VALUE:'%s: Got variable value "%s" for variable "%s" of feature flag "%s"',VALID_DATAFILE:"%s: Datafile is valid.",VALID_USER_PROFILE_SERVICE:"%s: Valid user profile service provided.",VARIATION_REMOVED_FOR_USER:"%s: Variation mapped to experiment %s has been removed for user %s.",VARIABLE_REQUESTED_WITH_WRONG_TYPE:'%s: Requested variable type "%s", but variable is of type "%s". Use correct API to retrieve value. Returning None.',VALID_BUCKETING_ID:'%s: BucketingId is valid: "%s"',BUCKETING_ID_NOT_STRING:"%s: BucketingID attribute is not a string. Defaulted to userId",EVALUATING_AUDIENCE:'%s: Starting to evaluate audience "%s" with conditions: %s.',EVALUATING_AUDIENCES_COMBINED:'%s: Evaluating audiences for %s "%s": %s.',AUDIENCE_EVALUATION_RESULT:'%s: Audience "%s" evaluated to %s.',AUDIENCE_EVALUATION_RESULT_COMBINED:"%s: Audiences for %s %s collectively evaluated to %s.",MISSING_ATTRIBUTE_VALUE:'%s: Audience condition %s evaluated to UNKNOWN because no value was passed for user attribute "%s".',UNEXPECTED_CONDITION_VALUE:"%s: Audience condition %s evaluated to UNKNOWN because the condition value is not supported.",UNEXPECTED_TYPE:'%s: Audience condition %s evaluated to UNKNOWN because a value of type "%s" was passed for user attribute "%s".',UNEXPECTED_TYPE_NULL:'%s: Audience condition %s evaluated to UNKNOWN because a null value was passed for user attribute "%s".',UNKNOWN_CONDITION_TYPE:"%s: Audience condition %s has an unknown condition type. You may need to upgrade to a newer release of the Optimizely SDK.",UNKNOWN_MATCH_TYPE:"%s: Audience condition %s uses an unknown match type. You may need to upgrade to a newer release of the Optimizely SDK.",UPDATED_OPTIMIZELY_CONFIG:"%s: Updated Optimizely config to revision %s (project id %s)",OUT_OF_BOUNDS:'%s: Audience condition %s evaluated to UNKNOWN because the number value for user attribute "%s" is not in the range [-2^53, +2^53].',UNABLE_TO_ATTACH_UNLOAD:'%s: unable to bind optimizely.close() to page unload event: "%s"'},K={BOT_FILTERING:"$opt_bot_filtering",BUCKETING_ID:"$opt_bucketing_id",STICKY_BUCKETING_KEY:"$opt_experiment_bucket_map",USER_AGENT:"$opt_user_agent",FORCED_DECISION_NULL_RULE_KEY:"$opt_null_rule_key"},q={AB_TEST:"ab-test",FEATURE:"feature",FEATURE_TEST:"feature-test",FEATURE_VARIABLE:"feature-variable",ALL_FEATURE_VARIABLES:"all-feature-variables",FLAG:"flag"},H={FEATURE_TEST:"feature-test",ROLLOUT:"rollout",EXPERIMENT:"experiment"},Y={RULE:"rule",EXPERIMENT:"experiment"},$={BOOLEAN:"boolean",DOUBLE:"double",INTEGER:"integer",STRING:"string",JSON:"json"},Z={V2:"2",V3:"3",V4:"4"},X={SDK_NOT_READY:"Optimizely SDK not configured properly yet.",FLAG_KEY_INVALID:'No flag was found for key "%s".',VARIABLE_VALUE_INVALID:'Variable value for key "%s" is invalid or wrong type.'};(function(e){e.ACTIVATE="ACTIVATE:experiment, user_id,attributes, variation, event",e.DECISION="DECISION:type, userId, attributes, decisionInfo",e.LOG_EVENT="LOG_EVENT:logEvent",e.OPTIMIZELY_CONFIG_UPDATE="OPTIMIZELY_CONFIG_UPDATE",e.TRACK="TRACK:event_key, user_id, attributes, event_tags, event"})(z||(z={})),function(e){e.VUID="vuid",e.FS_USER_ID="fs_user_id"}(eg||(eg={})),function(e){e.IDENTIFIED="identified",e.INITIALIZED="client_initialized"}(em||(em={}));var W=Object.freeze({__proto__:null,LOG_LEVEL:j,ERROR_MESSAGES:B,LOG_MESSAGES:G,CONTROL_ATTRIBUTES:K,JAVASCRIPT_CLIENT_ENGINE:"javascript-sdk",NODE_CLIENT_ENGINE:"node-sdk",REACT_CLIENT_ENGINE:"react-sdk",REACT_NATIVE_CLIENT_ENGINE:"react-native-sdk",REACT_NATIVE_JS_CLIENT_ENGINE:"react-native-js-sdk",CLIENT_VERSION:"5.3.4",DECISION_NOTIFICATION_TYPES:q,DECISION_SOURCES:H,AUDIENCE_EVALUATION_TYPES:Y,FEATURE_VARIABLE_TYPES:$,DATAFILE_VERSIONS:Z,DECISION_MESSAGES:X,get NOTIFICATION_TYPES(){return z},REQUEST_TIMEOUT_MS:6e4,REQUEST_TIMEOUT_ODP_SEGMENTS_MS:1e4,REQUEST_TIMEOUT_ODP_EVENTS_MS:1e4,get ODP_USER_KEY(){return eg},FS_USER_ID_ALIAS:"fs-user-id",ODP_DEFAULT_EVENT_TYPE:"fullstack",get ODP_EVENT_ACTION(){return em}}),J=U("EventProcessor"),Q=U("EventProcessor"),ee=function(){function e(e){var t=e.key,i=e.maxValues;this.LS_KEY=t,this.maxValues=void 0===i?1e3:i}return e.prototype.get=function(e){return this.getMap()[e]||null},e.prototype.set=function(e,t){var i=this.getMap();i[e]=t,this.replace(i)},e.prototype.remove=function(e){var t=this.getMap();delete t[e],this.replace(t)},e.prototype.values=function(){return v(this.getMap())},e.prototype.clear=function(){this.replace({})},e.prototype.replace=function(e){try{"undefined"!=typeof window?window&&window.localStorage&&localStorage.setItem(this.LS_KEY,JSON.stringify(e)):localStorage.setItem(this.LS_KEY,JSON.stringify(e)),this.clean()}catch(e){Q.error(String(e))}},e.prototype.clean=function(){var e=this.getMap(),t=Object.keys(e),i=t.length-this.maxValues;if(!(i<1)){var r=t.map(function(t){return{key:t,value:e[t]}});r.sort(function(e,t){return e.value.timestamp-t.value.timestamp});for(var n=0;n<i;n++)delete e[r[n].key];this.replace(e)}},e.prototype.getMap=function(){try{var e="undefined"!=typeof window?window&&window.localStorage&&localStorage.getItem(this.LS_KEY):localStorage.getItem(this.LS_KEY);if(e)return JSON.parse(e)||{}}catch(e){Q.error(e)}return{}},e}(),et=U("EventProcessor"),ei=function(e){function t(t){var i=t.eventDispatcher;return e.call(this,{eventDispatcher:i,store:new ee({maxValues:100,key:"fs_optly_pending_events"})})||this}return u(t,e),t}(function(){function e(e){var t=e.eventDispatcher,i=e.store;this.dispatcher=t,this.store=i}return e.prototype.dispatchEvent=function(e,t){this.send({uuid:E(),timestamp:(new Date).getTime(),request:e},t)},e.prototype.sendPendingEvents=function(){var e=this,t=this.store.values();et.debug("Sending %s pending events from previous page",t.length),t.forEach(function(t){try{e.send(t,function(){})}catch(e){et.debug(String(e))}})},e.prototype.send=function(e,t){var i=this;this.store.set(e.uuid,e),this.dispatcher.dispatchEvent(e.request,function(r){i.store.remove(e.uuid),t(r)})},e}()),er=function(){function e(){this.reqsInFlightCount=0,this.reqsCompleteResolvers=[]}return e.prototype.trackRequest=function(e){var t=this;this.reqsInFlightCount++;var i=function(){t.reqsInFlightCount--,0===t.reqsInFlightCount&&(t.reqsCompleteResolvers.forEach(function(e){return e()}),t.reqsCompleteResolvers=[])};e.then(i,i)},e.prototype.onRequestsComplete=function(){var e=this;return new Promise(function(t){0===e.reqsInFlightCount?t():e.reqsCompleteResolvers.push(t)})},e}(),en=U("LogTierV1EventProcessor"),eo=function(){function e(e){var t,i,r,n,o,a,s=e.dispatcher,l=e.closingDispatcher,u=e.flushInterval,c=void 0===u?3e4:u,d=e.batchSize,p=void 0===d?10:d,f=e.notificationCenter;this.dispatcher=s,this.closingDispatcher=l,this.notificationCenter=f,this.requestTracker=new er,(t=c)<=0&&(J.warn("Invalid flushInterval ".concat(t,", defaulting to ").concat(3e4)),t=3e4),c=t,(i=Math.floor(i=p))<1&&(J.warn("Invalid batchSize ".concat(i,", defaulting to ").concat(10)),i=10),p=i=Math.max(1,i),this.queue=(r=p,n=c,o=this.drainQueue.bind(this,!1),a=this.drainQueue.bind(this,!0),r>1?new F({flushInterval:n,maxQueueSize:r,sink:o,closingSink:a,batchComparator:P}):new V({sink:o}))}return e.prototype.drainQueue=function(e,t){var i=this,r=new Promise(function(r){if(en.debug("draining queue with %s events",t.length),0!==t.length){var n,o,a,s={url:"https://logx.optimizely.com/v1/events",httpVerb:"POST",params:(n=[],o=t[0],t.forEach(function(e){if("conversion"===e.type||"impression"===e.type){var t,i,r,o,a,s,l,u,d,p,f,h,g,m=(t={snapshots:[],visitor_id:e.user.id,attributes:[]},e.user.attributes.forEach(function(e){t.attributes.push({entity_id:e.entityId,key:e.key,type:"custom",value:e.value})}),"boolean"==typeof e.context.botFiltering&&t.attributes.push({entity_id:"$opt_bot_filtering",key:"$opt_bot_filtering",type:"custom",value:e.context.botFiltering}),t);"impression"===e.type?m.snapshots.push((o=e.layer,a=e.experiment,s=e.variation,l=e.ruleKey,u=e.flagKey,d=e.ruleType,p=e.enabled,{decisions:[{campaign_id:f=o?o.id:null,experiment_id:null!==(i=null==a?void 0:a.id)&&void 0!==i?i:"",variation_id:null!==(r=null==s?void 0:s.id)&&void 0!==r?r:"",metadata:{flag_key:u,rule_key:l,rule_type:d,variation_key:s?s.key:"",enabled:p}}],events:[{entity_id:f,timestamp:e.timestamp,key:"campaign_activated",uuid:e.uuid}]})):"conversion"===e.type&&m.snapshots.push((h=c({},e.tags),delete h.revenue,delete h.value,g={entity_id:e.event.id,key:e.event.key,timestamp:e.timestamp,uuid:e.uuid},e.tags&&(g.tags=e.tags),null!=e.value&&(g.value=e.value),null!=e.revenue&&(g.revenue=e.revenue),{events:[g]})),n.push(m)}}),{client_name:o.context.clientName,client_version:o.context.clientVersion,account_id:o.context.accountId,project_id:o.context.projectId,revision:o.context.revision,anonymize_ip:o.context.anonymizeIP,enrich_decisions:!0,visitors:n})};(e&&i.closingDispatcher?i.closingDispatcher:i.dispatcher).dispatchEvent(s,function(){r()}),(a=i.notificationCenter)&&a.sendNotifications(z.LOG_EVENT,s)}else r()});return this.requestTracker.trackRequest(r),r},e.prototype.process=function(e){this.queue.enqueue(e)},e.prototype.stop=function(){try{return this.queue.stop(),this.requestTracker.onRequestsComplete()}catch(e){en.error('Error stopping EventProcessor: "%s"',Object(e).message,String(e))}return Promise.resolve()},e.prototype.start=function(){return d(this,void 0,void 0,function(){return p(this,function(e){switch(e.label){case 0:return[4,this.queue.start()];case 1:return e.sent(),[2]}})})},e}(),ea="CONFIG_VALIDATOR",es=[Z.V2,Z.V3,Z.V4],el=function(e){if("object"==typeof e&&null!==e){var t=e.errorHandler,i=e.eventDispatcher,r=e.logger;if(t&&"function"!=typeof t.handleError)throw Error(b(B.INVALID_ERROR_HANDLER,ea));if(i&&"function"!=typeof i.dispatchEvent)throw Error(b(B.INVALID_EVENT_DISPATCHER,ea));if(r&&"function"!=typeof r.log)throw Error(b(B.INVALID_LOGGER,ea));return!0}throw Error(b(B.INVALID_CONFIG,ea))},eu=function(e){if(!e)throw Error(b(B.NO_DATAFILE_SPECIFIED,ea));if("string"==typeof e)try{e=JSON.parse(e)}catch(e){throw Error(b(B.INVALID_DATAFILE_MALFORMED,ea))}if("object"==typeof e&&!Array.isArray(e)&&null!==e&&-1===es.indexOf(e.version))throw Error(b(B.INVALID_DATAFILE_VERSION,ea,e.version));return e},ec={handleError:function(){}},ed={dispatchEvent:function(e,t){var i,r=e.params,n=e.url;"POST"===e.httpVerb?((i=new XMLHttpRequest).open("POST",n,!0),i.setRequestHeader("Content-Type","application/json"),i.onreadystatechange=function(){if(4===i.readyState&&t&&"function"==typeof t)try{t({statusCode:i.status})}catch(e){}},i.send(JSON.stringify(r))):(n+="?wxhr=true",r&&(n+="&"+Object.keys(r).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(r[e])}).join("&")),(i=new XMLHttpRequest).open("GET",n,!0),i.onreadystatechange=function(){if(4===i.readyState&&t&&"function"==typeof t)try{t({statusCode:i.status})}catch(e){}},i.send())}},ep={dispatchEvent:function(e,t){var i=e.params,r=e.url,n=new Blob([JSON.stringify(i)],{type:"application/json"});t({statusCode:navigator.sendBeacon(r,n)?200:500})}},ef=function(){function e(){}return e.prototype.log=function(){},e}();function eh(e){return new A(e)}var eg,em,eE,e_,ev,ey=Object.freeze({__proto__:null,NoOpLogger:ef,createLogger:eh,createNoOpLogger:function(){return new ef}}),eb=function(){function e(e){var t=this;this.logger=e.logger,this.errorHandler=e.errorHandler,this.notificationListeners={},v(z).forEach(function(e){t.notificationListeners[e]=[]}),this.listenerId=1}return e.prototype.addNotificationListener=function(e,t){try{if(!(v(z).indexOf(e)>-1))return -1;this.notificationListeners[e]||(this.notificationListeners[e]=[]);var i=!1;if((this.notificationListeners[e]||[]).forEach(function(e){e.callback!==t||(i=!0)}),i)return -1;this.notificationListeners[e].push({id:this.listenerId,callback:t});var r=this.listenerId;return this.listenerId+=1,r}catch(e){return this.logger.log(j.ERROR,e.message),this.errorHandler.handleError(e),-1}},e.prototype.removeNotificationListener=function(e){var t,i,r=this;try{if(Object.keys(this.notificationListeners).some(function(n){return(r.notificationListeners[n]||[]).every(function(r,o){return r.id!==e||(t=o,i=n,!1)}),void 0!==t&&void 0!==i}),void 0!==t&&void 0!==i)return this.notificationListeners[i].splice(t,1),!0}catch(e){this.logger.log(j.ERROR,e.message),this.errorHandler.handleError(e)}return!1},e.prototype.clearAllNotificationListeners=function(){var e=this;try{v(z).forEach(function(t){e.notificationListeners[t]=[]})}catch(e){this.logger.log(j.ERROR,e.message),this.errorHandler.handleError(e)}},e.prototype.clearNotificationListeners=function(e){try{this.notificationListeners[e]=[]}catch(e){this.logger.log(j.ERROR,e.message),this.errorHandler.handleError(e)}},e.prototype.sendNotifications=function(e,t){var i=this;try{(this.notificationListeners[e]||[]).forEach(function(r){var n=r.callback;try{n(t)}catch(t){i.logger.log(j.ERROR,G.NOTIFICATION_LISTENER_EXCEPTION,"NOTIFICATION_CENTER",e,t.message)}})}catch(e){this.logger.log(j.ERROR,e.message),this.errorHandler.handleError(e)}},e}(),eI={createEventProcessor:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new(eo.bind.apply(eo,f([void 0],e,!1)))}};(eE=t.OptimizelySegmentOption||(t.OptimizelySegmentOption={})).IGNORE_CACHE="IGNORE_CACHE",eE.RESET_CACHE="RESET_CACHE",function(e){e.BOOLEAN="boolean",e.DOUBLE="double",e.INTEGER="integer",e.STRING="string",e.JSON="json"}(e_||(e_={})),(ev=t.OptimizelyDecideOption||(t.OptimizelyDecideOption={})).DISABLE_DECISION_EVENT="DISABLE_DECISION_EVENT",ev.ENABLED_FLAGS_ONLY="ENABLED_FLAGS_ONLY",ev.IGNORE_USER_PROFILE_SERVICE="IGNORE_USER_PROFILE_SERVICE",ev.INCLUDE_REASONS="INCLUDE_REASONS",ev.EXCLUDE_VARIABLES="EXCLUDE_VARIABLES";var eO="Polling intervals below ".concat(30," seconds are not recommended."),eR=[0,8,16,32,64,128,256,512],eN=U("DatafileManager"),eT=function(){function e(){this.listeners={},this.listenerId=1}return e.prototype.on=function(e,t){var i=this;this.listeners[e]||(this.listeners[e]={});var r=String(this.listenerId);return this.listenerId++,this.listeners[e][r]=t,function(){i.listeners[e]&&delete i.listeners[e][r]}},e.prototype.emit=function(e,t){var i=this.listeners[e];i&&Object.keys(i).forEach(function(e){(0,i[e])(t)})},e.prototype.removeAllListeners=function(){this.listeners={}},e}(),eA=function(){function e(){this.errorCount=0}return e.prototype.getDelay=function(){return 0===this.errorCount?0:1e3*eR[Math.min(eR.length-1,this.errorCount)]+Math.round(1e3*Math.random())},e.prototype.countError=function(){this.errorCount<eR.length-1&&this.errorCount++},e.prototype.reset=function(){this.errorCount=0},e}(),eD=function(){function e(){}return e.getNotificationCenter=function(e,i){var r;if(void 0===i&&(i=U()),e)return this._notificationCenters.has(e)?r=this._notificationCenters.get(e):(r=new eb({logger:i,errorHandler:{handleError:function(){}}}),this._notificationCenters.set(e,r)),r;i.log(t.LogLevel.ERROR,"No SDK key provided to getNotificationCenter.")},e.removeNotificationCenter=function(e){if(e){var t=this._notificationCenters.get(e);t&&(t.clearAllNotificationListeners(),this._notificationCenters.delete(e))}},e._notificationCenters=new Map,e}(),eS=U("DatafileManager");function ew(e){return e>=200&&e<400}var eL={get:function(){return Promise.resolve(void 0)},set:function(){return Promise.resolve()},contains:function(){return Promise.resolve(!1)},remove:function(){return Promise.resolve(!1)}},eU=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.makeGetRequest=function(e,t){var i;return i=new XMLHttpRequest,{responsePromise:new Promise(function(r,n){i.open("GET",e,!0),function(e,t){Object.keys(e).forEach(function(i){var r=e[i];t.setRequestHeader(i,r)})}(t,i),i.onreadystatechange=function(){if(4===i.readyState){if(0===i.status)return void n(Error("Request error"));var e=function(e){var t=e.getAllResponseHeaders();if(null===t)return{};var i=t.split("\r\n"),r={};return i.forEach(function(e){var t=e.indexOf(": ");if(t>-1){var i=e.slice(0,t),n=e.slice(t+2);n.length>0&&(r[i]=n)}}),r}(i);r({statusCode:i.status,body:i.responseText,headers:e})}},i.timeout=6e4,i.ontimeout=function(){eN.error("Request timed out")},i.send()}),abort:function(){i.abort()}}},t.prototype.getConfigDefaults=function(){return{autoUpdate:!1}},t}(function(){function e(e){var t=this,i=c(c({},this.getConfigDefaults()),e),r=i.datafile,n=i.autoUpdate,o=i.sdkKey,a=i.updateInterval,s=i.urlTemplate,l=i.cache;this.cache=void 0===l?eL:l,this.cacheKey="opt-datafile-"+o,this.sdkKey=o,this.isReadyPromiseSettled=!1,this.readyPromiseResolver=function(){},this.readyPromiseRejecter=function(){},this.readyPromise=new Promise(function(e,i){t.readyPromiseResolver=e,t.readyPromiseRejecter=i}),r?(this.currentDatafile=r,o||this.resolveReadyPromise()):this.currentDatafile="",this.isStarted=!1,this.datafileUrl=b(void 0===s?"https://cdn.optimizely.com/datafiles/%s.json":s,o),this.emitter=new eT,this.autoUpdate=void 0!==n&&n,this.updateInterval=void 0===a?3e5:a,this.updateInterval<3e4&&eS.warn(eO),this.currentTimeout=null,this.currentRequest=null,this.backoffController=new eA,this.syncOnCurrentRequestComplete=!1}return e.prototype.get=function(){return this.currentDatafile},e.prototype.start=function(){this.isStarted||(eS.debug("Datafile manager started"),this.isStarted=!0,this.backoffController.reset(),this.setDatafileFromCacheIfAvailable(),this.syncDatafile())},e.prototype.stop=function(){return eS.debug("Datafile manager stopped"),this.isStarted=!1,this.currentTimeout&&(clearTimeout(this.currentTimeout),this.currentTimeout=null),this.emitter.removeAllListeners(),this.currentRequest&&(this.currentRequest.abort(),this.currentRequest=null),Promise.resolve()},e.prototype.onReady=function(){return this.readyPromise},e.prototype.on=function(e,t){return this.emitter.on(e,t)},e.prototype.onRequestRejected=function(e){this.isStarted&&(this.backoffController.countError(),e instanceof Error?eS.error("Error fetching datafile: %s",e.message,e):"string"==typeof e?eS.error("Error fetching datafile: %s",e):eS.error("Error fetching datafile"))},e.prototype.onRequestResolved=function(e){var t;if(this.isStarted){void 0!==e.statusCode&&ew(e.statusCode)?this.backoffController.reset():this.backoffController.countError(),this.trySavingLastModified(e.headers);var i=this.getNextDatafileFromResponse(e);""!==i&&((eS.info("Updating datafile from response"),this.currentDatafile=i,this.cache.set(this.cacheKey,i),this.isReadyPromiseSettled)?(null===(t=eD.getNotificationCenter(this.sdkKey,eS))||void 0===t||t.sendNotifications(z.OPTIMIZELY_CONFIG_UPDATE),this.emitter.emit("update",{datafile:i})):this.resolveReadyPromise())}},e.prototype.onRequestComplete=function(){this.isStarted&&(this.currentRequest=null,this.isReadyPromiseSettled||this.autoUpdate||this.rejectReadyPromise(Error("Failed to become ready")),this.autoUpdate&&this.syncOnCurrentRequestComplete&&this.syncDatafile(),this.syncOnCurrentRequestComplete=!1)},e.prototype.syncDatafile=function(){var e=this,t={};this.lastResponseLastModified&&(t["if-modified-since"]=this.lastResponseLastModified),eS.debug("Making datafile request to url %s with headers: %s",this.datafileUrl,function(){return JSON.stringify(t)}),this.currentRequest=this.makeGetRequest(this.datafileUrl,t);var i=function(){e.onRequestComplete()};this.currentRequest.responsePromise.then(function(t){e.onRequestResolved(t)},function(t){e.onRequestRejected(t)}).then(i,i),this.autoUpdate&&this.scheduleNextUpdate()},e.prototype.resolveReadyPromise=function(){this.readyPromiseResolver(),this.isReadyPromiseSettled=!0},e.prototype.rejectReadyPromise=function(e){this.readyPromiseRejecter(e),this.isReadyPromiseSettled=!0},e.prototype.scheduleNextUpdate=function(){var e=this,t=Math.max(this.backoffController.getDelay(),this.updateInterval);eS.debug("Scheduling sync in %s ms",t),this.currentTimeout=setTimeout(function(){e.currentRequest?e.syncOnCurrentRequestComplete=!0:e.syncDatafile()},t)},e.prototype.getNextDatafileFromResponse=function(e){return eS.debug("Response status code: %s",e.statusCode),void 0===e.statusCode||304===e.statusCode?"":ew(e.statusCode)?e.body:(eS.error("Datafile fetch request failed with status: ".concat(e.statusCode)),"")},e.prototype.trySavingLastModified=function(e){var t=e["last-modified"]||e["Last-Modified"];void 0!==t&&(this.lastResponseLastModified=t,eS.debug("Saved last modified header value from response: %s",this.lastResponseLastModified))},e.prototype.setDatafileFromCacheIfAvailable=function(){var e=this;this.cache.get(this.cacheKey).then(function(t){e.isStarted&&!e.isReadyPromiseSettled&&t&&(eS.debug("Using datafile from cache"),e.currentDatafile=t,e.resolveReadyPromise())})},e}()),eC=function(){function e(e,t,i,r){this.apiKey=e,this.apiHost=t,this.pixelUrl=i,this.segmentsToCheck=r}return e.prototype.equals=function(e){var t,i;return this.apiHost===e.apiHost&&this.apiKey===e.apiKey&&this.pixelUrl===e.pixelUrl&&(t=this.segmentsToCheck,i=e.segmentsToCheck,t.length===i.length&&t.every(function(e,t){return e===i[t]}))},e}(),ex="PROJECT_CONFIG",eP=function(e,t){void 0===t&&(t=null);var i,r,n,o,a=((o=g({},e)).audiences=(e.audiences||[]).map(function(e){return g({},e)}),o.experiments=(e.experiments||[]).map(function(e){return g({},e)}),o.featureFlags=(e.featureFlags||[]).map(function(e){return g({},e)}),o.groups=(e.groups||[]).map(function(e){var t=g({},e);return t.experiments=(e.experiments||[]).map(function(e){return g({},e)}),t}),o.rollouts=(e.rollouts||[]).map(function(e){var t=g({},e);return t.experiments=(e.experiments||[]).map(function(e){return g({},e)}),t}),o.environmentKey=null!==(r=e.environmentKey)&&void 0!==r?r:"",o.sdkKey=null!==(n=e.sdkKey)&&void 0!==n?n:"",o);a.__datafileStr=null===t?JSON.stringify(e):t,(a.audiences||[]).forEach(function(e){e.conditions=JSON.parse(e.conditions)}),a.audiencesById=m(a.audiences,"id"),g(a.audiencesById,m(a.typedAudiences,"id")),a.attributeKeyMap=m(a.attributes,"key"),a.eventKeyMap=m(a.events,"key"),a.groupIdMap=m(a.groups,"id"),Object.keys(a.groupIdMap||{}).forEach(function(e){(a.groupIdMap[e].experiments||[]).forEach(function(t){a.experiments.push(g(t,{groupId:e}))})}),a.rolloutIdMap=m(a.rollouts||[],"id"),v(a.rolloutIdMap||{}).forEach(function(e){(e.experiments||[]).forEach(function(e){a.experiments.push(e),e.variationKeyMap=m(e.variations,"key")})});var s=new Set;Object.keys(a.audiencesById).map(function(e){return ez(a.audiencesById[e])}).forEach(function(e){e.forEach(function(e){s.add(e)})});var l=Array.from(s),u=!1,c="",d="",p="";return a.integrations&&(a.integrationKeyMap=m(a.integrations,"key"),a.integrations.forEach(function(e){if(!("key"in e))throw Error(b(B.MISSING_INTEGRATION_KEY,ex));"odp"===e.key&&(u=!0,d=d||e.publicKey||"",c=c||e.host||"",p=p||e.pixelUrl||"")})),a.odpIntegrationConfig=u?{integrated:!0,odpConfig:new eC(d,c,p,l)}:{integrated:!1},a.experimentKeyMap=m(a.experiments,"key"),a.experimentIdMap=m(a.experiments,"id"),a.variationIdMap={},a.variationVariableUsageMap={},(a.experiments||[]).forEach(function(e){e.variationKeyMap=m(e.variations,"key"),g(a.variationIdMap,m(e.variations,"id")),v(e.variationKeyMap||{}).forEach(function(e){e.variables&&(a.variationVariableUsageMap[e.id]=m(e.variables,"id"))})}),a.experimentFeatureMap={},a.featureKeyMap=m(a.featureFlags||[],"key"),v(a.featureKeyMap||{}).forEach(function(e){e.variables.forEach(function(e){e.type===$.STRING&&e.subType===$.JSON&&(e.type=$.JSON,delete e.subType)}),e.variableKeyMap=m(e.variables,"key"),(e.experimentIds||[]).forEach(function(t){a.experimentFeatureMap[t]?a.experimentFeatureMap[t].push(e.id):a.experimentFeatureMap[t]=[e.id]})}),a.flagRulesMap={},(a.featureFlags||[]).forEach(function(e){var t=[];e.experimentIds.forEach(function(e){var i=a.experimentIdMap[e];i&&t.push(i)});var i=a.rolloutIdMap[e.rolloutId];i&&t.push.apply(t,i.experiments),a.flagRulesMap[e.key]=t}),a.flagVariationsMap={},Object.keys(i=a.flagRulesMap||{}).map(function(e){return[e,i[e]]}).forEach(function(e){var t=e[0],i=e[1],r=[];i.forEach(function(e){e.variations.forEach(function(e){y(r,function(t){return t.id===e.id})||r.push(e)})}),a.flagVariationsMap[t]=r}),a},ez=function(e){return e.conditions?ek(e.conditions):[]},ek=function(e){var t=[];return["and","or","not"].includes(e)?[]:(Array.isArray(e)?e.forEach(function(e){return t.push.apply(t,ek(e))}):"qualified"===e.match&&t.push(e.value),t)},eM=function(e,t){var i=e.experimentIdMap[t];if(!i)throw Error(b(B.INVALID_EXPERIMENT_ID,ex,t));return i.layerId},eV=function(e,t,i){var r=e.attributeKeyMap[t],n=0===t.indexOf("$opt_");return r?(n&&i.log(j.WARNING,"Attribute %s unexpectedly has reserved prefix %s; using attribute ID instead of reserved attribute name.",t,"$opt_"),r.id):n?t:(i.log(j.DEBUG,B.UNRECOGNIZED_ATTRIBUTE,ex,t),null)},eF=function(e,t){var i=e.eventKeyMap[t];return i?i.id:null},ej=function(e,t){var i=e.experimentKeyMap[t];if(!i)throw Error(b(B.INVALID_EXPERIMENT_KEY,ex,t));return i.status},eB=function(e,t){return e.variationIdMap.hasOwnProperty(t)?e.variationIdMap[t].key:null},eG=function(e,t){if(e.experimentKeyMap.hasOwnProperty(t)){var i=e.experimentKeyMap[t];if(i)return i}throw Error(b(B.EXPERIMENT_KEY_NOT_IN_DATAFILE,ex,t))},eK=function(e,t){var i=e.experimentIdMap[t];if(!i)throw Error(b(B.INVALID_EXPERIMENT_ID,ex,t));return i.trafficAllocation},eq=function(e,t,i){if(e.experimentIdMap.hasOwnProperty(t)){var r=e.experimentIdMap[t];if(r)return r}return i.log(j.ERROR,B.INVALID_EXPERIMENT_ID,ex,t),null},eH=function(e,t,i){return e&&y(e.flagVariationsMap[t],function(e){return e.key===i})||null},eY=function(e,t,i){if(e.featureKeyMap.hasOwnProperty(t)){var r=e.featureKeyMap[t];if(r)return r}return i.log(j.ERROR,B.FEATURE_NOT_IN_DATAFILE,ex,t),null},e$=function(e){return e.__datafileStr},eZ=function(e){try{t=eu(e.datafile)}catch(e){return{configObj:null,error:e}}if(e.jsonSchemaValidator)try{e.jsonSchemaValidator.validate(t),e.logger.log(j.INFO,G.VALID_DATAFILE,ex)}catch(e){return{configObj:null,error:e}}else e.logger.log(j.INFO,G.SKIPPING_JSON_VALIDATION,ex);var t,i=[t];return"string"==typeof e.datafile&&i.push(e.datafile),{configObj:eP.apply(void 0,i),error:null}},eX=function(e){return!!e.sendFlagDecisions},eW=function(){function e(e,t){void 0===t&&(t=6e4),this.logger=e,this.timeout=t}return e.prototype.makeRequest=function(e,i,r,n){var o=this,a=new XMLHttpRequest;return{responsePromise:new Promise(function(s,l){a.open(r,e,!0),o.setHeadersInXhr(i,a),a.onreadystatechange=function(){if(a.readyState===XMLHttpRequest.DONE){if(0===a.status)return void l(Error("Request error"));var e=o.parseHeadersFromXhr(a);s({statusCode:a.status,body:a.responseText,headers:e})}},a.timeout=o.timeout,a.ontimeout=function(){o.logger.log(t.LogLevel.WARNING,"Request timed out")},a.send(n)}),abort:function(){a.abort()}}},e.prototype.setHeadersInXhr=function(e,t){Object.keys(e).forEach(function(i){var r=e[i];"string"==typeof r&&t.setRequestHeader(i,r)})},e.prototype.parseHeadersFromXhr=function(e){var i=this,r=e.getAllResponseHeaders();if(null===r)return{};var n=r.split("\r\n"),o={};return n.forEach(function(e){try{var r=e.indexOf(": ");if(r>-1){var n=e.slice(0,r),a=e.slice(r+2);n&&a&&(o[n]=a)}}catch(r){i.logger.log(t.LogLevel.WARNING,"Unable to parse & skipped header item '".concat(e,"'"))}}),o},e}(),eJ=function(e){var t=e.browserCallback,i=e.nonBrowserCallback;return"undefined"!=typeof window?t(null==window?void 0:window.localStorage):i()},eQ=function(){function e(){this.logger=U()}return e.prototype.contains=function(e){return d(this,void 0,void 0,function(){var t=this;return p(this,function(i){return[2,eJ({browserCallback:function(t){return null!==(null==t?void 0:t.getItem(e))},nonBrowserCallback:function(){return t.logger.error(B.LOCAL_STORAGE_DOES_NOT_EXIST),!1}})]})})},e.prototype.get=function(e){return d(this,void 0,void 0,function(){var t=this;return p(this,function(i){return[2,eJ({browserCallback:function(t){return(null==t?void 0:t.getItem(e))||void 0},nonBrowserCallback:function(){t.logger.error(B.LOCAL_STORAGE_DOES_NOT_EXIST)}})]})})},e.prototype.remove=function(e){return d(this,void 0,void 0,function(){var t=this;return p(this,function(i){switch(i.label){case 0:return[4,this.contains(e)];case 1:return i.sent()?(eJ({browserCallback:function(t){null==t||t.removeItem(e)},nonBrowserCallback:function(){t.logger.error(B.LOCAL_STORAGE_DOES_NOT_EXIST)}}),[2,!0]):[2,!1]}})})},e.prototype.set=function(e,t){return d(this,void 0,void 0,function(){var i=this;return p(this,function(r){return[2,eJ({browserCallback:function(i){null==i||i.setItem(e,t)},nonBrowserCallback:function(){i.logger.error(B.LOCAL_STORAGE_DOES_NOT_EXIST)}})]})})},e}(),e0=function(){function e(e){void 0===e&&(e=null),this._value=e,this._time=Date.now()}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"time",{get:function(){return this._time},enumerable:!1,configurable:!0}),e.prototype.is_stale=function(e){return!(e<=0)&&Date.now()-this._time>=e},e}(),e1=function(){function e(e){var t=e.maxSize,i=e.timeout;this._map=new Map;var r=U();r.debug("Provisioning cache with maxSize of ".concat(t)),r.debug("Provisioning cache with timeout of ".concat(i)),this._maxSize=t,this._timeout=i}return Object.defineProperty(e.prototype,"map",{get:function(){return this._map},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxSize",{get:function(){return this._maxSize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timeout",{get:function(){return this._timeout},enumerable:!1,configurable:!0}),e.prototype.lookup=function(e){if(this._maxSize<=0)return null;var t=this._map.get(e);return t?t.is_stale(this._timeout)?(this._map.delete(e),null):(this._map.delete(e),this._map.set(e,t),t.value):null},e.prototype.save=function(e){var t=e.key,i=e.value;if(!(this._maxSize<=0)&&(this._map.get(t)&&this._map.delete(t),this._map.set(t,new e0(i)),this._map.size>this._maxSize)){var r=this._map.keys().next().value;this._map.delete(r)}},e.prototype.reset=function(){this._maxSize<=0||this._map.clear()},e.prototype.peek=function(e){if(this._maxSize<=0)return null;var t,i=this._map.get(e);return null!==(t=null==i?void 0:i.value)&&void 0!==t?t:null},e}(),e2=function(e){function t(t){var i,r;return e.call(this,{maxSize:null!==(i=null==t?void 0:t.maxSize)&&void 0!==i?i:100,timeout:null!==(r=null==t?void 0:t.timeout)&&void 0!==r?r:6e5})||this}return u(t,e),t}(e1),e3=(function(e){u(function(t){var i,r;return e.call(this,{maxSize:null!==(i=null==t?void 0:t.maxSize)&&void 0!==i?i:1e4,timeout:null!==(r=null==t?void 0:t.timeout)&&void 0!==r?r:6e5})||this},e)}(e1),function(){function e(){this._keyForVuid="optimizely-vuid",this._vuid=""}return Object.defineProperty(e.prototype,"vuid",{get:function(){return this._vuid},enumerable:!1,configurable:!0}),e.instance=function(t){return d(this,void 0,void 0,function(){return p(this,function(i){switch(i.label){case 0:return this._instance||(this._instance=new e),this._instance._vuid?[3,2]:[4,this._instance.load(t)];case 1:i.sent(),i.label=2;case 2:return[2,this._instance]}})})},e.prototype.load=function(t){return d(this,void 0,void 0,function(){var i;return p(this,function(r){switch(r.label){case 0:return[4,t.get(this._keyForVuid)];case 1:return(i=r.sent())&&e.isVuid(i)?(this._vuid=i,[3,4]):[3,2];case 2:return this._vuid=this.makeVuid(),[4,this.save(this._vuid,t)];case 3:r.sent(),r.label=4;case 4:return[2,this._vuid]}})})},e.prototype.makeVuid=function(){var t=E().replace(/-/g,"").toLowerCase(),i="".concat(e.vuid_prefix).concat(t);return i.length<=32?i:i.substring(0,32)},e.prototype.save=function(e,t){return d(this,void 0,void 0,function(){return p(this,function(i){switch(i.label){case 0:return[4,t.set(this._keyForVuid,e)];case 1:return i.sent(),[2]}})})},e._reset=function(){this._instance._vuid=""},e.vuid_prefix="vuid_",e.isVuid=function(t){return(null==t?void 0:t.startsWith(e.vuid_prefix))||!1},e}());function e5(e){var t=["string","number","boolean"],i=!1;return e.forEach(function(e){t.includes(typeof e)||null===e||(i=!0)}),i}var e4,e6=function(e,t,i,r){this.type=e,this.action=t,this.identifiers=null!=i?i:new Map,this.data=null!=r?r:new Map},e8=function(){};!function(e){e[e.Running=0]="Running",e[e.Stopped=1]="Stopped"}(e4||(e4={}));var e7,e9=function(){function e(e){var t,i,r,n=e.odpIntegrationConfig,o=e.segmentManager,a=e.eventManager,s=e.logger,l=this;this.ready=!1,this.status=e4.Stopped,this.segmentManager=o,this.eventManager=a,this.logger=s,this.configPromise=(t=e8,i=e8,{promise:r=new Promise(function(e,r){t=e,i=r}),resolve:t,reject:i,then:r.then.bind(r)});var u=[this.configPromise];this.isVuidEnabled()&&u.push(this.initializeVuid()),this.initPromise=Promise.all(u),this.onReady().then(function(){l.ready=!0,l.isVuidEnabled()&&l.status===e4.Running&&l.registerVuid()}),n&&this.updateSettings(n)}return e.prototype.getStatus=function(){return this.status},e.prototype.start=function(){return d(this,void 0,void 0,function(){return p(this,function(e){return this.status===e4.Running?[2]:this.odpIntegrationConfig?this.odpIntegrationConfig.integrated?(this.status=e4.Running,this.segmentManager.updateSettings(this.odpIntegrationConfig.odpConfig),this.eventManager.updateSettings(this.odpIntegrationConfig.odpConfig),this.eventManager.start(),[2,Promise.resolve()]):[2,Promise.reject(Error("start() called when ODP is not integrated"))]:[2,Promise.reject(Error("cannot start without ODP config"))]})})},e.prototype.stop=function(){return d(this,void 0,void 0,function(){return p(this,function(e){switch(e.label){case 0:return this.status===e4.Stopped?[2]:(this.status=e4.Stopped,[4,this.eventManager.stop()]);case 1:return e.sent(),[2]}})})},e.prototype.onReady=function(){return this.initPromise},e.prototype.isReady=function(){return this.ready},e.prototype.updateSettings=function(e){var t;return this.configPromise.resolve(),!(this.odpIntegrationConfig&&!((t=this.odpIntegrationConfig).integrated!==e.integrated||t.integrated&&e.integrated&&!t.odpConfig.equals(e.odpConfig)))&&(this.odpIntegrationConfig=e,e.integrated?this.status===e4.Running?(this.segmentManager.updateSettings(e.odpConfig),this.eventManager.updateSettings(e.odpConfig)):this.start():this.stop(),!0)},e.prototype.fetchQualifiedSegments=function(e,i){return void 0===i&&(i=[]),d(this,void 0,void 0,function(){return p(this,function(r){return this.odpIntegrationConfig?this.odpIntegrationConfig.integrated?e3.isVuid(e)?[2,this.segmentManager.fetchQualifiedSegments(eg.VUID,e,i)]:[2,this.segmentManager.fetchQualifiedSegments(eg.FS_USER_ID,e,i)]:(this.logger.log(t.LogLevel.ERROR,B.ODP_NOT_INTEGRATED),[2,null]):(this.logger.log(t.LogLevel.ERROR,B.ODP_CONFIG_NOT_AVAILABLE),[2,null])})})},e.prototype.identifyUser=function(e,i){this.odpIntegrationConfig?this.odpIntegrationConfig.integrated?e&&e3.isVuid(e)?this.eventManager.identifyUser(void 0,e):this.eventManager.identifyUser(e,i):this.logger.log(t.LogLevel.INFO,B.ODP_NOT_INTEGRATED):this.logger.log(t.LogLevel.ERROR,B.ODP_CONFIG_NOT_AVAILABLE)},e.prototype.sendEvent=function(e){var i=e.type,r=e.action,n=e.identifiers,o=e.data,a=i;if("string"==typeof a&&""!==a||(a="fullstack"),this.odpIntegrationConfig){if(this.odpIntegrationConfig.integrated){if(e5(o))throw Error(B.ODP_INVALID_DATA);if("string"!=typeof r||""===r)throw Error("ODP action is not valid (cannot be empty).");this.eventManager.sendEvent(new e6(a,r,n,o))}else this.logger.log(t.LogLevel.ERROR,B.ODP_NOT_INTEGRATED)}else this.logger.log(t.LogLevel.ERROR,B.ODP_CONFIG_NOT_AVAILABLE)},e.prototype.initializeVuid=function(){return Promise.resolve()},e.prototype.registerVuid=function(){if(this.odpIntegrationConfig){if(this.odpIntegrationConfig.integrated){var e=this.getVuid();if(e)try{this.eventManager.registerVuid(e)}catch(e){this.logger.log(t.LogLevel.ERROR,B.ODP_VUID_REGISTRATION_FAILED)}}else this.logger.log(t.LogLevel.INFO,B.ODP_NOT_INTEGRATED)}else this.logger.log(t.LogLevel.ERROR,B.ODP_CONFIG_NOT_AVAILABLE)},e}(),te=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return u(i,e),i.prototype.shouldSendEvents=function(e){return e.length<=1||(this.getLogger().log(t.LogLevel.ERROR,"".concat("ODP event send failed"," (browser only supports batch size 1)")),!1)},i.prototype.getPixelApiEndpoint=function(e){return new URL("v2/zaius.gif",e.pixelUrl).href},i.prototype.generateRequestData=function(e,t){var i=this.getPixelApiEndpoint(e),r=e.apiKey,n=t[0],o=new URL(i);return n.identifiers.forEach(function(e,t){o.searchParams.append(t,e)}),n.data.forEach(function(e,t){o.searchParams.append(t,e)}),o.searchParams.append("tracker_id",r),o.searchParams.append("event_type",n.type),o.searchParams.append("vdl_action",n.action),{method:"GET",endpoint:o.toString(),headers:{},data:""}},i}(function(){function e(e,t){this.requestHandler=e,this.logger=t}return e.prototype.getLogger=function(){return this.logger},e.prototype.sendEvents=function(e,i){var r;return d(this,void 0,void 0,function(){var n,o,a,s,l,u,c,d,f;return p(this,function(p){switch(p.label){case 0:if(n=!1,0===i.length)return this.logger.log(t.LogLevel.ERROR,"".concat("ODP event send failed"," (no events)")),[2,n];if(!this.shouldSendEvents(i))return[2,n];a=(o=this.generateRequestData(e,i)).method,s=o.endpoint,l=o.headers,u=o.data,c=0,p.label=1;case 1:return p.trys.push([1,3,,4]),[4,this.requestHandler.makeRequest(s,l,a,u).responsePromise];case 2:return c=null!==(r=p.sent().statusCode)&&void 0!==r?r:c,[3,4];case 3:return d=p.sent(),f="network error",d instanceof Error&&(f=d.message),this.logger.log(t.LogLevel.ERROR,"".concat("ODP event send failed"," (").concat(f,")")),n=!0,[3,4];case 4:return c>=400&&this.logger.log(t.LogLevel.ERROR,"".concat("ODP event send failed"," (").concat(c,")")),c>=500&&(n=!0),[2,n]}})})},e}()),tt=function(e){"function"==typeof queueMicrotask?queueMicrotask(e):setTimeout(e)};!function(e){e[e.Stopped=0]="Stopped",e[e.Running=1]="Running"}(e7||(e7={}));var ti=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.hasNecessaryIdentifiers=function(e){return e.identifiers.size>=0},t}return u(i,e),i.prototype.initParams=function(e,i,r){this.queueSize=i||100,this.batchSize=1,this.flushInterval=0,void 0!==e&&1!==e&&this.getLogger().log(t.LogLevel.WARNING,"ODP event batch size must be 1 in the browser."),void 0!==r&&0!==r&&this.getLogger().log(t.LogLevel.WARNING,"ODP event flush interval must be 0 in the browser.")},i.prototype.discardEventsIfNeeded=function(){this.getLogger().log(t.LogLevel.DEBUG,"ODPConfig not ready. Leaving events in queue.")},i}(function(){function e(e){var t=e.odpConfig,i=e.apiManager,r=e.logger,n=e.clientEngine,o=e.clientVersion,a=e.queueSize,s=e.batchSize,l=e.flushInterval,u=e.userAgentParser,c=e.retries;if(this.status=e7.Stopped,this.queue=[],this.apiManager=i,this.logger=r,this.clientEngine=n,this.clientVersion=o,this.initParams(s,a,l),this.status=e7.Stopped,this.userAgentParser=u,this.retries=c||3,u){var d=u.parseUserAgentInfo(),p=d.os,f=d.device,h={os:p.name,os_version:p.version,device_type:f.type,model:f.model};this.userAgentData=new Map(Object.entries(h).filter(function(e){e[0];var t=e[1];return null!=t&&null!=t}))}t&&this.updateSettings(t)}return e.prototype.updateSettings=function(e){this.odpConfig&&this.odpConfig.equals(e)||(this.flush(),this.odpConfig=e)},e.prototype.flush=function(){this.processQueue(!0)},e.prototype.start=function(){this.odpConfig?(this.status=e7.Running,this.batchSize>1&&this.setNewTimeout()):this.logger.log(t.LogLevel.ERROR,B.ODP_CONFIG_NOT_AVAILABLE)},e.prototype.stop=function(){return d(this,void 0,void 0,function(){return p(this,function(e){return this.logger.log(t.LogLevel.DEBUG,"Stop requested."),this.flush(),this.clearCurrentTimeout(),this.status=e7.Stopped,this.logger.log(t.LogLevel.DEBUG,"Stopped. Queue Count: %s",this.queue.length),[2]})})},e.prototype.registerVuid=function(e){var t=new Map;t.set(eg.VUID,e);var i=new e6("fullstack",em.INITIALIZED,t);this.sendEvent(i)},e.prototype.identifyUser=function(e,i){var r=new Map;if(e||i){i&&r.set(eg.VUID,i),e&&r.set(eg.FS_USER_ID,e);var n=new e6("fullstack",em.IDENTIFIED,r);this.sendEvent(n)}else this.logger.log(t.LogLevel.ERROR,B.ODP_SEND_EVENT_FAILED_UID_MISSING)},e.prototype.sendEvent=function(e){e5(e.data)?this.logger.log(t.LogLevel.ERROR,"Event data found to be invalid."):(e.data=this.augmentCommonData(e.data),this.enqueue(e))},e.prototype.enqueue=function(e){this.status!==e7.Stopped?this.hasNecessaryIdentifiers(e)?this.queue.length>=this.queueSize?this.logger.log(t.LogLevel.WARNING,"Failed to Process ODP Event. Event Queue full. queueSize = %s.",this.queue.length):(this.queue.push(e),this.processQueue()):this.logger.log(t.LogLevel.ERROR,"ODP events should have at least one key-value pair in identifiers."):this.logger.log(t.LogLevel.WARNING,"Failed to Process ODP Event. ODPEventManager is not running.")},e.prototype.processQueue=function(e){if(void 0===e&&(e=!1),this.status===e7.Running){if(e)for(this.clearCurrentTimeout();this.queueContainsItems();)this.makeAndSend1Batch();else if(this.queueHasBatches())for(this.clearCurrentTimeout();this.queueHasBatches();)this.makeAndSend1Batch();this.batchSize>1&&this.setNewTimeout()}},e.prototype.clearCurrentTimeout=function(){clearTimeout(this.timeoutId),this.timeoutId=void 0},e.prototype.setNewTimeout=function(){var e=this;void 0===this.timeoutId&&(this.timeoutId=setTimeout(function(){return e.processQueue(!0)},this.flushInterval))},e.prototype.makeAndSend1Batch=function(){var e=this;if(this.odpConfig){var t=this.queue.splice(0,this.batchSize),i=this.odpConfig;t.length>0&&tt(function(){return d(e,void 0,void 0,function(){var e,r;return p(this,function(n){switch(n.label){case 0:r=0,n.label=1;case 1:return[4,this.apiManager.sendEvents(i,t)];case 2:e=n.sent(),r+=1,n.label=3;case 3:if(e&&r<this.retries)return[3,1];n.label=4;case 4:return[2]}})})})}},e.prototype.queueHasBatches=function(){return this.queueContainsItems()&&this.queue.length%this.batchSize==0},e.prototype.queueContainsItems=function(){return this.queue.length>0},e.prototype.augmentCommonData=function(e){var t=new Map(this.userAgentData);return t.set("idempotence_id",E()),t.set("data_source_type","sdk"),t.set("data_source",this.clientEngine),t.set("data_source_version",this.clientVersion),e.forEach(function(e,i){return t.set(i,e)}),t},e.prototype.getLogger=function(){return this.logger},e.prototype.getQueue=function(){return this.queue},e}()),tr=function(){function e(e,t,i,r){this.odpConfig=r,this._segmentsCache=e,this.odpSegmentApiManager=t,this.logger=i||U("OdpSegmentManager")}return Object.defineProperty(e.prototype,"segmentsCache",{get:function(){return this._segmentsCache},enumerable:!1,configurable:!0}),e.prototype.fetchQualifiedSegments=function(e,i,r){return d(this,void 0,void 0,function(){var n,o,a,s,l,u;return p(this,function(c){switch(c.label){case 0:if(!this.odpConfig)return this.logger.log(t.LogLevel.WARNING,B.ODP_CONFIG_NOT_AVAILABLE),[2,null];if(!(n=this.odpConfig.segmentsToCheck)||n.length<=0)return this.logger.log(t.LogLevel.DEBUG,"No segments are used in the project. Returning an empty list."),[2,[]];if(o=this.makeCacheKey(e,i),a=r.includes(t.OptimizelySegmentOption.IGNORE_CACHE),(s=r.includes(t.OptimizelySegmentOption.RESET_CACHE))&&this.reset(),!a&&!s){if(l=this._segmentsCache.lookup(o))return this.logger.log(t.LogLevel.DEBUG,'ODP cache hit. Returning segments from cache "%s".',o),[2,l];this.logger.log(t.LogLevel.DEBUG,"ODP cache miss.")}return this.logger.log(t.LogLevel.DEBUG,"Making a call to ODP server."),[4,this.odpSegmentApiManager.fetchSegments(this.odpConfig.apiKey,this.odpConfig.apiHost,e,i,n)];case 1:return(u=c.sent())&&!a&&this._segmentsCache.save({key:o,value:u}),[2,u]}})})},e.prototype.reset=function(){this._segmentsCache.reset()},e.prototype.makeCacheKey=function(e,t){return"".concat(e,"-$-").concat(t)},e.prototype.updateSettings=function(e){this.odpConfig=e,this.reset()},e}(),tn={$schema:"http://json-schema.org/draft-04/schema#",title:"Project Config JSON Schema",type:"object",properties:{projectId:{type:"string",required:!0},accountId:{type:"string",required:!0},groups:{type:"array",items:{type:"object",properties:{id:{type:"string",required:!0},policy:{type:"string",required:!0},trafficAllocation:{type:"array",items:{type:"object",properties:{entityId:{type:"string",required:!0},endOfRange:{type:"integer",required:!0}}},required:!0},experiments:{type:"array",items:{type:"object",properties:{id:{type:"string",required:!0},key:{type:"string",required:!0},status:{type:"string",required:!0},layerId:{type:"string",required:!0},variations:{type:"array",items:{type:"object",properties:{id:{type:"string",required:!0},key:{type:"string",required:!0}}},required:!0},trafficAllocation:{type:"array",items:{type:"object",properties:{entityId:{type:"string",required:!0},endOfRange:{type:"integer",required:!0}}},required:!0},audienceIds:{type:"array",items:{type:"string"},required:!0},forcedVariations:{type:"object",required:!0}}},required:!0}}},required:!0},experiments:{type:"array",items:{type:"object",properties:{id:{type:"string",required:!0},key:{type:"string",required:!0},status:{type:"string",required:!0},layerId:{type:"string",required:!0},variations:{type:"array",items:{type:"object",properties:{id:{type:"string",required:!0},key:{type:"string",required:!0}}},required:!0},trafficAllocation:{type:"array",items:{type:"object",properties:{entityId:{type:"string",required:!0},endOfRange:{type:"integer",required:!0}}},required:!0},audienceIds:{type:"array",items:{type:"string"},required:!0},forcedVariations:{type:"object",required:!0}}},required:!0},events:{type:"array",items:{type:"object",properties:{key:{type:"string",required:!0},experimentIds:{type:"array",items:{type:"string",required:!0}},id:{type:"string",required:!0}}},required:!0},audiences:{type:"array",items:{type:"object",properties:{id:{type:"string",required:!0},name:{type:"string",required:!0},conditions:{type:"string",required:!0}}},required:!0},attributes:{type:"array",items:{type:"object",properties:{id:{type:"string",required:!0},key:{type:"string",required:!0}}},required:!0},version:{type:"string",required:!0},revision:{type:"string",required:!0},integrations:{type:"array",items:{type:"object",properties:{key:{type:"string",required:!0},host:{type:"string"},publicKey:{type:"string"},pixelUrl:{type:"string"}}}}}},to={$schema:"https://json-schema.org/draft/2019-09/schema",$id:"https://example.com/example.json",title:"ODP Response Schema",type:"object",required:["data"],properties:{data:{title:"The data Schema",type:"object",required:["customer"],properties:{customer:{title:"The customer Schema",type:"object",required:[],properties:{audiences:{title:"The audiences Schema",type:"object",required:["edges"],properties:{edges:{title:"The edges Schema",type:"array",items:{title:"A Schema",type:"object",required:["node"],properties:{node:{title:"The node Schema",type:"object",required:["name","state"],properties:{name:{title:"The name Schema",type:"string",examples:["has_email","has_email_opted_in"]},state:{title:"The state Schema",type:"string",examples:["qualified"]}},examples:[]}},examples:[]},examples:[]}},examples:[]}},examples:[]}},examples:[]},errors:{title:"The errors Schema",type:"array",default:[],items:{title:"A Schema",type:"object",required:["message","locations","extensions"],properties:{message:{title:"The message Schema",type:"string",examples:["Exception while fetching data (/customer) : java.lang.RuntimeException: could not resolve _fs_user_id = asdsdaddddd"]},locations:{title:"The locations Schema",type:"array",items:{title:"A Schema",type:"object",required:["line","column"],properties:{line:{title:"The line Schema",type:"integer",examples:[2]},column:{title:"The column Schema",type:"integer",examples:[3]}},examples:[]},examples:[]},path:{title:"The path Schema",type:"array",items:{title:"A Schema",type:"string",examples:["customer"]},examples:[]},extensions:{title:"The extensions Schema",type:"object",required:["classification"],properties:{classification:{title:"The classification Schema",type:"string",examples:["InvalidIdentifierException"]}},examples:[]}},examples:[]},examples:[]}},examples:[]},ta=[],ts=function(){function e(e,t){this.toGraphQLJson=function(e,t,i){return f(f(['{"query" : "query {customer',"(".concat(e,' : \\"').concat(t,'\\") '),"{audiences","(subset: ["],(null==i?void 0:i.map(function(e,t){return'\\"'.concat(e,'\\"').concat(t<i.length-1?",":"")}))||"",!0),[']) {edges {node {name state}}}}}"}'],!1).join("")},this.requestHandler=e,this.logger=t}return e.prototype.fetchSegments=function(e,i,r,n,o){var a,s,l,u;return d(this,void 0,void 0,function(){var c,d,f,h,g,m,E,_;return p(this,function(p){switch(p.label){case 0:return e&&i?0===(null==o?void 0:o.length)?[2,ta]:(c="".concat(i,"/v3/graphql"),d=this.toGraphQLJson(r,n,o),[4,this.querySegments(e,c,r,n,d)]):(this.logger.log(t.LogLevel.ERROR,"".concat("Audience segments fetch failed"," (Parameters apiKey or apiHost invalid)")),[2,null]);case 1:return(f=p.sent())?(h=this.parseSegmentsResponseJson(f))?(null===(a=h.errors)||void 0===a?void 0:a.length)>0?(m=(g=h.errors[0].extensions).code,E=g.classification,"INVALID_IDENTIFIER_EXCEPTION"==m?this.logger.log(t.LogLevel.ERROR,"".concat("Audience segments fetch failed"," (invalid identifier)")):this.logger.log(t.LogLevel.ERROR,"".concat("Audience segments fetch failed"," (").concat(E,")")),[2,null]):(_=null===(u=null===(l=null===(s=null==h?void 0:h.data)||void 0===s?void 0:s.customer)||void 0===l?void 0:l.audiences)||void 0===u?void 0:u.edges)?[2,_.filter(function(e){return"qualified"==e.node.state}).map(function(e){return e.node.name})]:(this.logger.log(t.LogLevel.ERROR,"".concat("Audience segments fetch failed"," (decode error)")),[2,null]):(this.logger.log(t.LogLevel.ERROR,"".concat("Audience segments fetch failed"," (decode error)")),[2,null]):(this.logger.log(t.LogLevel.ERROR,"".concat("Audience segments fetch failed"," (network error)")),[2,null])}})})},e.prototype.querySegments=function(e,t,i,r,n){return d(this,void 0,void 0,function(){var i,r,o,a;return p(this,function(s){switch(s.label){case 0:i="POST",r=t,o={"Content-Type":"application/json","x-api-key":e},s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.requestHandler.makeRequest(r,o,i,n).responsePromise];case 2:return a=s.sent(),[3,4];case 3:return s.sent(),[2,null];case 4:return[2,a.body]}})})},e.prototype.parseSegmentsResponseJson=function(e){var t={};try{t=JSON.parse(e)}catch(e){return null}return!function(e,t,i){void 0===t&&(t=tn),void 0===i&&(i=!0);var r="".concat("JSON_SCHEMA_VALIDATOR"," (").concat(t.title,")");if("object"!=typeof e||null===e)throw Error(b(B.NO_JSON_PROVIDED,r));var n=o.validate(e,t);if(n.valid)return!0;if(!i)return!1;if(Array.isArray(n.errors))throw Error(b(B.INVALID_DATAFILE,r,n.errors[0].property,n.errors[0].message));throw Error(b(B.INVALID_JSON,r))}(t,to,!1)?null:t},e}(),tl=function(e){function t(t){return e.call(this,t)||this}return u(t,e),t.createInstance=function(e){var i=e.logger,r=e.odpOptions,n=e.odpIntegrationConfig,o=e.clientEngine,a=e.clientVersion;i=i||U(),o=o||"javascript-sdk",a=a||"5.3.4";var s,l,u,c=void 0;return(null==n?void 0:n.integrated)&&(c=n.odpConfig),s=(null==r?void 0:r.segmentsRequestHandler)?r.segmentsRequestHandler:new eW(i,(null==r?void 0:r.segmentsApiTimeout)||1e4),l=(null==r?void 0:r.segmentManager)?r.segmentManager:new tr((null==r?void 0:r.segmentsCache)||new e2({maxSize:null==r?void 0:r.segmentsCacheSize,timeout:null==r?void 0:r.segmentsCacheTimeout}),new ts(s,i),i,c),u=(null==r?void 0:r.eventRequestHandler)?r.eventRequestHandler:new eW(i,(null==r?void 0:r.eventApiTimeout)||1e4),new t({odpIntegrationConfig:n,segmentManager:l,eventManager:(null==r?void 0:r.eventManager)?r.eventManager:new ti({odpConfig:c,apiManager:new te(u,i),logger:i,clientEngine:o,clientVersion:a,flushInterval:null==r?void 0:r.eventFlushInterval,batchSize:null==r?void 0:r.eventBatchSize,queueSize:null==r?void 0:r.eventQueueSize,userAgentParser:null==r?void 0:r.userAgentParser}),logger:i})},t.prototype.initializeVuid=function(){return d(this,void 0,void 0,function(){var e;return p(this,function(i){switch(i.label){case 0:return[4,e3.instance(t.cache)];case 1:return e=i.sent(),this.vuid=e.vuid,[2]}})})},t.prototype.identifyUser=function(t,i){t&&e3.isVuid(t)?e.prototype.identifyUser.call(this,void 0,t):t&&i&&e3.isVuid(i)?e.prototype.identifyUser.call(this,t,i):e.prototype.identifyUser.call(this,t,i||this.vuid)},t.prototype.sendEvent=function(t){var i=t.type,r=t.action,n=t.identifiers,o=t.data,a=new Map(n);if(!n.has(eg.VUID)){if(!this.vuid)throw Error(B.ODP_SEND_EVENT_FAILED_VUID_MISSING);a.set(eg.VUID,this.vuid)}e.prototype.sendEvent.call(this,{type:i,action:r,identifiers:a,data:o})},t.prototype.isVuidEnabled=function(){return!0},t.prototype.getVuid=function(){return this.vuid},t.cache=new eQ,t}(e9);function tu(e,t,i){return{variationKey:null,enabled:!1,variables:{},ruleKey:null,flagKey:e,userContext:t,reasons:i}}var tc=function(){function e(e){var t,i=e.optimizely,r=e.userId,n=e.attributes,o=e.shouldIdentifyUser,a=this;this._qualifiedSegments=null,this.optimizely=i,this.userId=r,this.attributes=null!==(t=c({},n))&&void 0!==t?t:{},this.forcedDecisionsMap={},(void 0===o||o)&&this.optimizely.onReady().then(function(e){e.success&&a.identifyUser()})}return e.prototype.identifyUser=function(){this.optimizely.identifyUser(this.userId)},e.prototype.setAttribute=function(e,t){this.attributes[e]=t},e.prototype.getUserId=function(){return this.userId},e.prototype.getAttributes=function(){return c({},this.attributes)},e.prototype.getOptimizely=function(){return this.optimizely},Object.defineProperty(e.prototype,"qualifiedSegments",{get:function(){return this._qualifiedSegments},set:function(e){this._qualifiedSegments=e},enumerable:!1,configurable:!0}),e.prototype.decide=function(e,t){return void 0===t&&(t=[]),this.optimizely.decide(this.cloneUserContext(),e,t)},e.prototype.decideForKeys=function(e,t){return void 0===t&&(t=[]),this.optimizely.decideForKeys(this.cloneUserContext(),e,t)},e.prototype.decideAll=function(e){return void 0===e&&(e=[]),this.optimizely.decideAll(this.cloneUserContext(),e)},e.prototype.trackEvent=function(e,t){this.optimizely.track(e,this.userId,this.attributes,t)},e.prototype.setForcedDecision=function(e,t){var i,r=e.flagKey,n=null!==(i=e.ruleKey)&&void 0!==i?i:K.FORCED_DECISION_NULL_RULE_KEY,o={variationKey:t.variationKey};return this.forcedDecisionsMap[r]||(this.forcedDecisionsMap[r]={}),this.forcedDecisionsMap[r][n]=o,!0},e.prototype.getForcedDecision=function(e){return this.findForcedDecision(e)},e.prototype.removeForcedDecision=function(e){var t,i=null!==(t=e.ruleKey)&&void 0!==t?t:K.FORCED_DECISION_NULL_RULE_KEY,r=e.flagKey,n=!1;return this.forcedDecisionsMap.hasOwnProperty(r)&&(this.forcedDecisionsMap[r].hasOwnProperty(i)&&(delete this.forcedDecisionsMap[r][i],n=!0),0===Object.keys(this.forcedDecisionsMap[r]).length&&delete this.forcedDecisionsMap[r]),n},e.prototype.removeAllForcedDecisions=function(){return this.forcedDecisionsMap={},!0},e.prototype.findForcedDecision=function(e){var t,i=null!==(t=e.ruleKey)&&void 0!==t?t:K.FORCED_DECISION_NULL_RULE_KEY,r=e.flagKey;if(this.forcedDecisionsMap.hasOwnProperty(e.flagKey)){var n=this.forcedDecisionsMap[r];if(n.hasOwnProperty(i))return{variationKey:n[i].variationKey}}return null},e.prototype.cloneUserContext=function(){var t=new e({shouldIdentifyUser:!1,optimizely:this.getOptimizely(),userId:this.getUserId(),attributes:this.getAttributes()});return Object.keys(this.forcedDecisionsMap).length>0&&(t.forcedDecisionsMap=c({},this.forcedDecisionsMap)),t._qualifiedSegments=this._qualifiedSegments,t},e.prototype.fetchQualifiedSegments=function(e){return d(this,void 0,void 0,function(){var t;return p(this,function(i){switch(i.label){case 0:return[4,this.optimizely.fetchQualifiedSegments(this.userId,e)];case 1:return t=i.sent(),this.qualifiedSegments=t,[2,null!==t]}})})},e.prototype.isQualifiedFor=function(e){return!!this._qualifiedSegments&&this._qualifiedSegments.indexOf(e)>-1},e}(),td=["and","or","not"];function tp(e,t){if(Array.isArray(e)){var i=e[0],r=e.slice(1);switch("string"==typeof i&&-1===td.indexOf(i)&&(i="or",r=e),i){case"and":return function(e,t){var i=!1;if(Array.isArray(e)){for(var r=0;r<e.length;r++){var n=tp(e[r],t);if(!1===n)return!1;null===n&&(i=!0)}return!i||null}return null}(r,t);case"not":return function(e,t){if(Array.isArray(e)&&e.length>0){var i=tp(e[0],t);return null===i?null:!i}return null}(r,t);default:return function(e,t){var i=!1;if(Array.isArray(e)){for(var r=0;r<e.length;r++){var n=tp(e[r],t);if(!0===n)return!0;null===n&&(i=!0)}return!!i&&null}return null}(r,t)}}return t(e)}var tf=function(){function e(t,i,r){this.sdkKey=null!==(n=t.sdkKey)&&void 0!==n?n:"",this.environmentKey=null!==(o=t.environmentKey)&&void 0!==o?o:"",this.attributes=t.attributes,this.audiences=e.getAudiences(t),this.events=t.events,this.revision=t.revision;var n,o,a=(t.featureFlags||[]).reduce(function(e,t){return e[t.id]=t.variables,e},{}),s=e.getVariableIdMap(t),l=e.getExperimentsMap(t,a,s,r),u=l.experimentsMapById,c=l.experimentsMapByKey;this.experimentsMap=c,this.featuresMap=e.getFeaturesMap(t,a,u,s),this.datafile=i}return e.prototype.getDatafile=function(){return this.datafile},e.getAudiences=function(e){var t=[],i=[];return(e.typedAudiences||[]).forEach(function(e){t.push({id:e.id,conditions:JSON.stringify(e.conditions),name:e.name}),i.push(e.id)}),(e.audiences||[]).forEach(function(e){-1===i.indexOf(e.id)&&"$opt_dummy_audience"!=e.id&&t.push({id:e.id,conditions:JSON.stringify(e.conditions),name:e.name})}),t},e.getSerializedAudiences=function(t,i){var r="";if(t){var n="";t.forEach(function(t){var o="";if(t instanceof Array)o=e.getSerializedAudiences(t,i),o="(".concat(o,")");else if(td.indexOf(t)>-1)n=t.toUpperCase();else{var a=i[t]?i[t].name:t;r||"NOT"===n?(n=""===n?"OR":n,r=""===r?"".concat(n,' "').concat(i[t].name,'"'):r.concat(" ".concat(n,' "').concat(a,'"'))):r='"'.concat(a,'"')}""!==o&&(""!==r||"NOT"===n?(n=""===n?"OR":n,r=""===r?"".concat(n," ").concat(o):r.concat(" ".concat(n," ").concat(o))):r=r.concat(o))})}return r},e.getExperimentAudiences=function(t,i){return t.audienceConditions?e.getSerializedAudiences(t.audienceConditions,i.audiencesById):""},e.mergeFeatureVariables=function(e,t,i,r,n){var o=(e[i]||[]).reduce(function(e,t){return e[t.key]={id:t.id,key:t.key,type:t.type,value:t.defaultValue},e},{});return(r||[]).forEach(function(e){var i=t[e.id],r={id:e.id,key:i.key,type:i.type,value:n?e.value:i.defaultValue};o[i.key]=r}),o},e.getVariationsMap=function(t,i,r,n){return t.reduce(function(t,o){var a=e.mergeFeatureVariables(i,r,n,o.variables,o.featureEnabled);return t[o.key]={id:o.id,key:o.key,featureEnabled:o.featureEnabled,variablesMap:a},t},{})},e.getVariableIdMap=function(e){return(e.featureFlags||[]).reduce(function(e,t){return t.variables.forEach(function(t){e[t.id]=t}),e},{})},e.getDeliveryRules=function(t,i,r,n,o){return n.map(function(n){return{id:n.id,key:n.key,audiences:e.getExperimentAudiences(n,t),variationsMap:e.getVariationsMap(n.variations,i,o,r)}})},e.getRolloutExperimentIds=function(e){var t=[];return(e||[]).forEach(function(e){e.experiments.forEach(function(e){t.push(e.id)})}),t},e.getExperimentsMap=function(t,i,r,n){var o=this.getRolloutExperimentIds(t.rollouts),a={},s={};return(t.experiments||[]).forEach(function(l){if(-1===o.indexOf(l.id)){var u=t.experimentFeatureMap[l.id],c="";u&&u.length>0&&(c=u[0]);var d=e.getVariationsMap(l.variations,i,r,c.toString()),p={id:l.id,key:l.key,audiences:e.getExperimentAudiences(l,t),variationsMap:d};a[l.id]=p,s[l.key]&&n&&n.warn("Duplicate experiment keys found in datafile: ".concat(l.key)),s[l.key]=p}}),{experimentsMapById:a,experimentsMapByKey:s}},e.getExperimentsKeyMap=function(e){var t={};for(var i in e){var r=e[i];t[r.key]=r}return t},e.getFeaturesMap=function(t,i,r,n){var o={};return t.featureFlags.forEach(function(a){var s={},l=[];a.experimentIds.forEach(function(e){var t=r[e];t&&(s[t.key]=t),l.push(r[e])});var u=(a.variables||[]).reduce(function(e,t){return e[t.key]={id:t.id,key:t.key,type:t.type,value:t.defaultValue},e},{}),c=[],d=t.rolloutIdMap[a.rolloutId];d&&(c=e.getDeliveryRules(t,i,a.id,d.experiments,n)),o[a.key]={id:a.id,key:a.key,experimentRules:l,deliveryRules:c,experimentsMap:s,variablesMap:u}}),o},e}(),th=U();function tg(e,t){return e instanceof Error?e.message:t||"Unknown error"}var tm=function(){function e(e){this.updateListeners=[],this.configObj=null,this.optimizelyConfigObj=null,this.datafileManager=null;try{if(this.jsonSchemaValidator=e.jsonSchemaValidator,!e.datafile&&!e.sdkKey){var t=Error(b(B.DATAFILE_AND_SDK_KEY_MISSING,"PROJECT_CONFIG_MANAGER"));return this.readyPromise=Promise.resolve({success:!1,reason:tg(t)}),void th.error(t)}var i=null;e.datafile&&(i=this.handleNewDatafile(e.datafile)),e.sdkKey&&e.datafileManager?(this.datafileManager=e.datafileManager,this.datafileManager.start(),this.readyPromise=this.datafileManager.onReady().then(this.onDatafileManagerReadyFulfill.bind(this),this.onDatafileManagerReadyReject.bind(this)),this.datafileManager.on("update",this.onDatafileManagerUpdate.bind(this))):this.configObj?this.readyPromise=Promise.resolve({success:!0}):this.readyPromise=Promise.resolve({success:!1,reason:tg(i,"Invalid datafile")})}catch(e){th.error(e),this.readyPromise=Promise.resolve({success:!1,reason:tg(e,"Error in initialize")})}}return e.prototype.onDatafileManagerReadyFulfill=function(){if(this.datafileManager){var e=this.handleNewDatafile(this.datafileManager.get());return e?{success:!1,reason:tg(e)}:{success:!0}}return{success:!1,reason:tg(null,"Datafile manager is not provided")}},e.prototype.onDatafileManagerReadyReject=function(e){return{success:!1,reason:tg(e,"Failed to become ready")}},e.prototype.onDatafileManagerUpdate=function(){this.datafileManager&&this.handleNewDatafile(this.datafileManager.get())},e.prototype.handleNewDatafile=function(e){var t=this,i=eZ({datafile:e,jsonSchemaValidator:this.jsonSchemaValidator,logger:th}),r=i.configObj,n=i.error;if(n)th.error(n);else{var o=this.configObj?this.configObj.revision:"null";r&&o!==r.revision&&(this.configObj=r,this.optimizelyConfigObj=null,tt(function(){t.updateListeners.forEach(function(e){return e(r)})}))}return n},e.prototype.getConfig=function(){return this.configObj},e.prototype.getOptimizelyConfig=function(){return!this.optimizelyConfigObj&&this.configObj&&(this.optimizelyConfigObj=new tf(this.configObj,e$(this.configObj),th)),this.optimizelyConfigObj},e.prototype.onReady=function(){return this.readyPromise},e.prototype.onUpdate=function(e){var t=this;return this.updateListeners.push(e),function(){var i=t.updateListeners.indexOf(e);i>-1&&t.updateListeners.splice(i,1)}},e.prototype.stop=function(){this.datafileManager&&this.datafileManager.stop(),this.updateListeners=[]},e}(),tE=function(e){var t=[],i=e.experimentIdMap[e.experimentId].groupId;if(i){var r=e.groupIdMap[i];if(!r)throw Error(b(B.INVALID_GROUP_ID,"BUCKETER",i));if("random"===r.policy){var n=t_(r,e.bucketingId,e.userId,e.logger);if(null===n)return e.logger.log(j.INFO,G.USER_NOT_IN_ANY_EXPERIMENT,"BUCKETER",e.userId,i),t.push([G.USER_NOT_IN_ANY_EXPERIMENT,"BUCKETER",e.userId,i]),{result:null,reasons:t};if(n!==e.experimentId)return e.logger.log(j.INFO,G.USER_NOT_BUCKETED_INTO_EXPERIMENT_IN_GROUP,"BUCKETER",e.userId,e.experimentKey,i),t.push([G.USER_NOT_BUCKETED_INTO_EXPERIMENT_IN_GROUP,"BUCKETER",e.userId,e.experimentKey,i]),{result:null,reasons:t};e.logger.log(j.INFO,G.USER_BUCKETED_INTO_EXPERIMENT_IN_GROUP,"BUCKETER",e.userId,e.experimentKey,i),t.push([G.USER_BUCKETED_INTO_EXPERIMENT_IN_GROUP,"BUCKETER",e.userId,e.experimentKey,i])}}var o=ty("".concat(e.bucketingId).concat(e.experimentId));e.logger.log(j.DEBUG,G.USER_ASSIGNED_TO_EXPERIMENT_BUCKET,"BUCKETER",o,e.userId),t.push([G.USER_ASSIGNED_TO_EXPERIMENT_BUCKET,"BUCKETER",o,e.userId]);var a=tv(o,e.trafficAllocationConfig);return null===a||e.variationIdMap[a]?{result:a,reasons:t}:(a&&(e.logger.log(j.WARNING,G.INVALID_VARIATION_ID,"BUCKETER"),t.push([G.INVALID_VARIATION_ID,"BUCKETER"])),{result:null,reasons:t})},t_=function(e,t,i,r){var n=ty("".concat(t).concat(e.id));return r.log(j.DEBUG,G.USER_ASSIGNED_TO_EXPERIMENT_BUCKET,"BUCKETER",n,i),tv(n,e.trafficAllocation)},tv=function(e,t){for(var i=0;i<t.length;i++)if(e<t[i].endOfRange)return t[i].entityId;return null},ty=function(e){try{var t=a.v3(e,1)/0x100000000;return Math.floor(1e4*t)}catch(t){throw Error(b(B.INVALID_BUCKETING_ID,"BUCKETER",e,t.message))}},tb=U();function tI(e){return/^\d+$/.test(e)}function tO(e){var t=e.indexOf("-"),i=e.indexOf("+");return!(t<0)&&(i<0||t<i)}function tR(e){var t=e.indexOf("-"),i=e.indexOf("+");return!(i<0)&&(t<0||i<t)}function tN(e){var t=e,i="";if(/\s/.test(e))return tb.warn(G.UNKNOWN_MATCH_TYPE,"SEMANTIC VERSION",e),null;if(tO(e)?(t=e.substring(0,e.indexOf("-")),i=e.substring(e.indexOf("-")+1)):tR(e)&&(t=e.substring(0,e.indexOf("+")),i=e.substring(e.indexOf("+")+1)),"string"!=typeof t||"string"!=typeof i)return null;var r=t.split(".").length-1;if(r>2)return tb.warn(G.UNKNOWN_MATCH_TYPE,"SEMANTIC VERSION",e),null;var n=t.split(".");if(n.length!=r+1)return tb.warn(G.UNKNOWN_MATCH_TYPE,"SEMANTIC VERSION",e),null;for(var o=0;o<n.length;o++)if(!tI(n[o]))return tb.warn(G.UNKNOWN_MATCH_TYPE,"SEMANTIC VERSION",e),null;return i&&n.push(i),n}var tT="CUSTOM_ATTRIBUTE_CONDITION_EVALUATOR",tA=U(),tD=["exact","exists","gt","ge","lt","le","substring","semver_eq","semver_lt","semver_le","semver_gt","semver_ge"],tS={};function tw(e){return"string"==typeof e||"boolean"==typeof e||O.isNumber(e)}function tL(e,t){var i=t.getAttributes(),r=e.value,n=typeof r,o=e.name,a=i[o],s=typeof a;return!tw(r)||O.isNumber(r)&&!O.isSafeInteger(r)?(tA.warn(G.UNEXPECTED_CONDITION_VALUE,tT,JSON.stringify(e)),null):null===a?(tA.debug(G.UNEXPECTED_TYPE_NULL,tT,JSON.stringify(e),o),null):tw(a)&&n===s?O.isNumber(a)&&!O.isSafeInteger(a)?(tA.warn(G.OUT_OF_BOUNDS,tT,JSON.stringify(e),o),null):r===a:(tA.warn(G.UNEXPECTED_TYPE,tT,JSON.stringify(e),s,o),null)}function tU(e,t){var i=t.getAttributes(),r=e.name,n=i[r],o=typeof n,a=e.value;return null!==a&&O.isSafeInteger(a)?null===n?(tA.debug(G.UNEXPECTED_TYPE_NULL,tT,JSON.stringify(e),r),!1):O.isNumber(n)?!!O.isSafeInteger(n)||(tA.warn(G.OUT_OF_BOUNDS,tT,JSON.stringify(e),r),!1):(tA.warn(G.UNEXPECTED_TYPE,tT,JSON.stringify(e),o,r),!1):(tA.warn(G.UNEXPECTED_CONDITION_VALUE,tT,JSON.stringify(e)),!1)}function tC(e,t){var i=t.getAttributes(),r=e.name,n=i[r],o=e.value;return"string"!=typeof o?(tA.warn(G.UNEXPECTED_CONDITION_VALUE,tT,JSON.stringify(e)),null):null===n?(tA.debug(G.UNEXPECTED_TYPE_NULL,tT,JSON.stringify(e),r),null):"string"!=typeof n?(tA.warn(G.UNEXPECTED_TYPE,tT,JSON.stringify(e),typeof n,r),null):function(e,t){var i=tN(t),r=tN(e);if(!i||!r)return null;for(var n=i.length,o=0;o<r.length;o++){if(n<=o)return tO(e)||tR(e)?1:-1;if(tI(i[o])){var a=parseInt(i[o]),s=parseInt(r[o]);if(a>s)return 1;if(a<s)return -1}else{if(i[o]<r[o])return tO(e)&&!tO(t)?1:-1;if(i[o]>r[o])return!tO(e)&&tO(t)?-1:1}}return tO(t)&&!tO(e)?-1:0}(o,n)}tS.exact=tL,tS.exists=function(e,t){return null!=t.getAttributes()[e.name]},tS.gt=function(e,t){var i=t.getAttributes()[e.name],r=e.value;return tU(e,t)&&null!==r?i>r:null},tS.ge=function(e,t){var i=t.getAttributes()[e.name],r=e.value;return tU(e,t)&&null!==r?i>=r:null},tS.lt=function(e,t){var i=t.getAttributes()[e.name],r=e.value;return tU(e,t)&&null!==r?i<r:null},tS.le=function(e,t){var i=t.getAttributes()[e.name],r=e.value;return tU(e,t)&&null!==r?i<=r:null},tS.substring=function(e,t){var i=t.getAttributes(),r=e.name,n=i[e.name],o=typeof n,a=e.value;return"string"!=typeof a?(tA.warn(G.UNEXPECTED_CONDITION_VALUE,tT,JSON.stringify(e)),null):null===n?(tA.debug(G.UNEXPECTED_TYPE_NULL,tT,JSON.stringify(e),r),null):"string"!=typeof n?(tA.warn(G.UNEXPECTED_TYPE,tT,JSON.stringify(e),o,r),null):-1!==n.indexOf(a)},tS.semver_eq=function(e,t){var i=tC(e,t);return null===i?null:0===i},tS.semver_gt=function(e,t){var i=tC(e,t);return null===i?null:i>0},tS.semver_ge=function(e,t){var i=tC(e,t);return null===i?null:i>=0},tS.semver_lt=function(e,t){var i=tC(e,t);return null===i?null:i<0},tS.semver_le=function(e,t){var i=tC(e,t);return null===i?null:i<=0};var tx=Object.freeze({__proto__:null,evaluate:function(e,t){var i=t.getAttributes(),r=e.match;if(void 0!==r&&-1===tD.indexOf(r))return tA.warn(G.UNKNOWN_MATCH_TYPE,tT,JSON.stringify(e)),null;var n=e.name;return i.hasOwnProperty(n)||"exists"==r?(r&&tS[r]||tL)(e,t):(tA.debug(G.MISSING_ATTRIBUTE_VALUE,tT,JSON.stringify(e),n),null)}}),tP=U(),tz=["qualified"],tk={};function tM(e,t){return t.isQualifiedFor(e.value)}tk.qualified=tM;var tV=Object.freeze({__proto__:null,evaluate:function(e,t){var i=e.match;return void 0!==i&&-1===tz.indexOf(i)?(tP.warn(G.UNKNOWN_MATCH_TYPE,"ODP_SEGMENT_CONDITION_EVALUATOR",JSON.stringify(e)),null):(i&&tk[i]||tM)(e,t)}}),tF=U(),tj=function(){function e(e){this.typeToEvaluatorMap=O.assign({},e,{custom_attribute:tx,third_party_dimension:tV})}return e.prototype.evaluate=function(e,t,i){var r=this;return!e||0===e.length||!!tp(e,function(e){var n=t[e];if(n){tF.log(j.DEBUG,G.EVALUATING_AUDIENCE,"AUDIENCE_EVALUATOR",e,JSON.stringify(n.conditions));var o=tp(n.conditions,r.evaluateConditionWithUserAttributes.bind(r,i)),a=null===o?"UNKNOWN":o.toString().toUpperCase();return tF.log(j.DEBUG,G.AUDIENCE_EVALUATION_RESULT,"AUDIENCE_EVALUATOR",e,a),o}return null})},e.prototype.evaluateConditionWithUserAttributes=function(e,t){var i=this.typeToEvaluatorMap[t.type];if(!i)return tF.log(j.WARNING,G.UNKNOWN_CONDITION_TYPE,"AUDIENCE_EVALUATOR",JSON.stringify(t)),null;try{return i.evaluate(t,e)}catch(e){tF.log(j.ERROR,B.CONDITION_EVALUATOR_ERROR,"AUDIENCE_EVALUATOR",t.type,e.message)}return null},e}();function tB(e){return"string"==typeof e&&""!==e}var tG="DECISION_SERVICE",tK=function(){function e(e){this.audienceEvaluator=new tj(e.UNSTABLE_conditionEvaluators),this.forcedVariationMap={},this.logger=e.logger,this.userProfileService=e.userProfileService||null}return e.prototype.getVariation=function(e,i,r,n){void 0===n&&(n={});var o=r.getUserId(),a=r.getAttributes(),s=this.getBucketingId(o,a),l=[],u=i.key;if(!this.checkIfExperimentIsActive(e,u))return this.logger.log(j.INFO,G.EXPERIMENT_NOT_RUNNING,tG,u),l.push([G.EXPERIMENT_NOT_RUNNING,tG,u]),{result:null,reasons:l};var c=this.getForcedVariation(e,u,o);l.push.apply(l,c.reasons);var d=c.result;if(d)return{result:d,reasons:l};var p=this.getWhitelistedVariation(i,o);l.push.apply(l,p.reasons);var f=p.result;if(f)return{result:f.key,reasons:l};var h=n[t.OptimizelyDecideOption.IGNORE_USER_PROFILE_SERVICE],g=this.resolveExperimentBucketMap(o,a);if(!h&&(f=this.getStoredVariation(e,i,o,g)))return this.logger.log(j.INFO,G.RETURNING_STORED_VARIATION,tG,f.key,u,o),l.push([G.RETURNING_STORED_VARIATION,tG,f.key,u,o]),{result:f.key,reasons:l};var m=this.checkIfUserIsInAudience(e,i,Y.EXPERIMENT,r,"");if(l.push.apply(l,m.reasons),!m.result)return this.logger.log(j.INFO,G.USER_NOT_IN_EXPERIMENT,tG,o,u),l.push([G.USER_NOT_IN_EXPERIMENT,tG,o,u]),{result:null,reasons:l};var E=tE(this.buildBucketerParams(e,i,s,o));l.push.apply(l,E.reasons);var _=E.result;return _&&(f=e.variationIdMap[_]),f?(this.logger.log(j.INFO,G.USER_HAS_VARIATION,tG,o,f.key,u),l.push([G.USER_HAS_VARIATION,tG,o,f.key,u]),h||this.saveUserProfile(i,f,o,g),{result:f.key,reasons:l}):(this.logger.log(j.DEBUG,G.USER_HAS_NO_VARIATION,tG,o,u),l.push([G.USER_HAS_NO_VARIATION,tG,o,u]),{result:null,reasons:l})},e.prototype.resolveExperimentBucketMap=function(e,t){t=t||{};var i=this.getUserProfile(e)||{},r=t[K.STICKY_BUCKETING_KEY];return O.assign({},i.experiment_bucket_map,r)},e.prototype.checkIfExperimentIsActive=function(e,t){return"Running"===ej(e,t)},e.prototype.getWhitelistedVariation=function(e,t){var i=[];if(e.forcedVariations&&e.forcedVariations.hasOwnProperty(t)){var r=e.forcedVariations[t];return e.variationKeyMap.hasOwnProperty(r)?(this.logger.log(j.INFO,G.USER_FORCED_IN_VARIATION,tG,t,r),i.push([G.USER_FORCED_IN_VARIATION,tG,t,r]),{result:e.variationKeyMap[r],reasons:i}):(this.logger.log(j.ERROR,G.FORCED_BUCKETING_FAILED,tG,r,t),i.push([G.FORCED_BUCKETING_FAILED,tG,r,t]),{result:null,reasons:i})}return{result:null,reasons:i}},e.prototype.checkIfUserIsInAudience=function(e,t,i,r,n){var o=[],a=function(e,t){var i=e.experimentIdMap[t];if(!i)throw Error(b(B.INVALID_EXPERIMENT_ID,ex,t));return i.audienceConditions||i.audienceIds}(e,t.id),s=e.audiencesById;this.logger.log(j.DEBUG,G.EVALUATING_AUDIENCES_COMBINED,tG,i,n||t.key,JSON.stringify(a)),o.push([G.EVALUATING_AUDIENCES_COMBINED,tG,i,n||t.key,JSON.stringify(a)]);var l=this.audienceEvaluator.evaluate(a,s,r);return this.logger.log(j.INFO,G.AUDIENCE_EVALUATION_RESULT_COMBINED,tG,i,n||t.key,l.toString().toUpperCase()),o.push([G.AUDIENCE_EVALUATION_RESULT_COMBINED,tG,i,n||t.key,l.toString().toUpperCase()]),{result:l,reasons:o}},e.prototype.buildBucketerParams=function(e,t,i,r){return{bucketingId:i,experimentId:t.id,experimentKey:t.key,experimentIdMap:e.experimentIdMap,experimentKeyMap:e.experimentKeyMap,groupIdMap:e.groupIdMap,logger:this.logger,trafficAllocationConfig:eK(e,t.id),userId:r,variationIdMap:e.variationIdMap}},e.prototype.getStoredVariation=function(e,t,i,r){if(r.hasOwnProperty(t.id)){var n=r[t.id],o=n.variation_id;if(e.variationIdMap.hasOwnProperty(o))return e.variationIdMap[n.variation_id];this.logger.log(j.INFO,G.SAVED_VARIATION_NOT_FOUND,tG,i,o,t.key)}return null},e.prototype.getUserProfile=function(e){if(!this.userProfileService)return{user_id:e,experiment_bucket_map:{}};try{return this.userProfileService.lookup(e)}catch(t){this.logger.log(j.ERROR,B.USER_PROFILE_LOOKUP_ERROR,tG,e,t.message)}return null},e.prototype.saveUserProfile=function(e,t,i,r){if(this.userProfileService)try{r[e.id]={variation_id:t.id},this.userProfileService.save({user_id:i,experiment_bucket_map:r}),this.logger.log(j.INFO,G.SAVED_VARIATION,tG,t.key,e.key,i)}catch(e){this.logger.log(j.ERROR,B.USER_PROFILE_SAVE_ERROR,tG,i,e.message)}},e.prototype.getVariationForFeature=function(e,t,i,r){void 0===r&&(r={});var n=[],o=this.getVariationForFeatureExperiment(e,t,i,r);n.push.apply(n,o.reasons);var a=o.result;if(null!==a.variation)return{result:a,reasons:n};var s=this.getVariationForRollout(e,t,i);n.push.apply(n,s.reasons);var l=s.result,u=i.getUserId();return l.variation?(this.logger.log(j.DEBUG,G.USER_IN_ROLLOUT,tG,u,t.key),n.push([G.USER_IN_ROLLOUT,tG,u,t.key])):(this.logger.log(j.DEBUG,G.USER_NOT_IN_ROLLOUT,tG,u,t.key),n.push([G.USER_NOT_IN_ROLLOUT,tG,u,t.key])),{result:l,reasons:n}},e.prototype.getVariationForFeatureExperiment=function(e,t,i,r){void 0===r&&(r={});var n,o,a=[],s=null;if(t.experimentIds.length>0)for(o=0;o<t.experimentIds.length;o++){var l=eq(e,t.experimentIds[o],this.logger);if(l&&(n=this.getVariationFromExperimentRule(e,t.key,l,i,r),a.push.apply(a,n.reasons),s=n.result)){var u=null;return(u=l.variationKeyMap[s])||(u=eH(e,t.key,s)),{result:{experiment:l,variation:u,decisionSource:H.FEATURE_TEST},reasons:a}}}else this.logger.log(j.DEBUG,G.FEATURE_HAS_NO_EXPERIMENTS,tG,t.key),a.push([G.FEATURE_HAS_NO_EXPERIMENTS,tG,t.key]);return{result:{experiment:null,variation:null,decisionSource:H.FEATURE_TEST},reasons:a}},e.prototype.getVariationForRollout=function(e,t,i){var r=[];if(!t.rolloutId)return this.logger.log(j.DEBUG,G.NO_ROLLOUT_EXISTS,tG,t.key),r.push([G.NO_ROLLOUT_EXISTS,tG,t.key]),{result:{experiment:null,variation:null,decisionSource:H.ROLLOUT},reasons:r};var n=e.rolloutIdMap[t.rolloutId];if(!n)return this.logger.log(j.ERROR,B.INVALID_ROLLOUT_ID,tG,t.rolloutId,t.key),r.push([B.INVALID_ROLLOUT_ID,tG,t.rolloutId,t.key]),{result:{experiment:null,variation:null,decisionSource:H.ROLLOUT},reasons:r};var o,a,s,l=n.experiments;if(0===l.length)return this.logger.log(j.ERROR,G.ROLLOUT_HAS_NO_EXPERIMENTS,tG,t.rolloutId),r.push([G.ROLLOUT_HAS_NO_EXPERIMENTS,tG,t.rolloutId]),{result:{experiment:null,variation:null,decisionSource:H.ROLLOUT},reasons:r};for(var u=0;u<l.length;){if(o=this.getVariationFromDeliveryRule(e,t.key,l,u,i),r.push.apply(r,o.reasons),s=o.result,a=o.skipToEveryoneElse,s)return{result:{experiment:e.experimentIdMap[l[u].id],variation:s,decisionSource:H.ROLLOUT},reasons:r};u=a?l.length-1:u+1}return{result:{experiment:null,variation:null,decisionSource:H.ROLLOUT},reasons:r}},e.prototype.getBucketingId=function(e,t){var i=e;return null!=t&&"object"==typeof t&&t.hasOwnProperty(K.BUCKETING_ID)&&("string"==typeof t[K.BUCKETING_ID]?(i=String(t[K.BUCKETING_ID]),this.logger.log(j.DEBUG,G.VALID_BUCKETING_ID,tG,i)):this.logger.log(j.WARNING,G.BUCKETING_ID_NOT_STRING,tG)),i},e.prototype.findValidatedForcedDecision=function(e,t,i,r){var n,o=[],a=t.getForcedDecision({flagKey:i,ruleKey:r}),s=null,l=t.getUserId();return e&&a&&((s=eH(e,i,n=a.variationKey))?r?(this.logger.log(j.INFO,G.USER_HAS_FORCED_DECISION_WITH_RULE_SPECIFIED,n,i,r,l),o.push([G.USER_HAS_FORCED_DECISION_WITH_RULE_SPECIFIED,n,i,r,l])):(this.logger.log(j.INFO,G.USER_HAS_FORCED_DECISION_WITH_NO_RULE_SPECIFIED,n,i,l),o.push([G.USER_HAS_FORCED_DECISION_WITH_NO_RULE_SPECIFIED,n,i,l])):r?(this.logger.log(j.INFO,G.USER_HAS_FORCED_DECISION_WITH_RULE_SPECIFIED_BUT_INVALID,i,r,l),o.push([G.USER_HAS_FORCED_DECISION_WITH_RULE_SPECIFIED_BUT_INVALID,i,r,l])):(this.logger.log(j.INFO,G.USER_HAS_FORCED_DECISION_WITH_NO_RULE_SPECIFIED_BUT_INVALID,i,l),o.push([G.USER_HAS_FORCED_DECISION_WITH_NO_RULE_SPECIFIED_BUT_INVALID,i,l]))),{result:s,reasons:o}},e.prototype.removeForcedVariation=function(e,t,i){if(!e)throw Error(b(B.INVALID_USER_ID,tG));if(!this.forcedVariationMap.hasOwnProperty(e))throw Error(b(B.USER_NOT_IN_FORCED_VARIATION,tG,e));delete this.forcedVariationMap[e][t],this.logger.log(j.DEBUG,G.VARIATION_REMOVED_FOR_USER,tG,i,e)},e.prototype.setInForcedVariationMap=function(e,t,i){this.forcedVariationMap.hasOwnProperty(e)||(this.forcedVariationMap[e]={}),this.forcedVariationMap[e][t]=i,this.logger.log(j.DEBUG,G.USER_MAPPED_TO_FORCED_VARIATION,tG,i,t,e)},e.prototype.getForcedVariation=function(e,t,i){var r,n=[],o=this.forcedVariationMap[i];if(!o)return this.logger.log(j.DEBUG,G.USER_HAS_NO_FORCED_VARIATION,tG,i),{result:null,reasons:n};try{var a=eG(e,t);if(!a.hasOwnProperty("id"))return this.logger.log(j.ERROR,B.IMPROPERLY_FORMATTED_EXPERIMENT,tG,t),n.push([B.IMPROPERLY_FORMATTED_EXPERIMENT,tG,t]),{result:null,reasons:n};r=a.id}catch(e){return this.logger.log(j.ERROR,e.message),n.push(e.message),{result:null,reasons:n}}var s=o[r];if(!s)return this.logger.log(j.DEBUG,G.USER_HAS_NO_FORCED_VARIATION_FOR_EXPERIMENT,tG,t,i),{result:null,reasons:n};var l=eB(e,s);return l?(this.logger.log(j.DEBUG,G.USER_HAS_FORCED_VARIATION,tG,l,t,i),n.push([G.USER_HAS_FORCED_VARIATION,tG,l,t,i])):this.logger.log(j.DEBUG,G.USER_HAS_NO_FORCED_VARIATION_FOR_EXPERIMENT,tG,t,i),{result:l,reasons:n}},e.prototype.setForcedVariation=function(e,t,i,r){if(null!=r&&!tB(r))return this.logger.log(j.ERROR,B.INVALID_VARIATION_KEY,tG),!1;try{var n,o,a=eG(e,t);if(!a.hasOwnProperty("id"))return this.logger.log(j.ERROR,B.IMPROPERLY_FORMATTED_EXPERIMENT,tG,t),!1;o=a.id}catch(e){return this.logger.log(j.ERROR,e.message),!1}if(null==r)try{return this.removeForcedVariation(i,o,t),!0}catch(e){return this.logger.log(j.ERROR,e.message),!1}var s=(n=e.experimentKeyMap[t]).variationKeyMap.hasOwnProperty(r)?n.variationKeyMap[r].id:null;if(!s)return this.logger.log(j.ERROR,B.NO_VARIATION_FOR_EXPERIMENT_KEY,tG,r,t),!1;try{return this.setInForcedVariationMap(i,o,s),!0}catch(e){return this.logger.log(j.ERROR,e.message),!1}},e.prototype.getVariationFromExperimentRule=function(e,t,i,r,n){void 0===n&&(n={});var o=[],a=this.findValidatedForcedDecision(e,r,t,i.key);o.push.apply(o,a.reasons);var s=a.result;if(s)return{result:s.key,reasons:o};var l=this.getVariation(e,i,r,n);return o.push.apply(o,l.reasons),{result:l.result,reasons:o}},e.prototype.getVariationFromDeliveryRule=function(e,t,i,r,n){var o=[],a=!1,s=i[r],l=this.findValidatedForcedDecision(e,n,t,s.key);o.push.apply(o,l.reasons);var u=l.result;if(u)return{result:u,reasons:o,skipToEveryoneElse:a};var c,d,p=n.getUserId(),f=n.getAttributes(),h=this.getBucketingId(p,f),g=r===i.length-1,m=g?"Everyone Else":r+1,E=null,_=this.checkIfUserIsInAudience(e,s,Y.RULE,n,m);return o.push.apply(o,_.reasons),_.result?(this.logger.log(j.DEBUG,G.USER_MEETS_CONDITIONS_FOR_TARGETING_RULE,tG,p,m),o.push([G.USER_MEETS_CONDITIONS_FOR_TARGETING_RULE,tG,p,m]),d=tE(this.buildBucketerParams(e,s,h,p)),o.push.apply(o,d.reasons),(c=d.result)&&(E=e.variationIdMap.hasOwnProperty(c)?e.variationIdMap[c]:null),E?(this.logger.log(j.DEBUG,G.USER_BUCKETED_INTO_TARGETING_RULE,tG,p,m),o.push([G.USER_BUCKETED_INTO_TARGETING_RULE,tG,p,m])):g||(this.logger.log(j.DEBUG,G.USER_NOT_BUCKETED_INTO_TARGETING_RULE,tG,p,m),o.push([G.USER_NOT_BUCKETED_INTO_TARGETING_RULE,tG,p,m]),a=!0)):(this.logger.log(j.DEBUG,G.USER_DOESNT_MEET_CONDITIONS_FOR_TARGETING_RULE,tG,p,m),o.push([G.USER_DOESNT_MEET_CONDITIONS_FOR_TARGETING_RULE,tG,p,m])),{result:E,reasons:o,skipToEveryoneElse:a}},e}();function tq(e,t){var i=e.revenue;if(null==i)return null;var r="string"==typeof i?parseInt(i):i;return isFinite(r)?(t.log(j.INFO,G.PARSED_REVENUE_VALUE,"EVENT_TAG_UTILS",r),r):(t.log(j.INFO,G.FAILED_TO_PARSE_REVENUE,"EVENT_TAG_UTILS",i),null)}function tH(e,t){var i=e.value;if(null==i)return null;var r="string"==typeof i?parseFloat(i):i;return isFinite(r)?(t.log(j.INFO,G.PARSED_NUMERIC_VALUE,"EVENT_TAG_UTILS",r),r):(t.log(j.INFO,G.FAILED_TO_PARSE_VALUE,"EVENT_TAG_UTILS",i),null)}function tY(e,t){return"string"==typeof e&&("string"==typeof t||"boolean"==typeof t||O.isNumber(t)&&O.isSafeInteger(t))}var t$="https://logx.optimizely.com/v1/events";function tZ(e){var t=e.attributes,i=e.userId,r=e.clientEngine,n=e.clientVersion,o=e.configObj,a=e.logger,s=!!o.anonymizeIP&&o.anonymizeIP,l=o.botFiltering,u={account_id:o.accountId,project_id:o.projectId,visitors:[{snapshots:[],visitor_id:i,attributes:[]}],revision:o.revision,client_name:r,client_version:n,anonymize_ip:s,enrich_decisions:!0};return t&&Object.keys(t||{}).forEach(function(e){var i=t[e];if(tY(e,i)){var r=eV(o,e,a);r&&u.visitors[0].attributes.push({entity_id:r,key:e,type:"custom",value:i})}}),"boolean"==typeof l&&u.visitors[0].attributes.push({entity_id:K.BOT_FILTERING,key:K.BOT_FILTERING,type:"custom",value:l}),u}function tX(e){var t,i;return null!==(i=null===(t=e.experiment)||void 0===t?void 0:t.key)&&void 0!==i?i:""}function tW(e){var t,i;return null!==(i=null===(t=e.variation)||void 0===t?void 0:t.key)&&void 0!==i?i:""}function tJ(e){var t,i;return null!==(i=null===(t=e.variation)||void 0===t?void 0:t.featureEnabled)&&void 0!==i&&i}function tQ(e){var t,i;return null!==(i=null===(t=e.experiment)||void 0===t?void 0:t.id)&&void 0!==i?i:null}function t0(e){var t,i;return null!==(i=null===(t=e.variation)||void 0===t?void 0:t.id)&&void 0!==i?i:null}var t1=U("EVENT_BUILDER");function t2(e,t){var i=[];return t&&Object.keys(t||{}).forEach(function(r){var n=t[r];if(tY(r,n)){var o=eV(e,r,t1);o&&i.push({entityId:o,key:r,value:n})}}),i}var t3="USER_PROFILE_SERVICE_VALIDATOR",t5=function(){function e(e){var i,r=this,n=e.clientEngine;n||(e.logger.log(j.INFO,G.INVALID_CLIENT_ENGINE,"OPTIMIZELY",n),n="node-sdk"),this.clientEngine=n,this.clientVersion=e.clientVersion||"5.3.4",this.errorHandler=e.errorHandler,this.isOptimizelyConfigValid=e.isValidInstance,this.logger=e.logger,this.odpManager=e.odpManager;var o=null!==(i=e.defaultDecideOptions)&&void 0!==i?i:[];Array.isArray(o)||(this.logger.log(j.DEBUG,G.INVALID_DEFAULT_DECIDE_OPTIONS,"OPTIMIZELY"),o=[]);var a={};o.forEach(function(e){t.OptimizelyDecideOption[e]?a[e]=!0:r.logger.log(j.WARNING,G.UNRECOGNIZED_DECIDE_OPTION,"OPTIMIZELY",e)}),this.defaultDecideOptions=a,this.projectConfigManager=new tm({datafile:e.datafile,jsonSchemaValidator:e.jsonSchemaValidator,sdkKey:e.sdkKey,datafileManager:e.datafileManager}),this.disposeOnUpdate=this.projectConfigManager.onUpdate(function(e){r.logger.log(j.INFO,G.UPDATED_OPTIMIZELY_CONFIG,"OPTIMIZELY",e.revision,e.projectId),r.notificationCenter.sendNotifications(z.OPTIMIZELY_CONFIG_UPDATE),r.updateOdpSettings()});var s=this.projectConfigManager.onReady(),l=null;if(e.userProfileService)try{(function(e){if("object"==typeof e&&null!==e){if("function"!=typeof e.lookup)throw Error(b(B.INVALID_USER_PROFILE_SERVICE,t3,"Missing function 'lookup'"));if("function"!=typeof e.save)throw Error(b(B.INVALID_USER_PROFILE_SERVICE,t3,"Missing function 'save'"));return!0}throw Error(b(B.INVALID_USER_PROFILE_SERVICE,t3))})(e.userProfileService)&&(l=e.userProfileService,this.logger.log(j.INFO,G.VALID_USER_PROFILE_SERVICE,"OPTIMIZELY"))}catch(e){this.logger.log(j.WARNING,e.message)}this.decisionService=new tK({userProfileService:l,logger:this.logger,UNSTABLE_conditionEvaluators:e.UNSTABLE_conditionEvaluators}),this.notificationCenter=e.notificationCenter,this.eventProcessor=e.eventProcessor;var u=this.eventProcessor.start();this.readyPromise=Promise.all([s,u,e.odpManager?e.odpManager.onReady():Promise.resolve()]).then(function(e){return e[0]}),this.readyTimeouts={},this.nextReadyTimeoutId=0}return e.prototype.getProjectConfig=function(){return this.projectConfigManager.getConfig()},e.prototype.isValidInstance=function(){return this.isOptimizelyConfigValid&&!!this.projectConfigManager.getConfig()},e.prototype.activate=function(e,t,i){try{if(!this.isValidInstance())return this.logger.log(j.ERROR,G.INVALID_OBJECT,"OPTIMIZELY","activate"),null;if(!this.validateInputs({experiment_key:e,user_id:t},i))return this.notActivatingExperiment(e,t);var r=this.projectConfigManager.getConfig();if(!r)return null;try{var n=this.getVariation(e,t,i);if(null===n)return this.notActivatingExperiment(e,t);if("Running"!==ej(r,e))return this.logger.log(j.DEBUG,G.SHOULD_NOT_DISPATCH_ACTIVATE,"OPTIMIZELY",e),n;var o=eG(r,e),a={experiment:o,variation:o.variationKeyMap[n],decisionSource:H.EXPERIMENT};return this.sendImpressionEvent(a,"",t,!0,i),n}catch(i){return this.logger.log(j.ERROR,i.message),this.logger.log(j.INFO,G.NOT_ACTIVATING_USER,"OPTIMIZELY",t,e),this.errorHandler.handleError(i),null}}catch(e){return this.logger.log(j.ERROR,e.message),this.errorHandler.handleError(e),null}},e.prototype.sendImpressionEvent=function(e,t,i,r,n){var o=this.projectConfigManager.getConfig();if(o){var a,s,l,u,c,d,p,f,h,g,m,E,_,v,y,b=(s=(a={decisionObj:e,flagKey:t,enabled:r,userId:i,userAttributes:n,clientEngine:this.clientEngine,clientVersion:this.clientVersion,configObj:o}).configObj,l=a.decisionObj,u=a.userId,c=a.flagKey,d=a.enabled,p=a.userAttributes,f=a.clientEngine,h=a.clientVersion,g=l.decisionSource,m=tX(l),E=tQ(l),_=tW(l),v=t0(l),y=null!==E?eM(s,E):null,{type:"impression",timestamp:O.currentTimestamp(),uuid:O.uuid(),user:{id:u,attributes:t2(s,p)},context:{accountId:s.accountId,projectId:s.projectId,revision:s.revision,clientName:f,clientVersion:h,anonymizeIP:s.anonymizeIP||!1,botFiltering:s.botFiltering},layer:{id:y},experiment:{id:E,key:m},variation:{id:v,key:_},ruleKey:m,flagKey:c,ruleType:g,enabled:d});this.eventProcessor.process(b),this.emitNotificationCenterActivate(e,t,i,r,n)}},e.prototype.emitNotificationCenterActivate=function(e,t,i,r,n){var o=this.projectConfigManager.getConfig();if(o){var a,s=e.decisionSource,l=tX(e),u=tQ(e),c=tW(e),d=t0(e);null!==u&&""!==c&&(a=o.experimentIdMap[u]);var p,f,h,g,m,E,_,v,y,b,I,R,N,T=(I=tZ(p={attributes:n,clientEngine:this.clientEngine,clientVersion:this.clientVersion,configObj:o,experimentId:u,ruleKey:l,flagKey:t,ruleType:s,userId:i,enabled:r,variationId:d,logger:this.logger}),f=p.configObj,h=p.experimentId,g=p.variationId,m=p.ruleKey,E=p.ruleType,_=p.flagKey,v=p.enabled,y=h?eM(f,h):null,b=g?eB(f,g):null,R={decisions:[{campaign_id:y,experiment_id:h,variation_id:g,metadata:{flag_key:_,rule_key:m,rule_type:E,variation_key:b=b||"",enabled:v}}],events:[{entity_id:y,timestamp:O.currentTimestamp(),key:"campaign_activated",uuid:O.uuid()}]},I.visitors[0].snapshots.push(R),{httpVerb:"POST",url:t$,params:I});a&&a.variationKeyMap&&""!==c&&(N=a.variationKeyMap[c]),this.notificationCenter.sendNotifications(z.ACTIVATE,{experiment:a,userId:i,attributes:n,variation:N,logEvent:T})}},e.prototype.track=function(e,t,i,r){try{if(!this.isValidInstance())return void this.logger.log(j.ERROR,G.INVALID_OBJECT,"OPTIMIZELY","track");if(!this.validateInputs({user_id:t,event_key:e},i,r))return;var n,o,a,s,l,u,c,d,p,f,h,g=this.projectConfigManager.getConfig();if(!g)return;if(!g.eventKeyMap.hasOwnProperty(e))return this.logger.log(j.WARNING,G.EVENT_KEY_NOT_FOUND,"OPTIMIZELY",e),void this.logger.log(j.WARNING,G.NOT_TRACKING_USER,"OPTIMIZELY",t);var m=(o=(n={eventKey:e,eventTags:r=this.filterEmptyValues(r),userId:t,userAttributes:i,clientEngine:this.clientEngine,clientVersion:this.clientVersion,configObj:g}).configObj,a=n.userId,s=n.userAttributes,l=n.clientEngine,u=n.clientVersion,c=n.eventKey,d=n.eventTags,p=eF(o,c),f=d?tq(d,t1):null,h=d?tH(d,t1):null,{type:"conversion",timestamp:O.currentTimestamp(),uuid:O.uuid(),user:{id:a,attributes:t2(o,s)},context:{accountId:o.accountId,projectId:o.projectId,revision:o.revision,clientName:l,clientVersion:u,anonymizeIP:o.anonymizeIP||!1,botFiltering:o.botFiltering},event:{id:p,key:c},revenue:f,value:h,tags:d});this.logger.log(j.INFO,G.TRACK_EVENT,"OPTIMIZELY",e,t),this.eventProcessor.process(m),this.emitNotificationCenterTrack(e,t,i,r)}catch(e){this.logger.log(j.ERROR,e.message),this.errorHandler.handleError(e),this.logger.log(j.ERROR,G.NOT_TRACKING_USER,"OPTIMIZELY",t)}},e.prototype.emitNotificationCenterTrack=function(e,t,i,r){try{var n,o,a,s=this.projectConfigManager.getConfig();if(!s)return;var l=(n={attributes:i,clientEngine:this.clientEngine,clientVersion:this.clientVersion,configObj:s,eventKey:e,eventTags:r,logger:this.logger,userId:t},o=tZ(n),a=function(e,t,i,r){var n={events:[]},o={entity_id:eF(e,t),timestamp:O.currentTimestamp(),uuid:O.uuid(),key:t};if(r){var a=tq(r,i);null!==a&&(o.revenue=a);var s=tH(r,i);null!==s&&(o.value=s),o.tags=r}return n.events.push(o),n}(n.configObj,n.eventKey,n.logger,n.eventTags),o.visitors[0].snapshots=[a],{httpVerb:"POST",url:t$,params:o});this.notificationCenter.sendNotifications(z.TRACK,{eventKey:e,userId:t,attributes:i,eventTags:r,logEvent:l})}catch(e){this.logger.log(j.ERROR,e.message),this.errorHandler.handleError(e)}},e.prototype.getVariation=function(e,t,i){try{if(!this.isValidInstance())return this.logger.log(j.ERROR,G.INVALID_OBJECT,"OPTIMIZELY","getVariation"),null;try{if(!this.validateInputs({experiment_key:e,user_id:t},i))return null;var r,n=this.projectConfigManager.getConfig();if(!n)return null;var o=n.experimentKeyMap[e];if(!o)return this.logger.log(j.DEBUG,B.INVALID_EXPERIMENT_KEY,"OPTIMIZELY",e),null;var a=this.decisionService.getVariation(n,o,this.createInternalUserContext(t,i)).result,s=(r=o.id,n.experimentFeatureMap.hasOwnProperty(r)?q.FEATURE_TEST:q.AB_TEST);return this.notificationCenter.sendNotifications(z.DECISION,{type:s,userId:t,attributes:i||{},decisionInfo:{experimentKey:e,variationKey:a}}),a}catch(e){return this.logger.log(j.ERROR,e.message),this.errorHandler.handleError(e),null}}catch(e){return this.logger.log(j.ERROR,e.message),this.errorHandler.handleError(e),null}},e.prototype.setForcedVariation=function(e,t,i){if(!this.validateInputs({experiment_key:e,user_id:t}))return!1;var r=this.projectConfigManager.getConfig();if(!r)return!1;try{return this.decisionService.setForcedVariation(r,e,t,i)}catch(e){return this.logger.log(j.ERROR,e.message),this.errorHandler.handleError(e),!1}},e.prototype.getForcedVariation=function(e,t){if(!this.validateInputs({experiment_key:e,user_id:t}))return null;var i=this.projectConfigManager.getConfig();if(!i)return null;try{return this.decisionService.getForcedVariation(i,e,t).result}catch(e){return this.logger.log(j.ERROR,e.message),this.errorHandler.handleError(e),null}},e.prototype.validateInputs=function(e,t,i){try{if(e.hasOwnProperty("user_id")){var r=e.user_id;if("string"!=typeof r||null===r||"undefined"===r)throw Error(b(B.INVALID_INPUT_FORMAT,"OPTIMIZELY","user_id"));delete e.user_id}return Object.keys(e).forEach(function(t){if(!tB(e[t]))throw Error(b(B.INVALID_INPUT_FORMAT,"OPTIMIZELY",t))}),t&&function(e){if("object"!=typeof e||Array.isArray(e)||null===e)throw Error(b(B.INVALID_ATTRIBUTES,"ATTRIBUTES_VALIDATOR"));Object.keys(e).forEach(function(t){if(void 0===e[t])throw Error(b(B.UNDEFINED_ATTRIBUTE,"ATTRIBUTES_VALIDATOR",t))})}(t),i&&function(e){if("object"!=typeof e||Array.isArray(e)||null===e)throw Error(b(B.INVALID_EVENT_TAGS,"EVENT_TAGS_VALIDATOR"))}(i),!0}catch(e){return this.logger.log(j.ERROR,e.message),this.errorHandler.handleError(e),!1}},e.prototype.notActivatingExperiment=function(e,t){return this.logger.log(j.INFO,G.NOT_ACTIVATING_USER,"OPTIMIZELY",t,e),null},e.prototype.filterEmptyValues=function(e){for(var t in e)e.hasOwnProperty(t)&&(null===e[t]||void 0===e[t])&&delete e[t];return e},e.prototype.isFeatureEnabled=function(e,t,i){try{if(!this.isValidInstance())return this.logger.log(j.ERROR,G.INVALID_OBJECT,"OPTIMIZELY","isFeatureEnabled"),!1;if(!this.validateInputs({feature_key:e,user_id:t},i))return!1;var r=this.projectConfigManager.getConfig();if(!r)return!1;var n=eY(r,e,this.logger);if(!n)return!1;var o={},a=this.createInternalUserContext(t,i),s=this.decisionService.getVariationForFeature(r,n,a).result,l=s.decisionSource,u=tX(s),c=tW(s),d=tJ(s);l===H.FEATURE_TEST&&(o={experimentKey:u,variationKey:c}),(l===H.FEATURE_TEST||l===H.ROLLOUT&&eX(r))&&this.sendImpressionEvent(s,n.key,t,d,i),!0===d?this.logger.log(j.INFO,G.FEATURE_ENABLED_FOR_USER,"OPTIMIZELY",e,t):(this.logger.log(j.INFO,G.FEATURE_NOT_ENABLED_FOR_USER,"OPTIMIZELY",e,t),d=!1);var p={featureKey:e,featureEnabled:d,source:s.decisionSource,sourceInfo:o};return this.notificationCenter.sendNotifications(z.DECISION,{type:q.FEATURE,userId:t,attributes:i||{},decisionInfo:p}),d}catch(e){return this.logger.log(j.ERROR,e.message),this.errorHandler.handleError(e),!1}},e.prototype.getEnabledFeatures=function(e,t){var i=this;try{var r=[];if(!this.isValidInstance())return this.logger.log(j.ERROR,G.INVALID_OBJECT,"OPTIMIZELY","getEnabledFeatures"),r;if(!this.validateInputs({user_id:e}))return r;var n=this.projectConfigManager.getConfig();return n&&v(n.featureKeyMap).forEach(function(n){i.isFeatureEnabled(n.key,e,t)&&r.push(n.key)}),r}catch(e){return this.logger.log(j.ERROR,e.message),this.errorHandler.handleError(e),[]}},e.prototype.getFeatureVariable=function(e,t,i,r){try{return this.isValidInstance()?this.getFeatureVariableForType(e,t,null,i,r):(this.logger.log(j.ERROR,G.INVALID_OBJECT,"OPTIMIZELY","getFeatureVariable"),null)}catch(e){return this.logger.log(j.ERROR,e.message),this.errorHandler.handleError(e),null}},e.prototype.getFeatureVariableForType=function(e,t,i,r,n){if(!this.validateInputs({feature_key:e,variable_key:t,user_id:r},n))return null;var o,a,s=this.projectConfigManager.getConfig();if(!s)return null;var l=eY(s,e,this.logger);if(!l)return null;var u=(o=this.logger,(a=s.featureKeyMap[e])?a.variableKeyMap[t]||(o.log(j.ERROR,B.VARIABLE_KEY_NOT_IN_DATAFILE,ex,t,e),null):(o.log(j.ERROR,B.FEATURE_NOT_IN_DATAFILE,ex,e),null));if(!u)return null;if(i&&u.type!==i)return this.logger.log(j.WARNING,G.VARIABLE_REQUESTED_WITH_WRONG_TYPE,"OPTIMIZELY",i,u.type),null;var c=this.createInternalUserContext(r,n),d=this.decisionService.getVariationForFeature(s,l,c).result,p=tJ(d),f=this.getFeatureVariableValueFromVariation(e,p,d.variation,u,r),h={};return d.decisionSource===H.FEATURE_TEST&&null!==d.experiment&&null!==d.variation&&(h={experimentKey:d.experiment.key,variationKey:d.variation.key}),this.notificationCenter.sendNotifications(z.DECISION,{type:q.FEATURE_VARIABLE,userId:r,attributes:n||{},decisionInfo:{featureKey:e,featureEnabled:p,source:d.decisionSource,variableKey:t,variableValue:f,variableType:u.type,sourceInfo:h}}),f},e.prototype.getFeatureVariableValueFromVariation=function(e,t,i,r,n){var o=this.projectConfigManager.getConfig();if(!o)return null;var a=r.defaultValue;if(null!==i){var s=function(e,t,i,r){if(!t||!i)return null;if(!e.variationVariableUsageMap.hasOwnProperty(i.id))return r.log(j.ERROR,B.VARIATION_ID_NOT_IN_DATAFILE_NO_EXPERIMENT,ex,i.id),null;var n=e.variationVariableUsageMap[i.id][t.id];return n?n.value:null}(o,r,i,this.logger);null!==s?t?(a=s,this.logger.log(j.INFO,G.USER_RECEIVED_VARIABLE_VALUE,"OPTIMIZELY",a,r.key,e)):this.logger.log(j.INFO,G.FEATURE_NOT_ENABLED_RETURN_DEFAULT_VARIABLE_VALUE,"OPTIMIZELY",e,n,a):this.logger.log(j.INFO,G.VARIABLE_NOT_USED_RETURN_DEFAULT_VARIABLE_VALUE,"OPTIMIZELY",r.key,i.key)}else this.logger.log(j.INFO,G.USER_RECEIVED_DEFAULT_VARIABLE_VALUE,"OPTIMIZELY",n,r.key,e);return function(e,t,i){var r;switch(t){case $.BOOLEAN:"true"!==e&&"false"!==e?(i.log(j.ERROR,B.UNABLE_TO_CAST_VALUE,ex,e,t),r=null):r="true"===e;break;case $.INTEGER:isNaN(r=parseInt(e,10))&&(i.log(j.ERROR,B.UNABLE_TO_CAST_VALUE,ex,e,t),r=null);break;case $.DOUBLE:isNaN(r=parseFloat(e))&&(i.log(j.ERROR,B.UNABLE_TO_CAST_VALUE,ex,e,t),r=null);break;case $.JSON:try{r=JSON.parse(e)}catch(n){i.log(j.ERROR,B.UNABLE_TO_CAST_VALUE,ex,e,t),r=null}break;default:r=e}return r}(a,r.type,this.logger)},e.prototype.getFeatureVariableBoolean=function(e,t,i,r){try{return this.isValidInstance()?this.getFeatureVariableForType(e,t,$.BOOLEAN,i,r):(this.logger.log(j.ERROR,G.INVALID_OBJECT,"OPTIMIZELY","getFeatureVariableBoolean"),null)}catch(e){return this.logger.log(j.ERROR,e.message),this.errorHandler.handleError(e),null}},e.prototype.getFeatureVariableDouble=function(e,t,i,r){try{return this.isValidInstance()?this.getFeatureVariableForType(e,t,$.DOUBLE,i,r):(this.logger.log(j.ERROR,G.INVALID_OBJECT,"OPTIMIZELY","getFeatureVariableDouble"),null)}catch(e){return this.logger.log(j.ERROR,e.message),this.errorHandler.handleError(e),null}},e.prototype.getFeatureVariableInteger=function(e,t,i,r){try{return this.isValidInstance()?this.getFeatureVariableForType(e,t,$.INTEGER,i,r):(this.logger.log(j.ERROR,G.INVALID_OBJECT,"OPTIMIZELY","getFeatureVariableInteger"),null)}catch(e){return this.logger.log(j.ERROR,e.message),this.errorHandler.handleError(e),null}},e.prototype.getFeatureVariableString=function(e,t,i,r){try{return this.isValidInstance()?this.getFeatureVariableForType(e,t,$.STRING,i,r):(this.logger.log(j.ERROR,G.INVALID_OBJECT,"OPTIMIZELY","getFeatureVariableString"),null)}catch(e){return this.logger.log(j.ERROR,e.message),this.errorHandler.handleError(e),null}},e.prototype.getFeatureVariableJSON=function(e,t,i,r){try{return this.isValidInstance()?this.getFeatureVariableForType(e,t,$.JSON,i,r):(this.logger.log(j.ERROR,G.INVALID_OBJECT,"OPTIMIZELY","getFeatureVariableJSON"),null)}catch(e){return this.logger.log(j.ERROR,e.message),this.errorHandler.handleError(e),null}},e.prototype.getAllFeatureVariables=function(e,t,i){var r=this;try{if(!this.isValidInstance())return this.logger.log(j.ERROR,G.INVALID_OBJECT,"OPTIMIZELY","getAllFeatureVariables"),null;if(!this.validateInputs({feature_key:e,user_id:t},i))return null;var n=this.projectConfigManager.getConfig();if(!n)return null;var o=eY(n,e,this.logger);if(!o)return null;var a=this.createInternalUserContext(t,i),s=this.decisionService.getVariationForFeature(n,o,a).result,l=tJ(s),u={};o.variables.forEach(function(i){u[i.key]=r.getFeatureVariableValueFromVariation(e,l,s.variation,i,t)});var c={};return s.decisionSource===H.FEATURE_TEST&&null!==s.experiment&&null!==s.variation&&(c={experimentKey:s.experiment.key,variationKey:s.variation.key}),this.notificationCenter.sendNotifications(z.DECISION,{type:q.ALL_FEATURE_VARIABLES,userId:t,attributes:i||{},decisionInfo:{featureKey:e,featureEnabled:l,source:s.decisionSource,variableValues:u,sourceInfo:c}}),u}catch(e){return this.logger.log(j.ERROR,e.message),this.errorHandler.handleError(e),null}},e.prototype.getOptimizelyConfig=function(){try{return this.projectConfigManager.getConfig()?this.projectConfigManager.getOptimizelyConfig():null}catch(e){return this.logger.log(j.ERROR,e.message),this.errorHandler.handleError(e),null}},e.prototype.close=function(){var e,t=this;try{this.odpManager&&this.odpManager.stop(),this.notificationCenter.clearAllNotificationListeners();var i=null===(e=this.projectConfigManager.getConfig())||void 0===e?void 0:e.sdkKey;i&&eD.removeNotificationCenter(i);var r=this.eventProcessor.stop();return this.disposeOnUpdate&&(this.disposeOnUpdate(),this.disposeOnUpdate=null),this.projectConfigManager&&this.projectConfigManager.stop(),Object.keys(this.readyTimeouts).forEach(function(e){var i=t.readyTimeouts[e];clearTimeout(i.readyTimeout),i.onClose()}),this.readyTimeouts={},r.then(function(){return{success:!0}},function(e){return{success:!1,reason:String(e)}})}catch(e){return this.logger.log(j.ERROR,e.message),this.errorHandler.handleError(e),Promise.resolve({success:!1,reason:String(e)})}},e.prototype.onReady=function(e){var t,i,r=this;"object"==typeof e&&null!==e&&void 0!==e.timeout&&(t=e.timeout),O.isSafeInteger(t)||(t=3e4);var n=new Promise(function(e){i=e}),o=this.nextReadyTimeoutId;this.nextReadyTimeoutId++;var a=setTimeout(function(){delete r.readyTimeouts[o],i({success:!1,reason:b("onReady timeout expired after %s ms",t)})},t);return this.readyTimeouts[o]={readyTimeout:a,onClose:function(){i({success:!1,reason:"Instance closed"})}},this.readyPromise.then(function(){clearTimeout(a),delete r.readyTimeouts[o],i({success:!0})}),Promise.race([this.readyPromise,n])},e.prototype.createUserContext=function(e,t){var i,r=null!=e?e:null===(i=this.odpManager)||void 0===i?void 0:i.getVuid();return void 0!==r&&this.validateInputs({user_id:r},t)?new tc({optimizely:this,userId:r,attributes:t,shouldIdentifyUser:!0}):null},e.prototype.createInternalUserContext=function(e,t){return new tc({optimizely:this,userId:e,attributes:t,shouldIdentifyUser:!1})},e.prototype.decide=function(e,i,r){var n,o,a,s,l=this;void 0===r&&(r=[]);var u,c=e.getUserId(),d=e.getAttributes(),p=this.projectConfigManager.getConfig(),h=[];if(!this.isValidInstance()||!p)return this.logger.log(j.INFO,G.INVALID_OBJECT,"OPTIMIZELY","decide"),tu(i,e,[X.SDK_NOT_READY]);var g=p.featureKeyMap[i];if(!g)return this.logger.log(j.ERROR,B.FEATURE_NOT_IN_DATAFILE,"OPTIMIZELY",i),tu(i,e,[b(X.FLAG_KEY_INVALID,i)]);var m=this.getAllDecideOptions(r),E=this.decisionService.findValidatedForcedDecision(p,e,i);h.push.apply(h,E.reasons);var _=E.result;if(_)u={experiment:null,variation:_,decisionSource:H.FEATURE_TEST};else{var v=this.decisionService.getVariationForFeature(p,g,e,m);h.push.apply(h,v.reasons),u=v.result}var y=u.decisionSource,I=null!==(o=null===(n=u.experiment)||void 0===n?void 0:n.key)&&void 0!==o?o:null,O=null!==(s=null===(a=u.variation)||void 0===a?void 0:a.key)&&void 0!==s?s:null,R=tJ(u);!0===R?this.logger.log(j.INFO,G.FEATURE_ENABLED_FOR_USER,"OPTIMIZELY",i,c):this.logger.log(j.INFO,G.FEATURE_NOT_ENABLED_FOR_USER,"OPTIMIZELY",i,c);var N={},T=!1;m[t.OptimizelyDecideOption.EXCLUDE_VARIABLES]||g.variables.forEach(function(e){N[e.key]=l.getFeatureVariableValueFromVariation(i,R,u.variation,e,c)}),!m[t.OptimizelyDecideOption.DISABLE_DECISION_EVENT]&&(y===H.FEATURE_TEST||y===H.ROLLOUT&&eX(p))&&(this.sendImpressionEvent(u,i,c,R,d),T=!0);var A=[];m[t.OptimizelyDecideOption.INCLUDE_REASONS]&&(A=h.map(function(e){return b.apply(void 0,f([e[0]],e.slice(1),!1))}));var D={flagKey:i,enabled:R,variationKey:O,ruleKey:I,variables:N,reasons:A,decisionEventDispatched:T};return this.notificationCenter.sendNotifications(z.DECISION,{type:q.FLAG,userId:c,attributes:d,decisionInfo:D}),{variationKey:O,enabled:R,variables:N,ruleKey:I,flagKey:i,userContext:e,reasons:A}},e.prototype.getAllDecideOptions=function(e){var i=this,r=c({},this.defaultDecideOptions);return Array.isArray(e)?e.forEach(function(e){t.OptimizelyDecideOption[e]?r[e]=!0:i.logger.log(j.WARNING,G.UNRECOGNIZED_DECIDE_OPTION,"OPTIMIZELY",e)}):this.logger.log(j.DEBUG,G.INVALID_DECIDE_OPTIONS,"OPTIMIZELY"),r},e.prototype.decideForKeys=function(e,i,r){var n=this;void 0===r&&(r=[]);var o={};if(!this.isValidInstance())return this.logger.log(j.ERROR,G.INVALID_OBJECT,"OPTIMIZELY","decideForKeys"),o;if(0===i.length)return o;var a=this.getAllDecideOptions(r);return i.forEach(function(i){var s=n.decide(e,i,r);a[t.OptimizelyDecideOption.ENABLED_FLAGS_ONLY]&&!s.enabled||(o[i]=s)}),o},e.prototype.decideAll=function(e,t){void 0===t&&(t=[]);var i=this.projectConfigManager.getConfig();if(!this.isValidInstance()||!i)return this.logger.log(j.ERROR,G.INVALID_OBJECT,"OPTIMIZELY","decideAll"),{};var r=Object.keys(i.featureKeyMap);return this.decideForKeys(e,r,t)},e.prototype.updateOdpSettings=function(){var e=this.projectConfigManager.getConfig();e&&this.odpManager&&this.odpManager.updateSettings(e.odpIntegrationConfig)},e.prototype.sendOdpEvent=function(e,t,i,r){if(this.odpManager){var n=new Map(i);if(i&&i.size>0)try{i.forEach(function(e,t){"fs-user-id"!==t.toLowerCase()&&eg.FS_USER_ID!==t.toLowerCase()||(n.delete(t),n.set(eg.FS_USER_ID,e))})}catch(e){this.logger.warn(G.ODP_SEND_EVENT_IDENTIFIER_CONVERSION_FAILED)}try{var o=new e6(null!=t?t:"fullstack",e,n,r);this.odpManager.sendEvent(o)}catch(e){this.logger.error(B.ODP_EVENT_FAILED,e)}}else this.logger.error(B.ODP_EVENT_FAILED_ODP_MANAGER_MISSING)},e.prototype.isOdpIntegrated=function(){var e,t,i;return null!==(i=null===(t=null===(e=this.projectConfigManager.getConfig())||void 0===e?void 0:e.odpIntegrationConfig)||void 0===t?void 0:t.integrated)&&void 0!==i&&i},e.prototype.identifyUser=function(e){this.odpManager&&this.isOdpIntegrated()&&this.odpManager.identifyUser(e)},e.prototype.fetchQualifiedSegments=function(e,t){return d(this,void 0,void 0,function(){return p(this,function(i){switch(i.label){case 0:return this.odpManager?[4,this.odpManager.fetchQualifiedSegments(e,t)]:[2,null];case 1:return[2,i.sent()]}})})},e.prototype.getVuid=function(){var e;if(this.odpManager){if(this.odpManager.isVuidEnabled())return this.odpManager.getVuid();this.logger.log(j.WARNING,"getVuid() unavailable for this platform","OPTIMIZELY")}else null===(e=this.logger)||void 0===e||e.error("Unable to get VUID - ODP Manager is not instantiated yet.")},e}(),t4={parseUserAgentInfo:function(){var e=(new s.UAParser).getResult();return{os:e.os,device:e.device}}};function t6(){return t4}var t8=Object.freeze({__proto__:null,get LogLevel(){return t.LogLevel},getLogger:U,setLogHandler:C,LOG_LEVEL:j,createLogger:eh}),t7=U();x.setLogHandler(eh()),x.setLogLevel(t.LogLevel.INFO);var t9=!1,ie=function(e){var i;try{var r,n,o,a=!1;e.errorHandler&&(h=e.errorHandler),e.logger&&(x.setLogHandler(e.logger),x.setLogLevel(t.LogLevel.NOTSET)),void 0!==e.logLevel&&x.setLogLevel(e.logLevel);try{el(e),a=!0}catch(e){t7.error(e)}var s=void 0;null==e.eventDispatcher?(s=new ei({eventDispatcher:ed}),t9||(s.sendPendingEvents(),t9=!0)):s=e.eventDispatcher;var l=e.closingEventDispatcher;!e.eventDispatcher&&!l&&window.navigator&&"sendBeacon"in window.navigator&&(l=ep);var u=e.eventBatchSize,d=e.eventFlushInterval;r=e.eventBatchSize,!("number"!=typeof r||!O.isSafeInteger(r))&&r>=1||(t7.warn("Invalid eventBatchSize %s, defaulting to %s",e.eventBatchSize,10),u=10),n=e.eventFlushInterval,!("number"!=typeof n||!O.isSafeInteger(n))&&n>0||(t7.warn("Invalid eventFlushInterval %s, defaulting to %s",e.eventFlushInterval,1e3),d=1e3);var p=h,f=(o={logger:t7,errorHandler:p},new eb(o)),g={dispatcher:s,closingDispatcher:l,flushInterval:d,batchSize:u,maxQueueSize:e.eventMaxQueueSize||1e4,notificationCenter:f},m=!0===(null===(i=e.odpOptions)||void 0===i?void 0:i.disabled);m&&t7.info(G.ODP_DISABLED);var E=e.clientEngine,_=e.clientVersion,v=c(c({clientEngine:"javascript-sdk"},e),{eventProcessor:eI.createEventProcessor(g),logger:t7,errorHandler:p,datafileManager:e.sdkKey?function(e,t,i,r){var n={sdkKey:e};if((void 0===r||"object"==typeof r&&null!==r)&&O.assign(n,r),i){var o=eZ({datafile:i,jsonSchemaValidator:void 0,logger:t}),a=o.configObj,s=o.error;s&&t.error(s),a&&(n.datafile=e$(a))}return new eU(n)}(e.sdkKey,t7,e.datafile,e.datafileOptions):void 0,notificationCenter:f,isValidInstance:a,odpManager:m?void 0:tl.createInstance({logger:t7,odpOptions:e.odpOptions,clientEngine:E,clientVersion:_})}),y=new t5(v);try{if("function"==typeof window.addEventListener){var b="onpagehide"in window?"pagehide":"unload";window.addEventListener(b,function(){y.close()},!1)}}catch(e){t7.error(G.UNABLE_TO_ATTACH_UNLOAD,"INDEX_BROWSER",e.message)}return y}catch(e){return t7.error(e),null}},it=function(){t9=!1},ii=x.setLogHandler,ir=x.setLogLevel,io=c(c({},t8),{logging:ey,errorHandler:ec,eventDispatcher:ed,sendBeaconEventDispatcher:ep,enums:W,setLogger:ii,setLogLevel:ir,createInstance:ie,__internalResetRetryState:it,OptimizelyDecideOption:t.OptimizelyDecideOption,getUserAgentParser:t6});t.LOG_LEVEL=j,t.__internalResetRetryState=it,t.createInstance=ie,t.createLogger=eh,t.default=io,t.enums=W,t.errorHandler=ec,t.eventDispatcher=ed,t.getLogger=U,t.getUserAgentParser=t6,t.logging=ey,t.sendBeaconEventDispatcher=ep,t.setLogHandler=C,t.setLogLevel=ir,t.setLogger=ii},20813:(e,t,i)=>{"use strict";var r,n,o=i(96540),a=i(29624);function s(e){var t=Object.create(null);return e&&Object.keys(e).forEach(function(i){if("default"!==i){var r=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(t,i,r.get?r:{enumerable:!0,get:function(){return e[i]}})}}),t.default=e,Object.freeze(t)}i(81765);var l=s(o),u=s(a),c=o.createContext({optimizely:null,isServerSide:!1,timeout:0}),d=(c.Consumer,c.Provider),p=function(e,t){return(p=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},f=function(){return(f=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function h(e,t,i,r){return new(i||(i=Promise))(function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((r=r.apply(e,t||[])).next())})}function g(e,t){var i,r,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(l){return function(s){if(i)throw TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(i=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){a.label=s[1];break}if(6===s[0]&&a.label<n[1]){a.label=n[1],n=s;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(s);break}n[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{i=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}function m(e,t,i){if(i||2==arguments.length)for(var r,n=0,o=t.length;n<o;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))}function E(e,t){if(e.id!==t.id)return!1;var i=e.attributes||{},r=t.attributes||{},n=Object.keys(i),o=Object.keys(r);if(n.length!==o.length)return!1;for(var a=0;a<n.length;a++){var s=n[a];if(i[s]!==r[s])return!1}return!0}function _(e){return"object"==typeof e&&null!==e?e:{}}function v(e,t){var i=_(e),r=_(t),n=Object.keys(i),o=Object.keys(r);return n.length===o.length&&n.every(function(e){return e in r&&i[e]===r[e]})}function y(e,t,i){return{enabled:!1,flagKey:e,ruleKey:null,variationKey:null,variables:{},reasons:[t],userContext:{id:i.id,attributes:i.attributes}}}function b(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var r=0;return e.replace(/%s/g,function(){var e=t[r++],i=typeof e;return"function"===i?e():"string"===i?e:String(e)})}"function"==typeof SuppressedError&&SuppressedError;var I=(function(){function e(){this.observers=[]}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.subscribe=function(e,t){var i=this,r="key-".concat(Math.floor(1e5+999999*Math.random()));return this.observers.push({subscriptionId:r,key:e,callback:t}),function(){var e=i.observers.findIndex(function(e){return e.subscriptionId===r});e>=0&&i.observers.splice(e,1)}},e.prototype.notify=function(e){this.observers.filter(function(t){return t.key===e}).forEach(function(e){return e.callback()})},e})().getInstance(),O=u.getLogger("ReactSDK"),R={warn:function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return O.log(u.enums.LOG_LEVEL.WARNING,b.apply(void 0,m([e],t,!1)))},info:function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return O.log(u.enums.LOG_LEVEL.INFO,b.apply(void 0,m([e],t,!1)))},error:function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return O.log(u.enums.LOG_LEVEL.ERROR,b.apply(void 0,m([e],t,!1)))}};!function(e){e.TIMEOUT="TIMEOUT",e.NO_CLIENT="NO_CLIENT",e.USER_NOT_READY="USER_NOT_READY"}(r||(r={}));var N={id:null,attributes:{}},T=function(){function e(e){var t=this;this.userContext=null,this.onUserUpdateHandlers=[],this.isUserPromiseResolved=!1,this.isUserReady=!1,this.onForcedVariationsUpdateHandlers=[],this.forcedDecisionFlagKeys=new Set,this.isClientReady=!1,this.clientAndUserReadyPromiseFulfilled=!1,this.isUsingSdkKey=!1,this.user=f({},N),this.initialConfig=e;var i=f(f({},e),{clientEngine:"react-sdk",clientVersion:"3.2.3"});this.userPromiseResolver=function(){};var n=new Promise(function(e){t.userPromiseResolver=e});if(this._client=u.createInstance(i),this.isClientReady=!!this.getOptimizelyConfig(),this.isUsingSdkKey=!!i.sdkKey,this._client){var o=this._client.onReady();this.clientAndUserReadyPromise=Promise.all([n,o]).then(function(e){var i=e[0],r=e[1];t.isClientReady=r.success,t.isUserReady=i.success;var n=t.isReady();return t.clientAndUserReadyPromiseFulfilled=!0,{success:n,message:n?"Client and user are both ready.":"Client or user did not become ready."}})}else R.warn("Unable to resolve datafile and user information because Optimizely client failed to initialize."),this.clientAndUserReadyPromise=new Promise(function(e){e({success:!1,reason:r.NO_CLIENT,message:"Optimizely client failed to initialize."})})}return e.prototype.getUserWithOverrides=function(e,t){return{id:void 0===e?this.user.id:e,attributes:void 0===t?this.user.attributes:t}},e.prototype.getIsReadyPromiseFulfilled=function(){return this.clientAndUserReadyPromiseFulfilled},e.prototype.getIsUsingSdkKey=function(){return this.isUsingSdkKey},Object.defineProperty(e.prototype,"odpExplicitlyOff",{get:function(){var e;return null===(e=this.initialConfig.odpOptions)||void 0===e?void 0:e.disabled},enumerable:!1,configurable:!0}),e.prototype.onReady=function(e){var t,i=this;void 0===e&&(e={});var n=5e3;e&&void 0!==e.timeout&&(n=e.timeout);var o=new Promise(function(e){t=setTimeout(function(){e({success:!1,reason:r.TIMEOUT,message:"Failed to initialize before timeout",dataReadyPromise:i.clientAndUserReadyPromise})},n)});return Promise.race([this.clientAndUserReadyPromise,o]).then(function(e){return h(i,void 0,void 0,function(){return g(this,function(i){return clearTimeout(t),[2,e]})})})},e.prototype.getUserContext=function(){return this._client?this.userContext?this.userContext:(R.warn("Unable to get user context. User context not set."),null):(R.warn("Unable to get user context. Optimizely client not initialized."),null)},e.prototype.setCurrentUserContext=function(e){if(!this._client){R.warn("Unable to set user context for user ID ".concat(e.id,". Optimizely client not initialized."));return}if(!this.userContext){this.userContext=this._client.createUserContext(e.id||void 0,e.attributes);return}E(e,{id:this.userContext.getUserId(),attributes:this.userContext.getAttributes()})||(this.userContext=this._client.createUserContext(e.id||void 0,e.attributes))},e.prototype.makeUserContextInstance=function(e){return this._client?this.userContext&&E(e,this.user)?this.userContext:this._client.createUserContext(e.id||void 0,e.attributes):(R.warn("Unable to create user context for ".concat(e.id,". Optimizely client failed to initialize or not ready.")),null)},e.prototype.fetchQualifiedSegments=function(e){return h(this,void 0,void 0,function(){var t;return g(this,function(i){switch(i.label){case 0:if(!this.userContext)return[2,!1];if(this.odpExplicitlyOff||!(null===(t=this._client)||void 0===t?void 0:t.isOdpIntegrated()))return[2,!0];return[4,this.userContext.fetchQualifiedSegments(e)];case 1:return[2,i.sent()]}})})},e.prototype.setUser=function(e){return h(this,void 0,void 0,function(){var t,i,r,n,o=this;return g(this,function(a){switch(a.label){case 0:if(this.user={id:e.id||N.id,attributes:e.attributes||N.attributes},e.id!==N.id)return[3,2];return[4,null===(i=this._client)||void 0===i?void 0:i.onReady()];case 1:return a.sent(),this.setCurrentUserContext(e),this.user.id=(null===(r=this.userContext)||void 0===r?void 0:r.getUserId())||N.id,[3,4];case 2:return this.setCurrentUserContext(e),[4,null===(n=this._client)||void 0===n?void 0:n.onReady()];case 3:a.sent(),a.label=4;case 4:return[4,this.fetchQualifiedSegments()];case 5:return t=a.sent(),this.isUserPromiseResolved||(this.userPromiseResolver({success:t}),this.isUserPromiseResolved=!0),this.onUserUpdateHandlers.forEach(function(e){return e(o.user)}),[2]}})})},e.prototype.onUserUpdate=function(e){var t=this;return this.onUserUpdateHandlers.push(e),function(){var i=t.onUserUpdateHandlers.indexOf(e);i>-1&&t.onUserUpdateHandlers.splice(i,1)}},e.prototype.onForcedVariationsUpdate=function(e){var t=this;return this.onForcedVariationsUpdateHandlers.push(e),function(){var i=t.onForcedVariationsUpdateHandlers.indexOf(e);i>-1&&t.onForcedVariationsUpdateHandlers.splice(i,1)}},e.prototype.isReady=function(){return this.isClientReady&&this.isUserReady},e.prototype.activate=function(e,t,i){if(!this._client)return R.warn('Unable to activate experiment "%s" because Optimizely client failed to initialize.',e),null;var r=this.getUserWithOverrides(t,i);return null===r.id?(R.info('Unable to activate experiment "%s" because User ID is not set',e),null):this._client.activate(e,r.id,r.attributes)},e.prototype.decide=function(e,t,i,r){if(void 0===t&&(t=[]),!this._client)return R.warn('Unable to evaluate feature "%s" because Optimizely client failed to initialize.',e),y(e,"Unable to evaluate flag ".concat(e," because Optimizely client failed to initialize."),this.user);var n=this.getUserWithOverrides(i,r);if(null===n.id)return R.info('Unable to evaluate feature "%s" because User ID is not set.',e),y(e,"Unable to evaluate flag ".concat(e," because User ID is not set."),n);var o=this.makeUserContextInstance(n);return o?f(f({},o.decide(e,t)),{userContext:{id:n.id,attributes:n.attributes}}):y(e,"Not Evaluating flag ".concat(e," because user id or attributes are not valid"),n)},e.prototype.decideForKeys=function(e,t,i,r){if(void 0===t&&(t=[]),!this._client)return R.warn("Unable to evaluate features for keys because Optimizely client failed to initialize."),{};var n=this.getUserWithOverrides(i,r);if(null===n.id)return R.info("Unable to evaluate features for keys because User ID is not set"),{};var o=this.makeUserContextInstance(n);return o?Object.entries(o.decideForKeys(e,t)).reduce(function(e,t){var i=t[0],r=t[1];return e[i]=f(f({},r),{userContext:{id:n.id||"",attributes:n.attributes}}),e},{}):{}},e.prototype.decideAll=function(e,t,i){if(void 0===e&&(e=[]),!this._client)return R.warn("Unable to evaluate all feature decisions because Optimizely client is not initialized."),{};var r=this.getUserWithOverrides(t,i);if(null===r.id)return R.info("Unable to evaluate all feature decisions because User ID is not set"),{};var n=this.makeUserContextInstance(r);return n?Object.entries(n.decideAll(e)).reduce(function(e,t){var i=t[0],n=t[1];return e[i]=f(f({},n),{userContext:{id:r.id||"",attributes:r.attributes}}),e},{}):{}},e.prototype.getVariation=function(e,t,i){if(!this._client)return R.warn('Unable to get variation for experiment "%s" because Optimizely client failed to initialize.',e),null;var r=this.getUserWithOverrides(t,i);return null===r.id?(R.info('Unable to get variation for experiment "%s" because User ID is not set',e),null):this._client.getVariation(e,r.id,r.attributes)},e.prototype.track=function(e,t,i,r){if(!this._client){R.warn('Unable to send tracking event "%s" because Optimizely client failed to initialize.',e);return}void 0!==t&&"string"!=typeof t&&(r=t,t=void 0);var n=this.getUserWithOverrides(t,i);if(null===n.id){R.info('Unable to send tracking event "%s" because User ID is not set',e);return}this._client.track(e,n.id,n.attributes,r)},e.prototype.setForcedDecision=function(e,t){if(!this.userContext){R.warn("Unable to set a forced decision because the user context has not been set yet.");return}this.userContext.setForcedDecision(e,t)&&(this.forcedDecisionFlagKeys.add(e.flagKey),I.notify(e.flagKey))},e.prototype.getForcedDecision=function(e){return this.userContext?this.userContext.getForcedDecision(e):(R.warn("Unable to get a forced decision because the user context has not been set yet."),null)},e.prototype.removeForcedDecision=function(e){if(!this.userContext)return R.warn("Unable to remove forced decisions because the user context has not been set yet."),!1;var t=this.userContext.removeForcedDecision(e);return t&&(this.forcedDecisionFlagKeys.delete(e.flagKey),I.notify(e.flagKey)),t},e.prototype.removeAllForcedDecisions=function(){if(!this.userContext)return R.warn("Unable to remove all forced decisions because the user context has not been set yet."),!1;var e=this.userContext.removeAllForcedDecisions();return e&&(this.forcedDecisionFlagKeys.forEach(function(e){return I.notify(e)}),this.forcedDecisionFlagKeys.clear()),e},e.prototype.isFeatureEnabled=function(e,t,i){if(!this._client)return R.warn('Unable to determine if feature "%s" is enabled because Optimizely client failed to initialize.',e),!1;var r=this.getUserWithOverrides(t,i);return null===r.id?(R.info('Unable to determine if feature "%s" is enabled because User ID is not set',e),!1):this._client.isFeatureEnabled(e,r.id,r.attributes)},e.prototype.getFeatureVariables=function(e,t,i){var r=this;if(!this._client)return R.warn('Unable to get feature variables for feature "%s" because Optimizely client failed to initialize.',e),{};var n=this.getUserWithOverrides(t,i),o=n.id;if(null===o)return R.warn('Unable to get feature variables for feature "%s" because User ID is not set',e),{};var a=n.attributes,s={},l=this._client.getOptimizelyConfig();if(!l)return R.warn('Unable to retrieve feature variables for feature "%s" because Optimizely client failed to initialize.',e),{};var u=l.featuresMap[e];return u?(Object.keys(u.variablesMap).forEach(function(t){var i=u.variablesMap[t];s[i.key]=r._client.getFeatureVariable(e,i.key,o,a)}),s):(R.info('Unable to retrieve feature variables for feature "%s" because config features map is not set',e),{})},e.prototype.getFeatureVariableString=function(e,t,i,r){if(!this._client)return R.warn('Unable to get feature variable string from feature "%s" because Optimizely client failed to initialize.',e),null;var n=this.getUserWithOverrides(i,r);return null===n.id?(R.info('Unable to get feature variable string from feature "%s" because User ID is not set',e),null):this._client.getFeatureVariableString(e,t,n.id,n.attributes)},e.prototype.getFeatureVariableBoolean=function(e,t,i,r){if(!this._client)return R.warn('Unable to get feature variable boolean from feature "%s" because Optimizely client failed to initialize.',e),null;var n=this.getUserWithOverrides(i,r);return null===n.id?(R.info('Unable to get feature variable boolean from feature "%s" because User ID is not set',e),null):this._client.getFeatureVariableBoolean(e,t,n.id,n.attributes)},e.prototype.getFeatureVariableInteger=function(e,t,i,r){if(!this._client)return R.warn('Unable to get feature variable integer from feature "%s" because Optimizely client failed to initialize.',e),null;var n=this.getUserWithOverrides(i,r);return null===n.id?(R.info('Unable to get feature variable integer from feature "%s" because User ID is not set',e),null):this._client.getFeatureVariableInteger(e,t,n.id,n.attributes)},e.prototype.getFeatureVariableDouble=function(e,t,i,r){if(!this._client)return R.warn('Unable to get feature variable double from feature "%s" because Optimizely client failed to initialize.',e),null;var n=this.getUserWithOverrides(i,r);return null===n.id?(R.info('Unable to get feature variable double from feature "%s" because User ID is not set',e),null):this._client.getFeatureVariableDouble(e,t,n.id,n.attributes)},e.prototype.getFeatureVariableJSON=function(e,t,i,r){if(!this._client)return R.warn('Unable to get feature variable JSON from feature "%s" because Optimizely client failed to initialize.',e),null;var n=this.getUserWithOverrides(i,r);return null===n.id?(R.info('Unable to get feature variable JSON from feature "%s" because User ID is not set',e),null):this._client.getFeatureVariableJSON(e,t,n.id,n.attributes)},e.prototype.getFeatureVariable=function(e,t,i,r){if(!this._client)return R.warn('Unable to get feature variable from feature "%s" because Optimizely client failed to initialize.',e,t),null;var n=this.getUserWithOverrides(i,r);return null===n.id?(R.info('Unable to get feature variable from feature "%s" because User ID is not set',e,t),null):this._client.getFeatureVariable(e,t,n.id,n.attributes)},e.prototype.getAllFeatureVariables=function(e,t,i){if(!this._client)return R.warn('Unable to get all feature variables from feature "%s" because Optimizely client failed to initialize.',e),{};var r=this.getUserWithOverrides(t,i);return null===r.id?(R.info('Unable to get all feature variables from feature "%s" because User ID is not set',e),{}):this._client.getAllFeatureVariables(e,r.id,r.attributes)},e.prototype.getEnabledFeatures=function(e,t){if(!this._client)return R.warn("Unable to get list of enabled features because Optimizely client failed to initialize."),[];var i=this.getUserWithOverrides(e,t);return null===i.id?(R.info("Unable to get list of enabled features because User ID is not set"),[]):this._client.getEnabledFeatures(i.id,i.attributes)},e.prototype.getForcedVariation=function(e,t){if(!this._client)return R.warn('Unable to get forced variation for experiment "%s" because Optimizely client failed to initialize.',e),null;var i=this.getUserWithOverrides(t);return null===i.id?(R.info('Unable to get forced variation for experiment "%s" because User ID is not set',e),null):this._client.getForcedVariation(e,i.id)},e.prototype.setForcedVariation=function(e,t,i){if(!this._client)return R.warn('Unable to set forced variation for experiment "%s" because Optimizely client failed to initialize.',e),!1;var r=null,n=null;if(2==arguments.length)n=t,r=this.getUserWithOverrides().id;else if(3==arguments.length){if(r=this.getUserWithOverrides(t).id,void 0===i)return!1;n=i}if(null===r)return R.warn('Unable to set forced variation for experiment "%s" because User ID is not set',e),!1;var o=this._client.setForcedVariation(e,r,n);return this.onForcedVariationsUpdateHandlers.forEach(function(e){return e()}),o},e.prototype.getOptimizelyConfig=function(){return this._client?this._client.getOptimizelyConfig():(R.warn("Unable to get Optimizely configuration because Optimizely client failed to initialize."),null)},e.prototype.close=function(){return this._client?this._client.close():new Promise(function(e,t){return e({success:!0,reason:"Optimizely client is not initialized."})})},Object.defineProperty(e.prototype,"client",{get:function(){return this._client?this._client:(R.warn("Unable to get client because Optimizely client failed to initialize."),null)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"notificationCenter",{get:function(){return this._client?this._client.notificationCenter:{addNotificationListener:function(){return R.warn("Unable to add notification listener because Optimizely client failed to initialize."),0},removeNotificationListener:function(){return R.warn("Unable to remove notification listener because Optimizely client failed to initialize."),!1},clearAllNotificationListeners:function(){R.warn("Unable to clear all notification listeners because Optimizely client failed to initialize.")},clearNotificationListeners:function(){R.warn("Unable to clear notification listeners because Optimizely client failed to initialize.")}}},enumerable:!1,configurable:!0}),e.prototype.sendOdpEvent=function(e,t,i,r){var n;if(!e||!e.trim()){R.error("ODP action is not valid (cannot be empty).");return}null===(n=this.client)||void 0===n||n.sendOdpEvent(e,t,i,r)},e.prototype.getVuid=function(){if(!this._client){R.warn("Unable to get VUID because Optimizely client failed to initialize.");return}return this._client.getVuid()},e}(),A=a.getLogger("<OptimizelyProvider>"),D=(function(e){function t(t){var i=e.call(this,t)||this;return i.setUserInOptimizely(),i}(function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}p(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)})(t,e),t.prototype.setUserInOptimizely=function(){return h(this,void 0,void 0,function(){var e,t,i,r,n,o,a,s,l;return g(this,function(u){switch(u.label){case 0:if(t=(e=this.props).optimizely,i=e.userId,r=e.userAttributes,n=e.user,!t)return A.error("OptimizelyProvider must be passed an instance of the Optimizely SDK client"),[2];if(o=null,n?"then"in n?n.then(function(e){t.setUser(e)}):o={id:n.id,attributes:n.attributes||{}}:i?(o={id:i,attributes:r||{}},A.warn("Passing userId and userAttributes as props is deprecated, please switch to using `user` prop")):t.user?(s=(a=t.user).id,l=a.attributes,o={id:s,attributes:r||l||{}}):o={id:N.id,attributes:r||N.attributes},!o)return[3,4];u.label=1;case 1:return u.trys.push([1,3,,4]),[4,t.setUser(o)];case 2:return u.sent(),[3,4];case 3:return u.sent(),A.error("Error while trying to set user."),[3,4];case 4:return[2]}})})},t.prototype.componentDidUpdate=function(e){if(!e.isServerSide){var t=this.props.optimizely;this.props.user&&"id"in this.props.user&&(t.user.id&&E({id:t.user.id,attributes:t.user.attributes||{}},{id:this.props.user.id,attributes:this.props.user.attributes||{}})||t.setUser(this.props.user))}},t.prototype.render=function(){var e=this.props,t=e.optimizely,i=e.children,r=e.timeout,n=!!this.props.isServerSide;return l.createElement(d,{value:{optimizely:t,isServerSide:n,timeout:r}},i)}}(l.Component),a.getLogger("ReactSDK"));(function(e){e.EXPERIMENT="Experiment",e.FEATURE="Feature"})(n||(n={})),u.getLogger("ReactSDK"),t.wP=c,t.Q_=function(e){return new T(e)}},37337:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(96540);class n extends r.Component{state={hasError:!1};static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,t){console.error("Error while rendering Subito component",e,t)}render(){return this.state.hasError?this.props.fallback??null:this.props.children}}},62609:(e,t,i)=>{"use strict";i.d(t,{A:()=>y});var r=i(91375),n=i(96540),o=i(46942),a=i.n(o);let s="https://assistenza.subito.it",l="https://info.subito.it",u=[{href:`${s}/hc/it/`,label:"Assistenza"},{href:`${s}/hc/it/sections/10743588495133-Regole-di-pubblicazione`,label:"Regole"},{href:`${s}/hc/it/categories/10743145756317-Sicurezza`,label:"Sicurezza"},{href:`${l}/policies/condizioni-generali.htm`,label:"Condizioni"},{href:`${l}/policies/privacy.htm`,label:"Privacy"},{label:"Gestisci cookies",onClick:()=>{Didomi.preferences.show("purposes")}},{href:`${l}/affariadistanza/#vendi`,label:"TuttoSubito Vendi"},{href:`${l}/affariadistanza/#compra`,label:"TuttoSubito Compra"},{href:`${l}/policies/tutto-subito.htm`,label:"Servizio TuttoSubito"},{href:`${l}/policies/tutto-subito-per-professionisti.htm`,label:"Servizio TuttoSubito per Professionisti"},{href:"https://www.subito.it/vendere/",label:"Inserisci annuncio"},{href:`${l}/policies/condizioni-promuovi.htm`,label:"Promuovi annuncio"},{href:`${l}/per-i-privati.htm`,label:"Consigli per la vendita"},{href:"https://impresapiu.subito.it//shops?xtfrom=footer_menu",label:"Negozi e Aziende"},{href:"https://aziende.subito.it/",label:"Subito per le aziende"}],c=[{href:`${l}/about.htm`,label:"Chi siamo"},{href:`${l}/lavora-con-noi.htm`,label:"Lavora con noi"},{href:"https://www.subito.it/magazine/green/",label:"Sostenibilit\xe0",target:"_blank"},{href:"https://www.subito.it/magazine/",label:"Magazine",target:"_blank"},{href:"https://info.subito.it/in-campo-con-le-tue-passioni-sportive.htm",label:"Vivi lo Sport con Subito",target:"_blank"},{href:"https://info.subito.it/idearegalo.htm",label:"Idee regalo"},{href:"https://www.infojobs.it",label:"InfoJobs",target:"_blank"},{href:"https://www.subito.it/sitemaps/",label:"Mappa del sito"}],d=[{icon:"social/facebook",href:"https://it-it.facebook.com/subitoit",label:"Facebook",target:"_blank"},{icon:"social/tiktok",href:"https://www.tiktok.com/@subito_it",label:"TikTok",target:"_blank"},{icon:"social/instagram",href:"https://www.instagram.com/subito_it/",label:"Instagram",target:"_blank"},{icon:"social/youtube",href:"https://www.youtube.it/user/subitoit",label:"YouTube",target:"_blank"}],p=[{icon:"app-stores/android",href:"https://play.google.com/store/apps/details?id=it.subito&referrer=utm_source%3Dsite%26utm_medium%3Dfooter",label:"Subito per Android",target:"_blank"},{icon:"app-stores/apple",href:"https://itunes.apple.com/it/app/subito.it/id450775137?mt=8",label:"Subito per iOS",target:"_blank"}];var f={items__column:"Items-module_items__column__9Kbm0",items__column__title:"Items-module_items__column__title__LvV8X","list-link":"Items-module_list-link__dTOg5","list-link-wrapper":"Items-module_list-link-wrapper__ZJyvN","footer-icon":"Items-module_footer-icon__YjICl","footer-button":"Items-module_footer-button__92T2R"};let h=(0,n.createContext)({});function g(e){let t=n.useContext(h),{children:i,...r}=e;return n.createElement("a",{...r,href:r.href,onClick:e=>{r.onClick?.(e),t.onClick?.(r.href)}},i)}let m=e=>n.createElement("div",{className:f.items__column},n.createElement(r.a,{classes:[f.items__column__title],size:"small",weight:"semibold"},e.title),n.createElement("ul",null,e.items.map(t=>n.createElement("li",{key:t.label,className:f["list-link-wrapper"]},t.icon?n.createElement("img",{src:`${e.assetsBase}/static/icons/${t.icon}.svg`,width:"16",height:"16",alt:"",className:f["footer-icon"],crossOrigin:"anonymous",loading:"lazy"}):null,"href"in t?n.createElement(g,{href:t.href,target:t.target,className:f["list-link"]},n.createElement(r.a,{size:"small",element:"span"},t.label)):n.createElement("button",{onClick:t.onClick,className:a()(f["list-link"],f["footer-button"])},t.label)))));var E={"bottom-links":"FooterLinks-module_bottom-links__0Rhpu"};let _=e=>"full"===e.show?n.createElement("div",{className:E["bottom-links"]},n.createElement(m,{title:"Subito",items:u,assetsBase:e.assetsBase}),n.createElement(m,{title:"",items:c,assetsBase:e.assetsBase}),n.createElement(m,{title:"Seguici su",items:d,assetsBase:e.assetsBase}),n.createElement(m,{title:"Scarica gratis l'App",items:p,assetsBase:e.assetsBase})):n.createElement(n.Fragment,null);var v={"footer-wrapper":"index-module_footer-wrapper__yvt-f","footer-bottom":"index-module_footer-bottom__Lg88q","footer-info":"index-module_footer-info__ARO6n"};let y=e=>n.createElement(h.Provider,{value:{onClick:e.onClickItem}},n.createElement("footer",{className:v["footer-wrapper"]},n.createElement(_,{show:e.type,assetsBase:e.assetsBase}),n.createElement("div",{className:v["footer-bottom"]},n.createElement("img",{src:`${e.assetsBase}/static/logos/grey-short.svg`,width:"136",height:"32",alt:"",crossOrigin:"anonymous",loading:"lazy"}),n.createElement(r.a,{size:"small",classes:[v["footer-info"]]},"\xa9 ",new Date().getFullYear()," Subito.it - P.IVA 05526340962"))));y.displayName="Footer"},68993:(e,t,i)=>{"use strict";i.d(t,{H:()=>iV,c:()=>t8});var r=i(96540),n=i(80976),o=i(91375),a=i(22021),s=i(44848),l=i(49922),u=i(39505),c=i(70204),d=i(33282),p=i(46942),f=i.n(p),h=i(37337),g=i(20813),m=i(7095),E=i(68240),_=i(14476);function v(e){return e instanceof Error&&"ZodError"===e.name&&"issues"in e&&Array.isArray(e.issues)}var y=class extends Error{name;details;constructor(e,t){super(e,t),this.name="ZodValidationError",this.details=function(e){if(e){let t=e.cause;if(v(t))return t.issues}return[]}(t)}toString(){return this.message}};function b(e){return 0!==e.length}var I=/[$_\p{ID_Start}][$\u200c\u200d\p{ID_Continue}]*/u,O="Validation error",R=(e={})=>t=>v(t)?function(e,t={}){let i=e.errors;return new y(b(i)?("messageBuilder"in t?t.messageBuilder:function(e={}){let{issueSeparator:t="; ",unionSeparator:i=", or ",prefixSeparator:r=": ",prefix:n=O,includePath:o=!0,maxIssuesInMessage:a=99}=e;return e=>{var s;return s=e.slice(0,a).map(e=>(function e(t){let{issue:i,issueSeparator:r,unionSeparator:n,includePath:o}=t;if(i.code===_.eq.invalid_union)return i.unionErrors.reduce((t,i)=>{let a=i.issues.map(t=>e({issue:t,issueSeparator:r,unionSeparator:n,includePath:o})).join(r);return t.includes(a)||t.push(a),t},[]).join(n);if(i.code===_.eq.invalid_arguments)return[i.message,...i.argumentsError.issues.map(t=>e({issue:t,issueSeparator:r,unionSeparator:n,includePath:o}))].join(r);if(i.code===_.eq.invalid_return_type)return[i.message,...i.returnTypeError.issues.map(t=>e({issue:t,issueSeparator:r,unionSeparator:n,includePath:o}))].join(r);if(o&&b(i.path)){var a;if(1===i.path.length){let e=i.path[0];if("number"==typeof e)return`${i.message} at index ${e}`}return`${i.message} at "${1===(a=i.path).length?a[0].toString():a.reduce((e,t)=>{if("number"==typeof t)return e+"["+t.toString()+"]";if(t.includes('"'))return e+'["'+t.replace(/"/g,'\\"')+'"]';if(!I.test(t))return e+'["'+t+'"]';let i=0===e.length?"":".";return e+i+t},"")}"`}return i.message})({issue:e,issueSeparator:t,unionSeparator:i,includePath:o})).join(t),null!==n?s.length>0?[n,s].join(r):n:s.length>0?s:O}}(t))(i):e.message,{cause:e})}(t,e):t instanceof Error?new y(t.message,{cause:t}):new y("Unknown error"),N=i(14327);let T=(e,t)=>{if(!t)return e;let i=new URL(e);return Object.entries(t).forEach(([e,t])=>{null!=t&&""!==t&&i.searchParams.set(e,`${t}`)}),i.toString()},A=async(e,t,i=5e3)=>{let r=new AbortController,n=setTimeout(()=>r.abort(`Call to ${e} timed out after ${i}ms`),i);return fetch(e,{...t,signal:r.signal}).finally(()=>clearTimeout(n))},D=e=>{throw console.error(e.message),e},S=(e=[])=>async t=>{if(!t.ok)try{let e=await t.json(),i=e?.errors;if(i)throw new N.N(`Error ${t.status} calling ${t.url}: ${i[0].info}`,{status:t.status,errors:i,timeoutMs:e.timeout_ms,backoffTimeMs:e.backoff_time_ms});throw Error("Unexpected error")}catch(i){if(i instanceof N.N){if(e.includes(t.status))throw i;D(i)}D(new N.N(`Error ${t.status} calling ${t.url}: ${t.statusText}`,{status:t.status,errors:[]}))}return t},w=async e=>{try{return await e.json()}catch(t){D(new N.N(`Error ${e.status} calling ${e.url}: ${t.message}`,{status:e.status,errors:t.message}))}},L=e=>e,U=async(e,t)=>(null===t?L:"function"==typeof t?t:(0,E.morphism)(t))(e),C=async(e,t,i)=>{if(!i)return t;let r=await i.safeParseAsync(t);if(!r.success){let t=function(e,t={}){return R(t)(e)}(r.error);console.warn(`${t.toString()} calling ${e.url}`)}return r.success?r.data:t},x=(e,t)=>async i=>w(i).then(t=>U(t,e)).then(e=>C(i,e,t)).then(e=>({status:i.status,body:e})),P=e=>{let t={};return e?.bottega&&(t.cookie=`bottega=${e.bottega}`),e?.authToken&&(t.Authorization=`Bearer ${e.authToken}`),e?.environmentID&&(t["X-Subito-Environment-ID"]=e.environmentID),e?.canarySupport&&(t["X-Subito-Canary-Support"]=e.canarySupport),t},z=(e,t)=>A(e.url,t,e.timeoutMs).then(S(e.acceptedErrorStatuses)),k=async({queryParams:e,channelOverride:t,...i})=>z({...i,url:T(i.url,e)},{method:"GET",headers:{"X-Subito-Channel":t??"web",...P(i.sbtHeaders)},credentials:"include"}),M=_.z.enum(["BLUE","RED","YELLOW","PURPLE","GREEN"]),V=_.z.union([_.z.enum(["DISCOUNT","TRUCK"]),_.z.string()]);_.z.enum(["web","iphone","ipad","android"]),_.z.enum(["NEWAD","EDITAD","PROMOTE","RESERVEDAREA"]),_.z.enum(["PROMOTE","MANAGEADS","LEGACY_ADIN_STEP_1"]);let F=_.z.object({bannerId:_.z.number(),title:_.z.string(),description:_.z.string(),code:_.z.string().optional(),placeholders:_.z.array(_.z.string()).optional(),icon:V.nullable().optional(),color:M.nullable().optional()}),j=_.z.object({banners:_.z.array(F)}),B=e=>(0,E.createSchema)(e,{undefinedValues:{strip:!0}}),G=e=>(0,E.createSchema)(e,{undefinedValues:{strip:!0}}),K=B({bannerId:"banner_id",title:"title",description:"description",code:"code",placeholders:"placeholders",icon:"icon",color:"color"}),q=B({banners:{path:"banners",fn:(0,E.morphism)(K)}}),H=B({uri:()=>"/geo/region",id:"key",value:"value",friendlyName:"friendly_name",label:"label",level:"level",neighbors:"neighbors"}),Y=G({uri:()=>"/geo/region",id:"key",value:"value",friendly_name:"friendlyName",label:"label",level:"level",neighbors:"neighbors"});B({regions:{path:"values",fn:(0,E.morphism)(H)}});let $=B({uri:()=>"/geo/city",id:"key",value:"value",label:"label",level:"level",friendlyName:"friendly_name",istat:"istat",regionId:"region_id",shortName:"short_name"}),Z=G({uri:()=>"/geo/city",id:"key",value:"value",label:"label",level:"level",friendly_name:"friendlyName",istat:"istat",region_id:"regionId",short_name:"shortName"}),X=B({uri:()=>"/geo/town",id:"key",value:"value",label:"label",level:"level",friendlyName:"friendly_name",istat:"istat",cityId:"city_id",hasZone:"has_zone",regionId:"region_id"}),W=G({uri:()=>"/geo/town",id:"key",value:"value",label:"label",level:"level",friendly_name:"friendlyName",istat:"istat",city_id:"cityId",has_zone:"hasZone",region_id:"regionId"}),J=B({uri:()=>"/geo/zone",id:"key",value:"value",label:"label",level:"level",cityId:"city_id",regionId:"region_id",townId:"town_id"});B({zipCode:"zip_code",town:"town",province:"province"});let Q=B({address:"address",latitude:"latitude",longitude:"longitude",zoom:"zoom",showPin:{path:"show_pin",fn:e=>"1"==e}}),ee=B({uri:"uri",type:"type",label:"label",region:{path:"region",fn:(0,E.morphism)(H)},city:{path:"city",fn:(0,E.morphism)($)},town:{path:"town",fn:(0,E.morphism)(X)},map:{path:"map",fn:(0,E.morphism)(Q)}});B({zones:{path:"values",fn:(0,E.morphism)(J)}});let et=B({region:{path:"region",fn:(0,E.morphism)(H)},city:{path:"city",fn:(0,E.morphism)($)},town:{path:"town",fn:(0,E.morphism)(X)}}),ei=G({region:{path:"region",fn:(0,E.morphism)(Y)},city:{path:"city",fn:(0,E.morphism)(Z)},town:{path:"town",fn:(0,E.morphism)(W)}});B({entries:{path:"data",fn:(0,E.morphism)(et)}});let er=B({cdnBaseUrl:"cdn_base_url"}),en=B({id:"key",label:"value",parentId:"macrocategory_id",friendlyName:"friendly_name",weight:"weight"}),eo=B({name:"name",type:"type",phone:"phone",userId:"user_id",company:"company",shopId:{path:"shop_id",fn:e=>void 0!==e?`${e}`:e},shopName:"shop_name",proTransactionsEnabled:"pro_transactions_enabled"}),ea=B({gallery:"gallery",urgent:"urgent",smartbumpedAt:"smartbumped_at"}),es={kind:()=>"AdItem",urn:"urn",type:"type",category:{path:"category",fn:(0,E.morphism)(en)},subject:"subject",body:"body",date:"dates.display",images:{path:"images",fn:(0,E.morphism)(er)},features:{path:"features",fn:e=>e.reduce((e,t)=>({...e,[t.uri]:t}),{})},advertiser:{path:"advertiser",fn:(0,E.morphism)(eo)},geo:{path:"geo",fn:(0,E.morphism)(ee)},visibilityOptions:{path:"visibility_options",fn:(0,E.morphism)(ea)},urls:"urls"},el=B(es),eu=B({...es,gallerized:()=>!0}),ec=B({total:"count_all",checkNew:"checknew",lines:"lines",start:"start",ads:{path:"ads",fn:(0,E.morphism)(el)},filterLabels:"filters"});B(ec),B({...ec,ads:{path:"ads",fn:(0,E.morphism)(eu)}}),B({values:"values",topValues:"top_values"});let ed=B({filters:"filters",searchId:"search_id",insertionDate:"insertion_date",updateDate:"update_date",sort:"sort"});B({savedSearches:{path:"saved_searches",fn:(0,E.morphism)(ed)}});let ep={uri:"uri",type:"type",label:"label",dataSource:"datasource",queryString:"query_string",dependencies:"dependencies",multiSelection:"multiselection",searchable:"searchable"},ef=B(ep),eh=B({...ep,subLabel:"sublabel",min:{path:"min",fn:(0,E.morphism)(ef)},max:{path:"max",fn:(0,E.morphism)(ef)}});B({filters:{path:"filters",fn:(0,E.morphism)(eh)}});let eg=_.z.string().min(5).max(9),em=_.z.enum(["ACTIVE","UNVERIFIED"]),eE=_.z.enum(["M","F"]),e_=_.z.object({userID:eg,email:_.z.string().email(),status:em,creationDate:_.z.string().datetime({offset:!0})});_.z.array(e_);let ev=_.z.object({categories:_.z.array(_.z.object({key:_.z.string(),value:_.z.string()}))}),ey=_.z.object({subscriptionId:_.z.number(),statusSubscriptions:_.z.string(),startDate:_.z.string(),endDate:_.z.string(),product:ev});_.z.object({subscriptions:_.z.array(ey)}),_.z.object({userID:eg,email:_.z.string().email(),username:_.z.string()}),_.z.object({username:_.z.string(),showPhone:_.z.boolean(),isDefaultName:_.z.boolean().optional(),picture:_.z.string().optional()});let eb=_.z.object({show:_.z.boolean(),number:_.z.string().optional(),prefix:_.z.string().optional()});_.z.object({username:_.z.string(),birthdate:_.z.string().optional(),geo:N.j.optional(),sex:eE.optional(),phone:eb.optional()}),_.z.object({adURN:N.k,phoneNumber:_.z.string(),force:_.z.boolean()}),_.z.object({firstAdInsertionDate:_.z.string(),totalApprovedAds:_.z.number(),userCategoriesInfo:_.z.array(_.z.object({category:_.z.nativeEnum(N.C),approvedAds:_.z.number()}))});let eI=_.z.object({email:_.z.string(),date:_.z.string(),channel:_.z.string(),adminId:_.z.string()});_.z.object({history:_.z.array(eI)});let eO=_.z.object({newEmail:_.z.string(),id:_.z.string(),challenges:_.z.array(_.z.object({type:_.z.enum(["account","new_email"]),methods:_.z.array(_.z.enum(["email","phone"]))}))});_.z.object({account:_.z.object({email:_.z.string(),phone:_.z.optional(_.z.string()),hasSafeSession:_.z.optional(_.z.boolean())}),session:_.z.optional(eO)}),_.z.object({token:_.z.string()}),_.z.object({isEligible:_.z.boolean()}),B({userID:"user_id",email:"email",status:"status",creationDate:"creation_date"});let eR=B({categories:"product.categories"}),eN=B({subscriptionId:"subscription_id",statusSubscriptions:"status_subscriptions",startDate:"start_date",endDate:"end_date",product:(0,E.morphism)(eR)});B({subscriptions:{path:"subscriptions",fn:(0,E.morphism)(eN)}}),B({userID:"user_id",email:"email",username:"username"}),B({username:"name",showPhone:"show_phone",isDefaultName:"is_default_name",picture:"picture"});let eT=B({show:"show",number:"number",prefix:"idd_prefix"}),eA=G({show:"show",number:"number",idd_prefix:"prefix"});G({borndate:"birthdate",name:"username",gender:"sex",geo:{path:"geo",fn:(0,E.morphism)(ei)},phone:{path:"phone",fn:(0,E.morphism)(eA)}}),B({birthdate:"borndate",username:"name",sex:"gender",geo:{path:"geo",fn:(0,E.morphism)(et)},phone:{path:"phone",fn:(0,E.morphism)(eT)}}),B({adURN:"ad_urn",phoneNumber:"phone_number",force:"force"}),B({firstAdInsertionDate:"first_ad_insertion_date",totalApprovedAds:"total_num_approved_ads",userCategoriesInfo:{path:"categories_num_approved_ads",fn:e=>e.map(e=>({category:e.category_id.toString(),approvedAds:e.num_approved_ads}))}});let eD=B({email:"email",date:"date",channel:"channel",adminId:"admin_id"});B({history:{path:"history",fn:(0,E.morphism)(eD)}});let eS=B({newEmail:"new_email",id:"id",challenges:{path:"challenges",fn:e=>e.map(e=>({type:e.type,methods:e.methods}))}});B({account:{email:"account.email",phone:"account.phone",hasSafeSession:"account.is_safe"},session:{path:"session",fn:e=>e?(0,E.morphism)(eS,e):void 0}}),B({token:"token"}),B({isEligible:"is_eligible"});let ew=B({receiptItem:"receipt_item",type:"type",value:"value"}),eL=B({resourceName:"resource_name",resourceUrl:"resource_url"}),eU=B({alternativeSubtitle:"alternative_subtitle"}),eC=B({name:"name",title:"title",subtitle:"subtitle",countdown:{path:"countdown",fn:(0,E.morphism)(eU)},assets:{path:"assets",fn:(0,E.morphism)(eL)}});G({name:"name",start_date:"startDate",end_date:"endDate",purchased_products:"purchasedProducts",gift_products:"giftProducts",status:"status",type:"type",ad_ids:"adIds",user_id:{path:"userId",fn:e=>Number.parseInt(e,10)}});let ex=B({id:"id",channels:"channels",startDate:"start_date",endDate:"end_date",criteria:"criteria",discounts:{path:"discounts",fn:(0,E.morphism)(ew)},content:{path:"content",fn:(0,E.morphism)(eC)}});B({promo:{path:"promotions",fn:(0,E.morphism)(ex)}});let eP=B({promotionName:"promotion_name",promotionDiscount:{path:"promotion_discount",fn:(0,E.morphism)(ew)}}),ez=B({label:"label",amount:"amount",type:"type",amountPrefixLabel:"amount_prefix_label",strikethroughAmount:"strikethrough_amount",promo:{path:"promo",fn:(0,E.morphism)(eP)}});B({total:"total",item:{path:"item",fn:(0,E.morphism)(ez)},extra:{path:"extra",fn:(0,E.morphism)(ez)}});let ek=_.z.object({receiptItem:_.z.string(),type:_.z.enum(["fixed","percentage","amount"]),value:_.z.number()}),eM=_.z.object({alternativeSubtitle:_.z.string()}),eV=_.z.object({resourceName:_.z.string().optional(),resourceUrl:_.z.string().optional()}),eF=_.z.object({name:_.z.string(),title:_.z.string(),subtitle:_.z.string(),countdown:_.z.optional(eM),assets:eV});_.z.object({name:_.z.string(),giftProducts:_.z.array(_.z.string()),status:_.z.enum(["DRAFT","BLOCKED","SCHEDULED","RUNNING","CANCELLED","DONE"]),type:_.z.enum(["EXTRACTION","LIST","USERID"]),userId:_.z.string().optional(),adIds:_.z.array(_.z.string()).optional(),startDate:_.z.date().optional(),endDate:_.z.date().optional(),purchasedProducts:_.z.array(_.z.string()).optional()});let ej=_.z.object({id:_.z.string(),channels:_.z.array(_.z.string()),startDate:_.z.string(),endDate:_.z.string(),criteria:_.z.array(_.z.record(_.z.string(),_.z.string())),discounts:_.z.array(ek),content:eF});_.z.object({promo:_.z.array(ej)});let eB=_.z.object({promotionName:_.z.string(),promotionDiscount:ek}),eG=_.z.enum(["ad","light_shipping","full_shipping","fee"]),eK=_.z.object({label:_.z.string(),amount:_.z.number(),type:eG,amountPrefixLabel:_.z.string().optional(),strikethroughAmount:_.z.number().optional(),promo:_.z.optional(eB)});_.z.object({total:_.z.number(),item:eK,extra:_.z.array(eK).nullable()});let eq=_.z.enum(["solid","outline"]),eH=_.z.string().uuid(),eY=_.z.enum(["securepay","fullshipping"]),e$=_.z.enum(["C2C","B2C"]);_.z.enum(["buyer","seller"]);let eZ=_.z.enum(["NEW","SALE_REQUESTED","PURCHASE_REQUESTED","PURCHASE_ACCEPTED","CONFIRM_AVAILABILITY","PAYMENT_CONFIRMED","PAYMENT_CONFIRMATION_REMINDED","ITEM_SHIPPED","ITEM_RETURNING","ITEM_RETURNED","ITEM_AT_SERVICE_POINT","ITEM_DELIVERED","ITEM_RETURNABLE","ITEM_RETURNABLE_AUTOMATICALLY","EVERYONE_REFUNDED","TO_BE_CLOSED_AUTOMATICALLY","CLOSED","CANCELED","SELLER_CANCELED","EXPIRED","EXPIRED_REFUND_BUYER","PURCHASE_REFUSED","PAYMENT_CANCELED","TRANSACTION_LOCKED","REFUNDED","FULL_REFUNDED","GDPR_CLOSED","GDPR_BUYER_DELETED","GDPR_SELLER_DELETED","PARTIAL_REFUNDED"]),eX=_.z.enum(["success","warning","neutral"]),eW=_.z.enum(["is_final","is_shipment_phase","is_payment_phase","display_original_price","display_receipt","display_shipping_address","display_shipping_options","display_buyer_assistant","display_seller_assistant","is_unavailable","is_in_progress"]),eJ=_.z.object({securepayLabel:_.z.string().optional(),fullshippingLabel:_.z.string().optional()}),eQ=_.z.string().url();_.z.object({flowURL:eQ});let e0=_.z.object({label:_.z.string(),flowURL:eQ,style:eq}),e1=_.z.custom(e=>"string"==typeof e&&/^ad(.{36}|\d{9})list\d{8,9}$/.test(e)),e2=_.z.object({cdnBaseUrl:_.z.string().url()}),e3=_.z.object({urn:N.k,title:_.z.string(),category:_.z.nativeEnum(N.C),price:_.z.optional(N.p),image:_.z.optional(e2)}),e5=_.z.object({origin:_.z.optional(N.u),destination:_.z.nullable(N.u),supportedDestinationTypes:_.z.optional(_.z.array(N.l)),destinationType:_.z.optional(N.l),destinationServicePoint:_.z.optional(N.m),shippingCarriers:_.z.optional(_.z.array(N.n)),shippingOptionID:_.z.optional(_.z.nativeEnum(N.P))}),e4=_.z.object({transactionID:eH,transactionType:eY,buyerID:eg,buyerName:_.z.string(),sellerID:eg,sellerName:_.z.string(),state:eZ,actions:_.z.array(e0),itemID:e1,itemPrice:_.z.optional(N.p),adInfo:e3,sellerRevenue:_.z.optional(N.p),shippingAddressInfo:_.z.optional(e5),updatedAt:_.z.string().datetime({offset:!0}),userType:e$,buyerPrice:_.z.optional(N.p)});_.z.object({transactions:_.z.array(e4)});let e6=_.z.object({transactionID:eH,adTitle:_.z.string(),state:eZ,transactionType:eY,buyerID:eg,sellerID:eg,createdAt:_.z.string().datetime({offset:!0}),updatedAt:_.z.string().datetime({offset:!0})});_.z.object({userID:eg,email:_.z.string().email(),transactions:_.z.array(e6)});let e8=_.z.enum(["defective","useless","incorrect_item","bought_by_mistake","wrong_size"]);_.z.object({reason:_.z.string(e8).nullable(),description:_.z.string().nullable(),phone:_.z.string().nullable()});let e7=_.z.object({ID:_.z.string(),buyerLabel:_.z.string(),sellerLabel:_.z.string(),buyerHelpURL:_.z.string(),sellerHelpURL:_.z.string(),style:eX,options:_.z.array(eW),buyerTip:eJ.optional(),sellerTip:eJ.optional()});_.z.object({states:_.z.array(e7)});let e9=B({optionID:"option_id",carrierID:"carrier_id",carrierName:"carrier_name",carrierShortName:"carrier_short_name",destinationType:"destination_type",total:"total",strikethroughTotal:"strikethrough_total"});B({rates:{path:"rates",fn:(0,E.morphism)(e9)}});let te=B({address:"address",carrierID:"carrier_id",carrierName:"carrier_name",countryCode:"country_code",name:"name",postcode:"postcode",servicePointID:"service_point_id",town:"town"}),tt=B({address:"address",addressLine2:"address_line_2",id:"id",name:"name",number:"number",postcode:"postcode",province:"province",state:"state",surname:"surname",town:"town",phone:"phone"});B({address:"address",addressLine2:"address_line_2",id:"id",name:"name",number:"number",postcode:"postcode",province:"province",state:"state",surname:"surname",town:"town",phone:"phone",valid:"valid"});let ti=B({cdnBaseUrl:"cdn_base_url"}),tr=B({urn:"urn",title:"title",category:"category",price:"price",image:{path:"image",fn:(0,E.morphism)(ti)}}),tn=B({destination:{path:"destination",fn:(0,E.morphism)(tt)},destinationServicePoint:{path:"destination_service_point",fn:(0,E.morphism)(te)},destinationType:"destination_type",supportedDestinationTypes:"supported_destination_types",shippingOptionID:"shipping_option_id",shippingCarriers:"shipping_carriers",origin:{path:"origin",fn:(0,E.morphism)(tt)}}),to=B({label:"label",flowURL:"flow_url",style:"style"}),ta=B({transactionID:"transaction_id",transactionType:"transaction_type",buyerID:"buyer_id",buyerName:"buyer_name",sellerID:"seller_id",sellerName:"seller_name",state:"state",actions:{path:"actions",fn:(0,E.morphism)(to)},itemID:"item_id",itemPrice:"item_price",adInfo:{path:"ad_info",fn:(0,E.morphism)(tr)},sellerRevenue:"seller_revenue",shippingAddressInfo:{path:"shipping_address_info",fn:(0,E.morphism)(tn)},updatedAt:"updated_at",userType:"user_type",buyerPrice:"buyer_price"});B({transactions:{path:"transactions",fn:(0,E.morphism)(ta)}});let ts=B({transactionID:"transaction_id",adTitle:"ad_title",state:"state",transactionType:"transaction_type",buyerID:"buyer_id",sellerID:"seller_id",createdAt:"created_at",updatedAt:"updated_at"});B({userID:"user_id",email:"email",transactions:{path:"transactions",fn:(0,E.morphism)(ts)}});let tl=B({securepayLabel:"securepay_label",fullshippingLabel:"fullshipping_label"}),tu=B({ID:"id",buyerLabel:"buyer_label",sellerLabel:"seller_label",buyerHelpURL:"buyer_help_url",sellerHelpURL:"seller_help_url",style:"style",options:"options",buyerTip:{path:"buyer_tip",fn:(0,E.morphism)(tl)},sellerTip:{path:"seller_tip",fn:(0,E.morphism)(tl)}});B({states:{path:"states",fn:(0,E.morphism)(tu)}}),B({flowURL:"flow_url"}),_.z.string().nullable();let tc=B({key:"key",value:"value",friendlyName:"friendly_name",macrocategoryId:"macrocategory_id",weight:"weight"}),td=B({shopId:"shop_id",name:"name",logo:"logo",adsCount:"ads_count",address:"address",urls:"urls",website:"website",openingTime:"opening_time",social:"social",shopCategories:{path:"shop_categories",fn:(0,E.morphism)(tc)},activeShopCategories:{path:"active_shop_categories",fn:(0,E.morphism)(tc)}});B({countAll:"count_all",lines:"lines",start:"start",shops:{path:"shops",fn:(0,E.morphism)(td)}});let tp=B({rating:"rating",comment:"comment",publishedAt:"published_at",author:"author"}),tf=B({placeUri:"place_uri"});B({shopId:"shop_id",rating:"rating",reviewCount:"review_count",reviews:{path:"reviews",fn:(0,E.morphism)(tp)},links:{path:"links",fn:(0,E.morphism)(tf)}});let th=_.z.object({uri:_.z.string(),secureuri:_.z.string()}),tg=_.z.object({uri:_.z.string(),big:th.optional(),medium:th.optional(),small:th.optional()}),tm=_.z.object({default:_.z.string(),mobile:_.z.string()}),tE=_.z.object({status:_.z.string(),from:_.z.string().optional(),to:_.z.string().optional()}),t_=_.z.object({day:tE}),tv=_.z.object({am:tE,pm:tE}),ty=_.z.union([_.z.literal("mon"),_.z.literal("tue"),_.z.literal("wed"),_.z.literal("thu"),_.z.literal("fri"),_.z.literal("sat"),_.z.literal("sun")]),tb=_.z.record(ty,_.z.union([t_,tv])),tI=_.z.object({facebook:_.z.string().optional(),instagram:_.z.string().optional(),linkedin:_.z.string().optional()}),tO=_.z.object({key:_.z.string(),value:_.z.string(),friendlyName:_.z.string(),macrocategoryId:_.z.string(),weight:_.z.number()}),tR=_.z.object({shopId:_.z.number().optional(),name:_.z.string(),logo:tg.optional(),adsCount:_.z.number().optional(),address:_.z.string().optional(),urls:tm.optional(),website:_.z.string().optional(),openingTime:tb.optional(),social:tI.optional(),shopCategories:_.z.array(tO).optional(),activeShopCategories:_.z.array(tO).optional()});_.z.object({countAll:_.z.number(),lines:_.z.number(),start:_.z.number(),shops:_.z.array(tR)});let tN=_.z.object({rating:_.z.number().optional(),comment:_.z.string().optional(),publishedAt:_.z.string().optional(),author:_.z.string().optional()}),tT=_.z.array(tN),tA=_.z.object({placeUri:_.z.string().optional()});_.z.object({shopId:_.z.string(),rating:_.z.number().optional(),reviewCount:_.z.number().optional(),reviews:tT.optional(),links:tA.optional()});let tD=G({date_of_birth:{path:"dateOfBirth",fn:e=>{let[t,i,r]=e.split("/");return`${r}-${i}-${t}`}},first_name:"firstName",last_name:"lastName"}),tS=G({company_name:"companyName"});G({hyperwallet_id:"userToken",address:"address",city:"city",province:"province",country:"country",postal_code:"postalCode",is_company:"isCompany",private_info:{path:"privateInfo",fn:(0,E.morphism)(tD)},company_info:{path:"companyInfo",fn:(0,E.morphism)(tS)}}),B({walletType:"wallet_type"});let tw=B({dateOfBirth:{path:"date_of_birth",fn:e=>{let[t,i,r]=e.split("-");return`${r}/${i}/${t}`}},firstName:"first_name",lastName:"last_name"}),tL=B({companyName:"company_name"});B({userToken:"hyperwallet_id",address:"address",city:"city",province:"province",country:"country",postalCode:"postal_code",isCompany:"is_company",privateInfo:{path:"private_info",fn:(0,E.morphism)(tw)},companyInfo:{path:"company_info",fn:(0,E.morphism)(tL)},selectedTransferMethod:"selected_transfer_method.hyperwallet_token",canReceivePayments:"can_receive_payments",verificationInProgress:"verification_in_progress"}),B({type:"type",token:"token"}),B({status:"status",paymentID:"payment_id"}),_.z.enum(["PRIVATE","BUSINESS"]),_.z.object({walletType:_.z.enum(["PRIVATE","BUSINESS"])}),_.z.string();let tU=_.z.string(),tC=_.z.string(),tx=_.z.object({firstName:_.z.string(),lastName:_.z.string(),dateOfBirth:_.z.string()}),tP=_.z.object({companyName:_.z.string()});_.z.object({userToken:_.z.optional(tC),address:_.z.string(),city:_.z.string(),province:_.z.string(),country:_.z.string(),postalCode:_.z.string(),isCompany:_.z.boolean(),privateInfo:_.z.optional(tx),companyInfo:_.z.optional(tP)}).extend({userToken:tC,selectedTransferMethod:_.z.nullable(tU),canReceivePayments:_.z.boolean(),verificationInProgress:_.z.boolean()});let tz=_.z.enum(["BANK_ACCOUNT","PAYPAL_ACCOUNT"]),tk=_.z.object({token:tU,type:tz});_.z.array(tk);let tM=_.z.enum(["SETTLED","PAYOUT_CANCELED","PAYOUT_FAILED","REFUNDED","PAYOUT_IN_PROGRESS","VOIDED","COMPLETED","PREAUTHORIZED"]);_.z.object({status:tM,paymentID:_.z.string().optional()});let tV=B({name:"name",price:"price",originalPrice:"price_original",label:"label",groupName:"gr_name",state:"state",bundleList:"bundle_list"}),tF=B({name:"name",description:"description",label:"label",excludedGroups:"exclude_groups",options:{path:"paid_options",fn:(0,E.morphism)(tV)}});B({groups:{path:"groups",fn:(0,E.morphism)(tF)}}),B({originalPrice:"price_original",price:"price",name:"name",description:"description",label:"label",title:"title",state:"state"}),B({transactionId:"transaction_id"});let tj=["ad_pay","ad_pay_2"],tB=["more_photos"];_.z.enum(tj),_.z.enum(tB);let tG=_.z.enum([...tj,...tB]),tK=_.z.enum(["bounce","gallery","bundle","urgent","homepage_recommender"]);_.z.enum(["NEWAD","EDITAD","PROMOTE","NOTIFICATION","ADEDITREFUSE","ADPROLONG_V2","ADPROLONG_V2_EXPIRING","HOMEPAGE","RESERVEDAREA_PURCHASE","RESERVEDAREA_PROMOTE","ADDETAIL_PROMOTE"]);let tq=_.z.enum(["available","unavailable"]),tH=_.z.string(),tY=_.z.object({name:tH,price:_.z.number(),originalPrice:_.z.number(),label:_.z.string(),groupName:tK,state:tq,bundleList:_.z.array(tH)}),t$=_.z.object({name:tK,description:_.z.string(),label:_.z.string(),excludedGroups:_.z.array(tK),options:_.z.array(tY)});_.z.object({groups:_.z.array(t$)});let tZ=_.z.object({name:tG,price:_.z.number(),description:_.z.string(),title:_.z.string(),label:_.z.string()}).extend({originalPrice:_.z.number(),state:tq});_.z.object({fees:_.z.array(tZ)}),_.z.object({redirect:_.z.string()});let tX=_.z.object({ad_id:_.z.string(),paid_options:_.z.array(_.z.object({name:_.z.union([tH,tG]),label:_.z.string(),price:_.z.number(),originalPrice:_.z.number().optional()}))});_.z.union([_.z.object({entry_point:_.z.enum(["NEWAD","EDITAD","ADEDITREFUSE"]),items:_.z.array(tX.extend({action_id:_.z.string()})),afterPaymentReturnTo:_.z.string().optional()}),_.z.object({entry_point:_.z.enum(["PROMOTE","HOMEPAGE","NOTIFICATION","RESERVEDAREA_PROMOTE","RESERVEDAREA_PURCHASE","ADDETAIL_PROMOTE","ADPROLONG_V2","ADPROLONG_V2_EXPIRING"]),items:_.z.array(tX),afterPaymentReturnTo:_.z.string().optional()})]),_.z.object({nonce:_.z.string(),amount:_.z.number(),items:_.z.array(_.z.object({ad_id:_.z.string(),paid_options:_.z.array(_.z.union([tH,tG])),action_id:_.z.string().optional()})),voucher:_.z.string().optional()}),_.z.object({transactionId:_.z.string()});let tW=(e,t,i,r=[])=>k({url:`${e}/v1/vouchers/banners`,queryParams:{entry_point:t,page:i,categories:r.join(",")}}).then(x(q,j));(0,E.morphism)({email:"email",forwardPhone:"forward_phone",phone:"phone",name:"name",userId:"user_id"}),(0,E.morphism)({email:"email",name:"name",body:"body",cc:"cc",acceptTermsConds:"accept_terms_conds",phone:"phone",forwardPhone:"forward_phone"});let tJ=_.z.object({userId:_.z.string(),email:_.z.string(),name:_.z.string(),forwardPhone:_.z.boolean().optional(),phone:_.z.string().optional()}),tQ=_.z.object({email:_.z.string(),name:_.z.string(),body:_.z.string(),cc:_.z.boolean(),acceptTermsConds:_.z.boolean(),phone:_.z.string().optional(),forwardPhone:_.z.boolean().optional()});_.z.object({buyerInfo:tJ.optional()}),_.z.object({reply:tQ.optional()}),_.z.object({name:_.z.string(),body:_.z.string(),accept_terms_conds:_.z.boolean(),cc:_.z.boolean(),forward_phone:_.z.boolean().optional(),phone:_.z.string().optional()});let t0=r.createContext({});function t1(e){let t=r.useContext(t0),{children:i,...n}=e;return r.createElement("a",{...n,href:n.href,onClick:e=>{n.onClick?.(e),t.onClick?.(n.href)}},i)}var t2={"accedi-ora":"index-module_accedi-ora__i6nP1"};let t3="login-tooltip-disabled";function t5(){return r.createElement("div",{className:t2["accedi-ora"]},"Buoni affari ti stanno aspettando!\xa0",r.createElement("strong",null,"Accedi ora"))}var t4={"notification-badge":"index-module_notification-badge__0fBtF",mini:"index-module_mini__1VV2G"};let t6=e=>{let{count:t,mini:i=!1}=e,n=t4.mini;return t?r.createElement("div",{className:f()(t4["notification-badge"],{[n]:i})},t<=99?t:"99+"):r.createElement(r.Fragment,null)};var t8={"sticky-banner":"banner-module_sticky-banner__7i07Q","sticky-banner--text-only":"banner-module_sticky-banner--text-only__Cs0e3",badge:"banner-module_badge__USx41",text:"banner-module_text__ZF-Ai"};let t7=()=>r.createElement("div",{className:f()(t8["sticky-banner"],"theme-redCorporate")}),t9=(0,r.lazy)(()=>Promise.all([i.e(7022),i.e(5070)]).then(i.bind(i,95070)));var ie=r.memo(({placement:e,pulseInstance:t,assetsBase:i})=>{let{optimizely:n}=(0,r.useContext)(g.wP),[o,a]=(0,r.useState)(!1),[s,l]=(0,r.useState)(null);return["home","listing","adview"].includes(e)?null===n?r.createElement(t7,null):((0,m.Bd)()&&!o&&n.onReady().then(()=>{let t=n.getFeatureVariables(`subito-product-marketing.${e}.sticky-banner`);a(!0),0!==Object.keys(t).length&&l(t)}),null===s)?r.createElement(t7,null):r.createElement(h.A,{fallback:r.createElement(t7,null)},r.createElement(r.Suspense,{fallback:r.createElement(t7,null)},r.createElement(t9,{placement:e,pulseInstance:t,assetsBaseUrl:i,withStars:s.withStars,bannerText:s.bannerText,bannerIcon:s.bannerIcon,bannerBadge:s.bannerBadge,bannerLink:s.bannerLink,modalTitle:s.modalTitle,modalDesktopImage:s.modalDesktopImage,modalMobileImage:s.modalMobileImage,modalText:s.modalText,modalFooter:s.modalFooter,modalLinkButtonLink:s.modalLinkButtonLink,modalLinkButtonText:s.modalLinkButtonText,modalCloseButtonText:s.modalCloseButtonText}))):null},(e,t)=>void 0!==e.pulseInstance?e.placement===t.placement&&e.assetsBase===t.assetsBase:void 0!==t.pulseInstance&&e.placement===t.placement&&e.assetsBase===t.assetsBase);let it=()=>r.createElement("svg",{width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg"},r.createElement("path",{d:"M6 19H5a3 3 0 0 1-3-3V8a3 3 0 0 1 3-3h14a3 3 0 0 1 3 3v8a3 3 0 0 1-3 3h-7.667L9.2 20.6A2 2 0 0 1 6 19zm13-2a1 1 0 0 0 1-1V8a1 1 0 0 0-1-1H5a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h3v2l2.667-2H19zM9 12a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0z",fillRule:"evenodd"})),ii=()=>r.createElement("svg",{width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg"},r.createElement("path",{d:"M15.05 16.463a7.5 7.5 0 1 1 1.414-1.414l4.243 4.244a1 1 0 0 1-1.414 1.414l-4.244-4.244zM10.5 16a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11z",fillRule:"evenodd"})),ir=()=>r.createElement("svg",{width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg"},r.createElement("path",{d:"M8 5a3 3 0 0 0-3 3v8a3 3 0 0 0 3 3h8a3 3 0 0 0 3-3V8a3 3 0 0 0-3-3H8zm0-2h8a5 5 0 0 1 5 5v8a5 5 0 0 1-5 5H8a5 5 0 0 1-5-5V8a5 5 0 0 1 5-5zm5 8h3a1 1 0 0 1 0 2h-3v3a1 1 0 0 1-2 0v-3H8a1 1 0 0 1 0-2h3V8a1 1 0 0 1 2 0v3z",fillRule:"evenodd"})),io=()=>r.createElement("svg",{width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg"},r.createElement("g",{fillRule:"nonzero"},r.createElement("path",{d:"M20.604 12.12l-2.244.838c-.322.12-.693-.025-.823-.324l-3.491-7.99c-.13-.3.027-.643.35-.763l2.244-.838c.322-.121.693.024.824.323l3.49 7.99c.13.3-.027.643-.35.763M14.84 13.335l-1.505 1.505a.552.552 0 0 1-.778 0L5.16 7.443a.552.552 0 0 1 0-.778L6.665 5.16a.551.551 0 0 1 .777 0l7.398 7.397a.552.552 0 0 1 0 .778M12.957 18.36l-.838 2.244c-.12.323-.463.48-.762.35l-7.99-3.491c-.3-.13-.445-.501-.325-.824l.84-2.244c.12-.322.463-.48.76-.35l7.992 3.492c.299.13.444.5.323.824"}))),ia=()=>r.createElement("svg",{width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg"},r.createElement("g",{fill:"none",fillRule:"evenodd"},r.createElement("path",{fill:"#AEB9C6",d:"M12 3a5 5 0 013.824 8.22C17.96 11.89 20 14.068 20 17.678v.775c0 1.082-.539 1.856-1.376 2.257-.461.221-.9.291-1.24.291H6.617c-.339 0-.778-.07-1.24-.29C4.539 20.307 4 19.533 4 18.451v-.775c0-3.61 2.04-5.788 4.176-6.456A5 5 0 0112 3zm0 2a3 3 0 100 6 3 3 0 000-6zm-2.423 8c-.332 0-1.205.287-1.891.8C6.626 14.594 6 15.827 6 17.677v.775c0 .274.067.37.24.453.142.069.309.095.375.095h10.77c.067 0 .233-.026.376-.095.172-.082.239-.179.239-.453v-.775c0-1.85-.626-3.083-1.686-3.877-.686-.513-1.559-.8-1.89-.8H9.576z",id:"a"}),r.createElement("g",{transform:"translate(14)"},r.createElement("rect",{id:"c",x:"0",y:"0",width:"12",height:"12",rx:"6",fill:"#000",filter:"url(#b)"}),r.createElement("rect",{id:"c",x:"0",y:"0",width:"12",height:"12",rx:"6",fillOpacity:"0",fill:"#FFF"}),r.createElement("rect",{fill:"#FFF",width:"12",height:"12",rx:"6"}),r.createElement("rect",{x:".5",y:".5",width:"11",height:"11",rx:"5.5"})),r.createElement("g",{transform:"translate(16 2)"},r.createElement("rect",{id:"e",x:"0",y:"0",width:"8",height:"8",rx:"4",fill:"#000",filter:"url(#d)"}),r.createElement("rect",{id:"e",x:"0",y:"0",width:"8",height:"8",rx:"4",fillOpacity:"0",fill:"#FFF"}),r.createElement("rect",{fill:"#F1F1F1",width:"8",height:"8",rx:"4"}),r.createElement("rect",{fill:"#F9423A",width:"8",height:"8",rx:"4"})))),is=()=>r.createElement("svg",{width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg"},r.createElement("path",{d:"M6.707 17.999A7.97 7.97 0 0 0 12 20a7.97 7.97 0 0 0 5.293-2.001 5.503 5.503 0 0 0-10.586 0zm-1.476-1.733a7.517 7.517 0 0 1 3.756-3.635 4 4 0 1 1 6.026 0 7.517 7.517 0 0 1 3.756 3.634 8 8 0 1 0-13.538 0zM12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm0-10a2 2 0 1 0 0-4 2 2 0 0 0 0 4z",fillRule:"evenodd"})),il=()=>r.createElement("svg",{width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg"},r.createElement("path",{d:"M11.9998871,3 C14.761274,3 17,5.2386508 17,8.00016933 C17,9.22709757 16.557948,10.3508585 15.8244317,11.2208825 C17.9593961,11.8887628 20,14.0674914 20,17.6774229 L20,18.4515424 C20,19.5336262 19.4614937,20.3082436 18.6241146,20.7091127 C18.1625359,20.930079 17.7235888,21.0001051 17.3845383,21 L6.61623493,21 C6.27708249,21.0001949 5.83785602,20.9302238 5.37596716,20.7091245 C4.53854492,20.3082631 4,19.5336448 4,18.4515424 L4,17.6774229 C4,14.067472 6.04060964,11.8887558 8.17577236,11.2207129 C7.44199698,10.3508882 7,9.22712434 7,8.00016933 C7,5.23859057 9.2384476,3 11.9998871,3 Z M11.9998871,5 C10.3430457,5 9,6.34313147 9,8.00016933 C9,9.65683826 10.3431283,11 11.9998871,11 C13.6566369,11 15,9.65673439 15,8.00016933 C15,6.34323535 13.6567195,5 11.9998871,5 Z M9.5769691,13 C9.24502787,13 8.37207569,13.2866804 7.6859541,13.8004913 C6.62642857,14.5939306 6,15.8274514 6,17.6774229 L6,18.4515424 C6,18.7259655 6.06725554,18.8227028 6.23950074,18.905154 C6.38244589,18.9735797 6.54853377,19 6.61469396,19 L17.3854132,19 C17.4515575,19 17.617615,18.9735826 17.7605315,18.9051658 C17.9327486,18.8227223 18,18.7259841 18,18.4515424 L18,17.6774229 C18,15.8274542 17.3735736,14.5939321 16.3140551,13.8004875 C15.627952,13.2866837 14.7550206,13 14.4231449,13 L9.5769691,13 Z",fillRule:"evenodd"}));var iu={"header-container":"index-module_header-container__lxbI8","fluid-container":"index-module_fluid-container__3n68n","header-link":"index-module_header-link__pcEnw",visible:"index-module_visible__5uywn","header-icon":"index-module_header-icon__W6am6","link-title":"index-module_link-title__mnAgF",active:"index-module_active__3IQoN","fluid-column":"index-module_fluid-column__xe0jo","badge-container":"index-module_badge-container__QL6Zy","tooltip-container":"index-module_tooltip-container__h52Uo"};let ic=e=>r.createElement("div",{className:iu["fluid-column"]},e.children),id=e=>{let{active:t,href:i,onClick:n,title:o,children:a}=e,s=iu.active;return r.createElement(t1,{className:f()(iu["header-link"],{[s]:t}),href:t?"#":i,onClick:n||(e=>{t&&(e.preventDefault(),window.scroll({top:0,behavior:"smooth"}))})},r.createElement("div",{className:iu["header-icon"]},a),r.createElement("p",{className:iu["link-title"]},o))};class ip extends r.Component{state={visible:!0,isLogged:void 0};#e={offsetY:0,threshold:0,prevDirection:""};constructor(e){super(e)}#t=()=>{let e=window.scrollY,{offsetY:t,prevDirection:i}=this.#e,r=t>e?"up":"down";if(!e||e<45){this.props.headerVisibilityCallback?.(!0),this.setState({visible:!0});return}return(("up"===r&&"up"===i||"down"===r&&"down"===i)&&++this.#e.threshold,r!==i&&(this.#e.threshold=0),this.#e.offsetY=e,this.#e.prevDirection=r,this.#e.threshold>3&&"up"===r)?(this.props.headerVisibilityCallback?.(!0),this.setState({visible:!0,isLogged:this.state.isLogged})):(this.props.headerVisibilityCallback?.(!1),this.setState({visible:!1,isLogged:this.state.isLogged}))};componentDidMount(){window.addEventListener("scroll",this.#t,{passive:!0}),this.setState({visible:this.state.visible,isLogged:!!this.props.user?.logged})}componentDidUpdate(e){e.user?.logged!==this.props.user?.logged&&this.setState({visible:this.state.visible,isLogged:!!this.props.user?.logged})}componentWillUnmount(){window.removeEventListener("scroll",this.#t)}render(){let{section:e,user:t,onUserTap:i,onUserTooltipTap:n,urlPrefixes:o,unreadMessages:a,unreadBanners:s,tooltipEnabled:l=!1,addAdLink:u,pulseInstance:c}=this.props,{name:d}=t,{visible:p,isLogged:h}=this.state;return r.createElement("div",{className:f()(iu["header-container"],{[iu.visible]:p})},r.createElement(ie,{placement:e??"",pulseInstance:c,assetsBase:o.assetsBase}),r.createElement("div",{className:iu["fluid-container"]},r.createElement(ic,null,r.createElement(id,{href:o.baseURL,active:"home"===e,title:"Home"},r.createElement(io,null))),r.createElement(ic,null,r.createElement(id,{href:`${o.baseURL}/annunci-italia/vendita/usato`,active:"listing"===e,title:"Cerca"},r.createElement(ii,null))),r.createElement(ic,null,r.createElement(id,{href:u,active:"ad-insertion-homepage"===e,title:"Vendi",onClick:()=>{this.props.onClickHandlers?.adButton?.()}},r.createElement(ir,null))),r.createElement(ic,null,r.createElement(id,{href:`${o.reservedArea}/messaggi`,active:"messages"===e,title:"Messaggi"},r.createElement(it,null)),a>0&&r.createElement("div",{className:iu["badge-container"]},r.createElement(t6,{count:a,mini:!0}))),r.createElement(ic,null,r.createElement(id,{onClick:i,active:"reservedarea"===e,title:void 0===h?"":h?d:"Entra"},void 0===h?null:h?r.createElement(h||l?is:ia,null):r.createElement(il,null),"listing"===e&&p&&!h&&l?r.createElement("div",{className:iu["tooltip-container"],onClick:n,onKeyDown:n,role:"button",tabIndex:0},r.createElement(t5,null)):null),s&&r.createElement("div",{className:iu["badge-container"]},r.createElement(t6,{count:1,mini:!0})))))}}let ih=()=>r.createElement("svg",{width:"24",height:"25",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M22 12.5c0 5.523-4.477 10-10 10s-10-4.477-10-10 4.477-10 10-10 10 4.477 10 10ZM6.707 18.499A7.97 7.97 0 0 0 12 20.5a7.97 7.97 0 0 0 5.293-2.001 5.503 5.503 0 0 0-10.586 0Zm-1.476-1.733a8 8 0 1 1 13.538 0 7.518 7.518 0 0 0-3.756-3.635 4 4 0 1 0-6.026 0 7.518 7.518 0 0 0-3.756 3.634ZM10 10.5a2 2 0 1 0 4 0 2 2 0 0 0-4 0Z",fill:"#717e8f"})),ig=()=>r.createElement("svg",{width:"24",height:"25",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m12.216 4.524.14.042 9 3.428.076.033.144.084.103.083.052.052.09.112.077.13.038.087.033.106.025.141.006.107v9.142a1 1 0 0 1-.532.884l-.112.05-9.04 3.444-.184.042-.152.01-.112-.01-.113-.021-.111-.035-9-3.43a1 1 0 0 1-.636-.81L2 18.07V8.88l.006-.059L2 8.93l.002-.063.027-.176.037-.117.047-.107.059-.098.079-.102.114-.11.1-.072.112-.062.103-.042 8.964-3.414a1 1 0 0 1 .457-.06l.115.018ZM20 17.38v-7.058l-.666.238-.567.21c-.263.099-.511.195-.74.288l-.362.15a17.81 17.81 0 0 0-.166.07L17.5 13.5a1 1 0 0 1-1.993.117L15.5 13.5v-1.407l-2.5.952v7.004l7-2.668ZM4 10.379v7.003l7 2.667v-7.003l-7-2.667Zm3.5-2.096-1.692.645L12 11.287l1.691-.644L7.5 8.283Zm4.499-1.714-1.691.644 6.147 2.343.388-.171c.137-.059.282-.119.434-.18l.25-.1.56-.216-6.088-2.32Z",fill:"#717e8f"})),im=()=>r.createElement("svg",{width:"24",height:"25",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5 2.5h14a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-16a2 2 0 0 1 2-2Zm0 2v16h14v-16H5Zm2 1h10a1 1 0 0 1 1 1v5a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1v-5a1 1 0 0 1 1-1Zm1 2v3h8v-3H8Zm-2 7a1 1 0 0 1 1-1h10a1 1 0 1 1 0 2H7a1 1 0 0 1-1-1Zm1 2a1 1 0 1 0 0 2h8a1 1 0 1 0 0-2H7Z",fill:"#717e8f"})),iE=()=>r.createElement("svg",{width:"24",height:"25",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14 12.5a2 2 0 1 0-4 0 2 2 0 0 0 4 0Zm2 0a4 4 0 1 1-8 0 4 4 0 0 1 8 0Zm3.502 5.609 1.486-2.47-2.103-1.168a6.689 6.689 0 0 0 .304-2.923 7.011 7.011 0 0 0-.3-1.372L21 8.893l-1.467-2.325-2.1 1.285a6.802 6.802 0 0 0-1.007-.903c-.44-.311-.851-.575-1.36-.785-.2-.082-.755-.328-1.209-.403V3.5h-3.628v2.262c-.453.094-.823.21-1.25.387-.51.21-.873.458-1.313.77-.377.268-.737.539-1.052.87L4.49 6.569 3 8.893l2.111 1.283c-.148.43-.247.995-.3 1.435a6.53 6.53 0 0 0 .301 2.875l-2.108 1.16L4.48 18.11l2.1-1.16c.315.332.633.635 1.011.902.44.312.881.576 1.39.786.428.176.793.314 1.246.407V21.5h3.628v-2.46c.605-.125 1.003-.32 1.204-.403.509-.21.84-.474 1.28-.785a7.09 7.09 0 0 0 1.045-.903l2.117 1.16Zm-2.006 1.374c.01-.007-.37.266-.49.348a6.104 6.104 0 0 1-1.15.64V21.5a2 2 0 0 1-2 2h-3.628a2 2 0 0 1-2-2v-1.01a8.872 8.872 0 0 1-1.925-1.103l-.854.473a2 2 0 0 1-2.683-.722L1.29 16.676a2 2 0 0 1 .75-2.781l.792-.436a8.504 8.504 0 0 1 .023-2.314l-.893-.543a2 2 0 0 1-.645-2.79l1.492-2.324a2 2 0 0 1 2.682-.653l.914.527.105-.075c.689-.488 1.095-.735 1.707-.987.004-.002.012-.8.012-.8a2 2 0 0 1 2-2h3.628a2 2 0 0 1 2 2v.828c.602.25 1.095.544 1.726.99l.073.054.832-.51a2 2 0 0 1 2.736.638l1.468 2.325a2 2 0 0 1-.652 2.777l-.886.538.022.167a8.687 8.687 0 0 1-.003 2.085c-.002.019.787.499.787.499a2 2 0 0 1 .743 2.779l-1.486 2.47a2 2 0 0 1-2.675.723l-.893-.49c-.05.037-.1.074-.152.11Z",fill:"#717e8f"}),r.createElement("mask",{id:"a",maskUnits:"userSpaceOnUse",x:"0",y:"1",width:"23",height:"23"},r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14 12.5a2 2 0 1 0-4 0 2 2 0 0 0 4 0Zm2 0a4 4 0 1 1-8 0 4 4 0 0 1 8 0Zm3.502 5.609 1.486-2.47-2.103-1.168a6.689 6.689 0 0 0 .304-2.923 7.011 7.011 0 0 0-.3-1.372L21 8.893l-1.467-2.325-2.1 1.285a6.802 6.802 0 0 0-1.007-.903c-.44-.311-.851-.575-1.36-.785-.2-.082-.755-.328-1.209-.403V3.5h-3.628v2.262c-.453.094-.823.21-1.25.387-.51.21-.873.458-1.313.77-.377.268-.737.539-1.052.87L4.49 6.569 3 8.893l2.111 1.283c-.148.43-.247.995-.3 1.435a6.53 6.53 0 0 0 .301 2.875l-2.108 1.16L4.48 18.11l2.1-1.16c.315.332.633.635 1.011.902.44.312.881.576 1.39.786.428.176.793.314 1.246.407V21.5h3.628v-2.46c.605-.125 1.003-.32 1.204-.403.509-.21.84-.474 1.28-.785a7.09 7.09 0 0 0 1.045-.903l2.117 1.16Zm-2.006 1.374c.01-.007-.37.266-.49.348a6.104 6.104 0 0 1-1.15.64V21.5a2 2 0 0 1-2 2h-3.628a2 2 0 0 1-2-2v-1.01a8.872 8.872 0 0 1-1.925-1.103l-.854.473a2 2 0 0 1-2.683-.722L1.29 16.676a2 2 0 0 1 .75-2.781l.792-.436a8.504 8.504 0 0 1 .023-2.314l-.893-.543a2 2 0 0 1-.645-2.79l1.492-2.324a2 2 0 0 1 2.682-.653l.914.527.105-.075c.689-.488 1.095-.735 1.707-.987.004-.002.012-.8.012-.8a2 2 0 0 1 2-2h3.628a2 2 0 0 1 2 2v.828c.602.25 1.095.544 1.726.99l.073.054.832-.51a2 2 0 0 1 2.736.638l1.468 2.325a2 2 0 0 1-.652 2.777l-.886.538.022.167a8.687 8.687 0 0 1-.003 2.085c-.002.019.787.499.787.499a2 2 0 0 1 .743 2.779l-1.486 2.47a2 2 0 0 1-2.675.723l-.893-.49c-.05.037-.1.074-.152.11Z",fill:"#fff"}))),i_=()=>r.createElement("svg",{width:"24",height:"25",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16 3.5c3.552 0 6 2.448 6 6 0 4.098-3.212 8.024-9.479 11.853a1 1 0 0 1-1.043 0C5.213 17.523 2 13.598 2 9.5c0-3.552 2.448-6 6-6 1.397 0 2.728.682 4 1.987C13.272 4.182 14.603 3.5 16 3.5Zm4 6c0-2.448-1.552-4-4-4-.981 0-2.058.673-3.22 2.125a1 1 0 0 1-1.56 0C10.057 6.173 8.98 5.5 8 5.5c-2.448 0-4 1.552-4 4 0 3.136 2.619 6.433 8 9.823 5.381-3.39 8-6.687 8-9.823Z",fill:"#717e8f"})),iv=()=>r.createElement("svg",{width:"24",height:"25",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17.5 16.562a6.955 6.955 0 0 1-1.158.536 1 1 0 0 1-.67-1.884A4.996 4.996 0 0 0 19 10.5a5 5 0 0 0-8.727-3.334 1 1 0 0 1-1.49-1.334 7 7 0 0 1 10.823 8.86l3.101 3.1a1 1 0 0 1-1.414 1.415l-3.1-3.1c-.22.164-.452.316-.692.455ZM15 12.388c0-2.106-1.722-3.888-3.824-3.888A3.835 3.835 0 0 0 8.5 9.583 3.835 3.835 0 0 0 5.824 8.5C3.721 8.5 2 10.273 2 12.377c0 2.217 1.16 4.155 3.08 5.885.512.461 1.049.881 1.634 1.294.235.166.706.483.923.63l.113.076a1.298 1.298 0 0 0 1.5 0l.112-.076c.216-.145.689-.464.924-.63a17.491 17.491 0 0 0 1.633-1.294C13.84 16.532 15 14.598 15 12.388Zm-4.42 4.388c-.446.403-.923.775-1.447 1.146-.146.103-.408.28-.633.433-.225-.152-.487-.33-.633-.433a15.447 15.447 0 0 1-1.448-1.146C4.88 15.388 4 13.921 4 12.377c0-1.013.839-1.877 1.824-1.877.791 0 1.483.5 1.73 1.223.308.902 1.584.902 1.892 0a1.822 1.822 0 0 1 1.73-1.223c.982 0 1.824.872 1.824 1.888 0 1.536-.878 3-2.42 4.388Z",fill:"#717e8f"}),r.createElement("mask",{id:"a",maskUnits:"userSpaceOnUse",x:"2",y:"3",width:"21",height:"18"},r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17.5 16.562a6.955 6.955 0 0 1-1.158.536 1 1 0 0 1-.67-1.884A4.996 4.996 0 0 0 19 10.5a5 5 0 0 0-8.727-3.334 1 1 0 0 1-1.49-1.334 7 7 0 0 1 10.823 8.86l3.101 3.1a1 1 0 0 1-1.414 1.415l-3.1-3.1c-.22.164-.452.316-.692.455ZM15 12.388c0-2.106-1.722-3.888-3.824-3.888A3.835 3.835 0 0 0 8.5 9.583 3.835 3.835 0 0 0 5.824 8.5C3.721 8.5 2 10.273 2 12.377c0 2.217 1.16 4.155 3.08 5.885.512.461 1.049.881 1.634 1.294.235.166.706.483.923.63l.113.076a1.298 1.298 0 0 0 1.5 0l.112-.076c.216-.145.689-.464.924-.63a17.491 17.491 0 0 0 1.633-1.294C13.84 16.532 15 14.598 15 12.388Zm-4.42 4.388c-.446.403-.923.775-1.447 1.146-.146.103-.408.28-.633.433-.225-.152-.487-.33-.633-.433a15.447 15.447 0 0 1-1.448-1.146C4.88 15.388 4 13.921 4 12.377c0-1.013.839-1.877 1.824-1.877.791 0 1.483.5 1.73 1.223.308.902 1.584.902 1.892 0a1.822 1.822 0 0 1 1.73-1.223c.982 0 1.824.872 1.824 1.888 0 1.536-.878 3-2.42 4.388Z",fill:"#fff"}))),iy=()=>r.createElement("svg",{width:"24",height:"24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6 19H5a3 3 0 0 1-3-3V8a3 3 0 0 1 3-3h14a3 3 0 0 1 3 3v8a3 3 0 0 1-3 3h-7.667L9.2 20.6A2 2 0 0 1 6 19Zm13-2a1 1 0 0 0 1-1V8a1 1 0 0 0-1-1H5a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h3v2l2.667-2H19ZM8 13a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm5-1a1 1 0 1 1-2 0 1 1 0 0 1 2 0Zm3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z",fill:"#717e8f"}));function ib(e,t){t.queueEvent({type:"Logout",object:{type:"Account",id:`sdrn:subito:user:${e}`}})}var iI={"menu-list":"index-module_menu-list__ZiPDz",item:"index-module_item__vvcgL","item-link":"index-module_item-link__deMmy",logout:"index-module_logout__YKhaV","with-notice":"index-module_with-notice__nfq-c"};let iO=(e,t,i,o,a,s=[])=>[{href:`${e.reservedArea}/transazioni/lista`,label:"I tuoi ordini",icon:r.createElement(ig,null),disabled:!1,showNotice:s.includes("orders")},{href:`${e.baseURL}/utente/${t}`,label:"Il tuo profilo",icon:r.createElement(ih,null),disabled:i&&!o,showNotice:s.includes("profile")},{href:`${e.reservedArea}/annunci`,label:"I tuoi annunci",icon:r.createElement(im,null),disabled:!1,showNotice:s.includes("manageads")},{href:`${e.reservedArea}/messaggi${i?"":"?from=dropdown"}`,label:"Messaggi",icon:r.createElement(iy,null),disabled:i,showNotice:s.includes("messages")},{href:`${e.reservedArea}/preferiti${i?"":"?from=dropdown"}`,label:"Preferiti",icon:r.createElement(i_,null),disabled:!1,showNotice:s.includes("favorites")},{href:`${e.reservedArea}/ricerche${i?"":"?from=dropdown"}`,label:"Ricerche salvate",icon:r.createElement(iv,null),disabled:!1,showNotice:s.includes("searches")},{href:`${e.reservedArea}/impostazioni`,label:"Impostazioni",icon:r.createElement(iE,null),disabled:i&&!o,showNotice:s.includes("settings")},{href:`${e.reservedArea}/logout`,label:"Esci",disabled:i,class:"logout",onClick:()=>(ib(t,a||new n.S),!0),showNotice:!1}],iR=({urlPrefixes:e,isMobile:t,userId:i,isLoggedUser:n,classes:a,pulseInstance:s,notices:l})=>{let u=iO(e,i,t,n,s,l).filter(e=>!e.disabled);return r.createElement("menu",{className:f()(iI["menu-list"],a)},u.map((e,t)=>r.createElement("li",{key:t,className:f()(iI.item)},r.createElement(t1,{href:e.href,onClick:e.onClick,className:f()(iI["item-link"],e.class?iI[e.class]:"",{[iI["with-notice"]]:e.showNotice})},e.icon,r.createElement(o.a,{weight:"Esci"===e.label?"semibold":"book",classes:[iI["item-label"]]},e.label)))))};var iN={"sidebar-container":"index-module_sidebar-container__czSgA","sidebar-right":"index-module_sidebar-right__hvyPB",visible:"index-module_visible__NTId-","sidebar-left":"index-module_sidebar-left__u5y6W","sidebar-header":"index-module_sidebar-header__BQAvP","close-button":"index-module_close-button__1JSPd","sidebar-content":"index-module_sidebar-content__vBHsJ","sidebar-overlay":"index-module_sidebar-overlay__LW4a0","header-text":"index-module_header-text__LOM6i"};function iT({visible:e,from:t,onDismiss:i,children:n,user:o}){let c=iN.visible,d=iN[`sidebar-${t}`],{name:p}=o,h=!!p;return r.createElement("section",{role:"dialog","aria-modal":"true"},r.createElement("div",{className:f()(iN["sidebar-container"],{[c]:e},d)},r.createElement("div",{className:iN["sidebar-header"]},r.createElement(a.ft,{classes:[iN["header-text"]]},h?p:"Accedi"),r.createElement(s.$,{design:"text",icon:r.createElement(l.In,{iconSize:u.lK.SM,name:l.$M.Close}),onClick:i,size:"large",classes:[iN["close-button"]],"aria-label":"Chiudi il men\xf9"})),r.createElement("div",{className:iN["sidebar-content"]},n)),r.createElement("div",{className:f()(iN["sidebar-overlay"],{[c]:e}),onClick:i,"aria-hidden":!0}))}var iA={"mobile-navigation":"index-module_mobile-navigation__YyhV0","visible-sticky-banner":"index-module_visible-sticky-banner__PmyOQ","sidebar-bottom":"index-module_sidebar-bottom__1flbJ","logout-link":"index-module_logout-link__VdwEW","actions-container":"index-module_actions-container__lVLoK",login__btn:"index-module_login__btn__-koW4",signup__copy:"index-module_signup__copy__3Z44Y"};class iD extends r.Component{constructor(e){super(e),this.state={tooltipClicked:!1,isSidebarOpen:!1}}handleSidebarClose=e=>{e&&e.preventDefault(),this.setState({isSidebarOpen:!1})};handleUserTap=e=>{e&&e.preventDefault(),this.setState({isSidebarOpen:!0})};handleUserTooltipTap=()=>{this.setState({tooltipClicked:!0})};renderAccedi(){let e=this.state.tooltipClicked?"?login_tooltip=true":"";return r.createElement("div",{className:iA["actions-container"]},r.createElement(c.v,{href:`${this.props.urlPrefixes.reservedArea}/login_form${e}`,classes:[iA.login__btn]},"Accedi"),r.createElement(t1,{href:`${this.props.urlPrefixes.reservedArea}/form${e}`},r.createElement(o.a,{size:"small",classes:[iA.signup__copy]},"Non hai ancora un account? ",r.createElement("strong",null,"Registrati"))))}trackLogout=()=>{let e=this.props.pulseInstance||new n.S;return ib(this.props.user?.id,e),!0};render(){let{isSidebarOpen:e}=this.state,{user:t,urlPrefixes:i}=this.props;return r.createElement("div",{id:iA["mobile-navigation"],className:f()({[iA["visible-sticky-banner"]]:["home","listing","adview"].includes(this.props.section??"")})},r.createElement(ip,{...this.props,onUserTap:this.handleUserTap,onUserTooltipTap:this.handleUserTooltipTap}),r.createElement(iT,{from:"right",visible:e,onDismiss:this.handleSidebarClose,user:t},r.createElement(iR,{isMobile:!0,urlPrefixes:i,userId:t.id,isLoggedUser:t.logged,pulseInstance:this.props.pulseInstance,notices:this.props.unreadBanners?["manageads"]:[]}),r.createElement("div",{className:iA["sidebar-bottom"]},t.logged?r.createElement(t1,{className:iA["logout-link"],onClick:this.trackLogout,href:`${i.reservedArea}/logout`},r.createElement(o.a,{element:"span",weight:"semibold"},"Esci")):this.renderAccedi())))}}var iS={"user-menu-block":"index-module_user-menu-block__oeFMo","user-menu":"index-module_user-menu__XC7QN","username-block":"index-module_username-block__OTZXs",username:"index-module_username__sD--k","notification-counter-container":"index-module_notification-counter-container__BsK0d","banner-counter-container":"index-module_banner-counter-container__8hEf5","dropdown-menu":"index-module_dropdown-menu__4S31H","icon-arrow":"index-module_icon-arrow__awXZ2"};let iw=({user:e,unreadMessages:t=0,unreadBanners:i,urlPrefixes:n,pulseInstance:a})=>{let{name:s,id:l}=e;return r.createElement("div",{className:iS["user-menu-block"]},r.createElement("div",{className:iS["user-menu"]},t>0&&r.createElement("div",{className:iS["notification-counter-container"]},r.createElement(t6,{count:t,mini:!1})),i&&r.createElement("div",{className:iS["banner-counter-container"]}),r.createElement("div",{className:iS["username-block"]},r.createElement("div",{className:iS.username},r.createElement(o.a,{weight:"semibold",element:"span"},s)),r.createElement("img",{src:`${n.assetsBase}/static/icons/cactus/arrow-down.svg`,width:"16",height:"16",alt:"",className:iS["icon-arrow"],crossOrigin:"anonymous"}))),r.createElement(iR,{isLoggedUser:!0,isMobile:!1,userId:l,urlPrefixes:n,classes:[iS["dropdown-menu"]],pulseInstance:a}))};var iL={"sbt-text-atom":"index-module_sbt-text-atom__suHlD","token-default":"index-module_token-default__55gIE","token-h1":"index-module_token-h1__I4QGu","token-h2":"index-module_token-h2__VIV07","token-h3":"index-module_token-h3__l3SZr","token-h4":"index-module_token-h4__x5-jO","weight-book":"index-module_weight-book__i2Rnn","token-h5":"index-module_token-h5__TAv96","token-h6":"index-module_token-h6__eywJw","token-subheading":"index-module_token-subheading__PeXpN","size-small":"index-module_size-small__XER8i","header-wrapper":"index-module_header-wrapper__DdDr3","top-link-container":"index-module_top-link-container__1kIBU","token-body":"index-module_token-body__Egxtn","weight-semibold":"index-module_weight-semibold__bnZac","token-button":"index-module_token-button__QWm7U","token-caption":"index-module_token-caption__UBZME","token-overline":"index-module_token-overline__o3TvX",header:"index-module_header__r5EmJ","top-menu-container":"index-module_top-menu-container__IpvvE","not-logged":"index-module_not-logged__ovJr4",login:"index-module_login__-lvcn","button-add":"index-module_button-add__pXNeG",button:"index-module_button__wrBiG","btn-add-ad":"index-module_btn-add-ad__56z7X","header-icon-add-ad":"index-module_header-icon-add-ad__tFQDk","theme-redCorporate":"index-module_theme-redCorporate__PNL6C","corporate-logo":"index-module_corporate-logo__HcKpv","theme-blueMotori":"index-module_theme-blueMotori__9YdFB","theme-purpleImmobili":"index-module_theme-purpleImmobili__w-NxD","theme-yellowMarket":"index-module_theme-yellowMarket__uYkHl","theme-greenLavoro":"index-module_theme-greenLavoro__CAA05","motori-logo":"index-module_motori-logo__BSqDO","immobili-logo":"index-module_immobili-logo__--fju","market-logo":"index-module_market-logo__yodsb","lavoro-logo":"index-module_lavoro-logo__rABmF"};let iU=e=>{switch(e){case"adview":return"addetailheader";case"listing":return"listingheader";case"home":return"hpheader";default:return"otherheader"}},iC=({section:e})=>{let t=[{href:`https://www.subito.it/magazine/#?utm_source=sbtclassified&utm_medium=${iU(e)}`,label:"Magazine"},{href:"https://info.subito.it/per-i-privati.htm",label:"Consigli per la vendita"},{href:"https://impresapiu.subito.it/shops?xtfrom=header_menu",label:"Negozi e Aziende"},{href:"https://aziende.subito.it/",label:"Subito per le Aziende"},{href:"https://assistenza.subito.it/hc/it",label:"Assistenza"},{href:"https://areariservata.subito.it/ricerche",label:"Ricerche salvate"},{href:"https://areariservata.subito.it/preferiti",label:"Preferiti"}];return r.createElement("nav",{className:iL["top-link-container"]},r.createElement("ul",null,t.map((e,t)=>r.createElement("li",{key:t},r.createElement(t1,{href:e.href},r.createElement(o.a,{element:"span",size:"small"},e.label))))))},ix=({theme:e="corporate",baseURL:t="",assetsBase:i=""})=>r.createElement(t1,{href:t,title:"Subito.it","aria-label":"Torna alla pagina principale"},r.createElement("img",{src:`${i}/static/logos/${e||"corporate"}.svg`,width:"230",height:"36",alt:"",className:`${e||"corporate"}-logo`,crossOrigin:"anonymous"})),iP=({section:e,reservedArea:t="",tooltipEnabled:i=!1})=>r.createElement("div",{className:iL["not-logged"]},r.createElement(t1,{className:iL.login,href:`${t}/login_form${i?"?login_tooltip=true":""}`},r.createElement(o.a,{weight:"semibold"},"Accedi"),"listing"===e&&i?r.createElement(t5,null):null),r.createElement(t1,{className:iL.signup,href:`${t}/form`},r.createElement(o.a,null,"Registrati"))),iz=()=>r.createElement("svg",{width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg"},r.createElement("path",{d:"M8 5a3 3 0 0 0-3 3v8a3 3 0 0 0 3 3h8a3 3 0 0 0 3-3V8a3 3 0 0 0-3-3H8zm0-2h8a5 5 0 0 1 5 5v8a5 5 0 0 1-5 5H8a5 5 0 0 1-5-5V8a5 5 0 0 1 5-5zm5 8h3a1 1 0 0 1 0 2h-3v3a1 1 0 0 1-2 0v-3H8a1 1 0 0 1 0-2h3V8a1 1 0 0 1 2 0v3z"})),ik=({onClick:e,addAdLink:t})=>{let i=[iL.button,iL.btn_large,iL["btn-add-ad"]].join(" ");return r.createElement("div",{className:iL["button-add"]},r.createElement("a",{href:t,onClick:e},r.createElement("div",{className:i},r.createElement("div",{className:iL["header-icon-add-ad"]},r.createElement(iz,null)),r.createElement(d.C,null,"Inserisci annuncio"))))},iM=({theme:e="corporate",unreadMessages:t=0,unreadBanners:i,urlPrefixes:n,section:o,user:a={id:"",logged:!1,name:""},tooltipEnabled:s=!1,onClickHandlers:l,addAdLink:u,pulseInstance:c})=>{let[d,p]=(0,r.useState)(),{baseURL:f,assetsBase:h,reservedArea:g}=n;return(0,r.useEffect)(()=>{p(a.logged)},[a.logged]),r.createElement("header",{className:iL["header-wrapper"]},r.createElement(ie,{placement:o??"",pulseInstance:c,assetsBase:n.assetsBase}),r.createElement(iC,{section:o}),r.createElement("div",{className:iL.header},r.createElement(ix,{theme:e,baseURL:f,assetsBase:h}),r.createElement("div",{className:iL["top-menu-container"]},!0===d?r.createElement(iw,{user:a,unreadMessages:t,unreadBanners:i,urlPrefixes:n}):null,!1===d?r.createElement(iP,{section:o,reservedArea:g,tooltipEnabled:s}):null),r.createElement(ik,{onClick:()=>l?.adButton?.(),addAdLink:u})))};iM.displayName="Header";let iV=e=>{let{user:t,urlPrefixes:n}=e,o=!!t.name,a={...e,user:{id:t.id,name:t.name,logged:o}},s=function(e,t){let[i,n]=(0,r.useState)(!1),o=async()=>{let e=(0,m.Ri)("manageads.lastSeenBanner");try{let{body:i}=await tW(t.hadesBase,"RESERVEDAREA","MANAGEADS");n(!!(i.banners[0]?.bannerId&&`${i.banners[0].bannerId}`!==e))}catch{}};return(0,r.useEffect)(()=>{e&&o()},[e]),i}(o,n),l=function(e){let[t,n]=(0,r.useState)(0);return(0,r.useEffect)(()=>{if((0,m.Bd)()&&e){let t=`https://${window.location.host}/hades`;i.e(7290).then(i.t.bind(i,57290,23)).then(({default:i})=>{i({baseUrl:`${t}/v1/mcproxy/api`,userId:e,onChange:e=>{n(e)},onError:(e,t)=>{if(e.includes("Unable to parse json")){console.warn(t??"Unable to parse JSON: Response JSON is not valid");return}console.error(t)}})})}},[e]),t}(t.id),u=function(e,t){let[i,n]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{if("listing"===t&&!e)try{let e="true"===sessionStorage.getItem(t3);e||sessionStorage.setItem(t3,"true"),n(e)}catch{console.error("Could not access sessionStorage to check the configuration of the tooltip.")}},[t,e]),!i}(o,e.section),c=e.tooltipEnabled?e.tooltipEnabled:u,d=`${n.baseURL}/vendere/`;return r.createElement(t0.Provider,{value:{onClick:e.onClickHandlers?.onClickItem}},r.createElement(iD,{...a,unreadBanners:s,unreadMessages:l,tooltipEnabled:c,addAdLink:d}),r.createElement(iM,{...a,unreadMessages:l,unreadBanners:s,tooltipEnabled:c,addAdLink:d}))}},33282:(e,t,i)=>{"use strict";i.d(t,{C:()=>o});var r=i(96540),n=i(13608);let o=({element:e="span",size:t="normal",classes:i=[],children:o})=>r.createElement(n.A,{token:"button",weight:"semibold",size:t,renderElement:e,classes:i},o);o.displayName="ButtonText"},22021:(e,t,i)=>{"use strict";i.d(t,{fO:()=>o,ft:()=>s,mq:()=>a});var r=i(96540),n=i(13608);let o=({element:e="h4",classes:t=[],weight:i="semibold",id:o,children:a})=>r.createElement(n.A,{token:"h4",renderElement:e,weight:i,classes:t,id:o},a);o.displayName="Headline4";let a=({element:e="h5",classes:t=[],weight:i="semibold",id:o,children:a})=>r.createElement(n.A,{token:"h5",renderElement:e,weight:i,classes:t,id:o},a);a.displayName="Headline5";let s=({element:e="h6",classes:t=[],weight:i="semibold",id:o,children:a})=>r.createElement(n.A,{token:"h6",renderElement:e,weight:i,classes:t,id:o},a);s.displayName="Headline6"},70204:(e,t,i)=>{"use strict";i.d(t,{v:()=>d});var r=i(46942),n=i.n(r),o=i(67967),a=i.n(o),s=i(96540),l=i(33282);let u=a().bind({link:"index-module_link__nwIkS","button-text":"index-module_button-text__xHoM9",small:"index-module_small__ByROQ",medium:"index-module_medium__4CM9m",large:"index-module_large__FklCc",outline:"index-module_outline__UQSBb",text:"index-module_text__ka0up",solid:"index-module_solid__oARUV","solid-lite":"index-module_solid-lite__BOtaH","outline-white":"index-module_outline-white__6dWgf"}),c={small:"small",medium:"normal",large:"normal"},d=({href:e,design:t="solid",size:i="medium",children:r,rel:o,target:a,onClick:d,classes:p=[],icon:f,iconLeft:h,iconRight:g})=>s.createElement("a",{href:e,rel:o,className:n()(u("link",t,i),...p),target:a,onClick:d},h||f,s.createElement(l.C,{element:"span",size:c[i],classes:[u("button-text")]},r),g);d.displayName="ButtonLink"},84695:(e,t,i)=>{"use strict";i.d(t,{O:()=>f});var r=i(67967),n=i.n(r),o=i(96540),a=i(10799);function s(e,t){let i=(0,o.useRef)(void 0),r=(0,o.useRef)(void 0),n=function(){r.current&&window.clearTimeout(r.current)},a=(0,o.useCallback)((e=t)=>{n(),e&&(r.current=window.setTimeout(function(){i.current?.()},e))},[t]);return(0,o.useEffect)(()=>{i.current=e},[e]),(0,o.useEffect)(()=>(a(t),()=>n()),[t,a]),[n,a]}let l=n().bind(void 0),u=o.forwardRef(({removeAfter:e,children:t,onRemoved:i},r)=>{let[n,a]=(0,o.useState)(!1),[u]=s(()=>{a(!0)},e),[,c]=s(i,0===e?0:e+300);return o.useImperativeHandle(r,()=>({remove:()=>{u(),a(!0),c(300)}})),o.createElement("div",{className:l("fader",n?"hide":"show")},t)});u.displayName="Fader";let c=({variant:e,size:t,children:i,removeAfter:r,onRemoved:n,closeable:s=!1})=>{let l=(0,o.useRef)(null);return o.createElement(u,{ref:l,removeAfter:r,onRemoved:n},o.createElement(a.$,{size:t,variant:e,contentCentered:!0,closeConfiguration:s?{onClick:()=>{l.current?.remove()}}:void 0},i))};c.displayName="NotificationBar";let d=n().bind({notificationContainer:"index-module_notificationContainer__xLNyJ",fixed:"index-module_fixed__aarnv",visible:"index-module_visible__0l4sf",notification:"index-module_notification__mGqHg"});class p{#i;#r;#n;constructor(e,t,i){this.#i=e,this.#r=t,this.#n=i}get message(){return this.#i}get type(){return this.#r}get id(){return this.#n}}class f extends o.Component{state={notifications:[],visible:!1};componentDidUpdate(e,t){let{notifications:i}=this.state;t.notifications.length!==i.length&&this.setState({visible:0!==i.length})}push(e,t){let i=new p(e,t,Math.random()),r=this.state.notifications.slice(0,this.props.max);this.setState({...this.state,notifications:[i,...r]})}render(){let{removeAfter:e,max:t,fixed:i}=this.props,{visible:r}=this.state;return o.createElement("div",{className:d("notificationContainer",{fixed:i,visible:r})},this.state.notifications.slice(0,t).map(t=>o.createElement("div",{key:t.id,className:d("notification")},o.createElement(c,{variant:t.type,size:this.props.size,removeAfter:1e3*e,onRemoved:()=>{this.#o(t.id)}},t.message))))}#o(e){this.setState({...this.state,notifications:this.state.notifications.filter(t=>t.id!==e)})}}},81765:(e,t,i)=>{"use strict";var r=i(73404),n={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function l(e){return r.isMemo(e)?a:s[e.$$typeof]||n}s[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[r.Memo]=a;var u=Object.defineProperty,c=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,p=Object.getOwnPropertyDescriptor,f=Object.getPrototypeOf,h=Object.prototype;e.exports=function e(t,i,r){if("string"!=typeof i){if(h){var n=f(i);n&&n!==h&&e(t,n,r)}var a=c(i);d&&(a=a.concat(d(i)));for(var s=l(t),g=l(i),m=0;m<a.length;++m){var E=a[m];if(!o[E]&&!(r&&r[E])&&!(g&&g[E])&&!(s&&s[E])){var _=p(i,E);try{u(t,E,_)}catch(e){}}}}return t}},3072:(e,t)=>{"use strict";var i="function"==typeof Symbol&&Symbol.for,r=i?Symbol.for("react.element"):60103,n=i?Symbol.for("react.portal"):60106,o=i?Symbol.for("react.fragment"):60107,a=i?Symbol.for("react.strict_mode"):60108,s=i?Symbol.for("react.profiler"):60114,l=i?Symbol.for("react.provider"):60109,u=i?Symbol.for("react.context"):60110,c=i?Symbol.for("react.async_mode"):60111,d=i?Symbol.for("react.concurrent_mode"):60111,p=i?Symbol.for("react.forward_ref"):60112,f=i?Symbol.for("react.suspense"):60113,h=i?Symbol.for("react.suspense_list"):60120,g=i?Symbol.for("react.memo"):60115,m=i?Symbol.for("react.lazy"):60116,E=i?Symbol.for("react.block"):60121,_=i?Symbol.for("react.fundamental"):60117,v=i?Symbol.for("react.responder"):60118,y=i?Symbol.for("react.scope"):60119;function b(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case c:case d:case o:case s:case a:case f:return e;default:switch(e=e&&e.$$typeof){case u:case p:case m:case g:case l:return e;default:return t}}case n:return t}}}function I(e){return b(e)===d}t.AsyncMode=c,t.ConcurrentMode=d,t.ContextConsumer=u,t.ContextProvider=l,t.Element=r,t.ForwardRef=p,t.Fragment=o,t.Lazy=m,t.Memo=g,t.Portal=n,t.Profiler=s,t.StrictMode=a,t.Suspense=f,t.isAsyncMode=function(e){return I(e)||b(e)===c},t.isConcurrentMode=I,t.isContextConsumer=function(e){return b(e)===u},t.isContextProvider=function(e){return b(e)===l},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return b(e)===p},t.isFragment=function(e){return b(e)===o},t.isLazy=function(e){return b(e)===m},t.isMemo=function(e){return b(e)===g},t.isPortal=function(e){return b(e)===n},t.isProfiler=function(e){return b(e)===s},t.isStrictMode=function(e){return b(e)===a},t.isSuspense=function(e){return b(e)===f},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===o||e===d||e===s||e===a||e===f||e===h||"object"==typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===g||e.$$typeof===l||e.$$typeof===u||e.$$typeof===p||e.$$typeof===_||e.$$typeof===v||e.$$typeof===y||e.$$typeof===E)},t.typeOf=b},73404:(e,t,i)=>{"use strict";e.exports=i(3072)},25543:function(e,t){var i,r;r=function(){var e=i;e.Integer={type:"integer"};var t={String:String,Boolean:Boolean,Number:Number,Object:Object,Array:Array,Date:Date};function i(e,t){return i(e,t,{changing:!1})}e.validate=i,e.checkPropertyChange=function(e,t,r){return i(e,t,{changing:r||"property"})};var i=e._validate=function(e,i,r){r||(r={});var n=r.changing;function o(e){return e.type||t[e.name]==e&&e.name.toLowerCase()}var a=[];function s(e,t,i,l){var u;function c(e){a.push({property:i,message:e})}if(i+=i?"number"==typeof l?"["+l+"]":void 0===l?"":"."+l:l,("object"!=typeof t||t instanceof Array)&&(i||"function"!=typeof t)&&!(t&&o(t)))return"function"==typeof t?e instanceof t||c("is not an instance of the class/constructor "+t.name):t&&c("Invalid schema/property definition "+t),null;function d(e,t){if(e){if("string"==typeof e&&"any"!=e&&("null"==e?null!==t:typeof t!=e)&&!(t instanceof Array&&"array"==e)&&!(t instanceof Date&&"date"==e)&&!("integer"==e&&t%1==0))return[{property:i,message:t+" - "+typeof t+" value found, but a "+e+" is required"}];if(e instanceof Array){for(var r=[],n=0;n<e.length&&(r=d(e[n],t)).length;n++);if(r.length)return r}else if("object"==typeof e){var o=a;a=[],s(t,e,i);var l=a;return a=o,l}}return[]}if(n&&t.readonly&&c("is a readonly field, it can not be changed"),t.extends&&s(e,t.extends,i,l),void 0===e)t.required&&c("is missing and it is required");else if(a=a.concat(d(o(t),e)),t.disallow&&!d(t.disallow,e).length&&c(" disallowed value was matched"),null!==e){if(e instanceof Array){if(t.items){var p=t.items instanceof Array,f=t.items;for(l=0,u=e.length;l<u;l+=1)p&&(f=t.items[l]),r.coerce&&(e[l]=r.coerce(e[l],f)),a.concat(s(e[l],f,i,l))}t.minItems&&e.length<t.minItems&&c("There must be a minimum of "+t.minItems+" in the array"),t.maxItems&&e.length>t.maxItems&&c("There must be a maximum of "+t.maxItems+" in the array")}else(t.properties||t.additionalProperties)&&a.concat(function(e,t,i,o){if("object"==typeof t){for(var l in("object"!=typeof e||e instanceof Array)&&a.push({property:i,message:"an object is required"}),t)if(t.hasOwnProperty(l)&&"__proto__"!=l&&"constructor"!=l){var u=e.hasOwnProperty(l)?e[l]:void 0;if(void 0===u&&r.existingOnly)continue;var c=t[l];void 0===u&&c.default&&(u=e[l]=c.default),r.coerce&&l in e&&(u=e[l]=r.coerce(u,c)),s(u,c,i,l)}}for(l in e){if(e.hasOwnProperty(l)&&!("_"==l.charAt(0)&&"_"==l.charAt(1))&&t&&!t[l]&&!1===o){if(r.filter){delete e[l];continue}a.push({property:i,message:"The property "+l+" is not defined in the schema and the schema does not allow additional properties"})}var d=t&&t[l]&&t[l].requires;!d||d in e||a.push({property:i,message:"the presence of the property "+l+" requires that "+d+" also be present"}),u=e[l],!o||t&&"object"==typeof t&&l in t||(r.coerce&&(u=e[l]=r.coerce(u,o)),s(u,o,i,l)),!n&&u&&u.$schema&&(a=a.concat(s(u,u.$schema,i,l)))}return a}(e,t.properties,i,t.additionalProperties));if(t.pattern&&"string"==typeof e&&!e.match(t.pattern)&&c("does not match the regex pattern "+t.pattern),t.maxLength&&"string"==typeof e&&e.length>t.maxLength&&c("may only be "+t.maxLength+" characters long"),t.minLength&&"string"==typeof e&&e.length<t.minLength&&c("must be at least "+t.minLength+" characters long"),void 0!==t.minimum&&typeof e==typeof t.minimum&&t.minimum>e&&c("must have a minimum value of "+t.minimum),void 0!==t.maximum&&typeof e==typeof t.maximum&&t.maximum<e&&c("must have a maximum value of "+t.maximum),t.enum){var h,g=t.enum;u=g.length;for(var m=0;m<u;m++)if(g[m]===e){h=1;break}h||c("does not have a value in the enumeration "+g.join(", "))}"number"==typeof t.maxDecimal&&e.toString().match(RegExp("\\.[0-9]{"+(t.maxDecimal+1)+",}"))&&c("may only have "+t.maxDecimal+" digits of decimal places")}return null}return i&&s(e,i,"",n||""),!n&&e&&e.$schema&&s(e,e.$schema,"",""),{valid:!a.length,errors:a}};return e.mustBeValid=function(e){if(!e.valid)throw TypeError(e.errors.map(function(e){return"for property "+e.property+": "+e.message}).join(", \n"))},e},void 0!==(i=(function(){return r()}).apply(t,[]))&&(e.exports=i)},88005:e=>{!function(){let t=e=>new TextEncoder().encode(e);function i(e,i){let r,n,o,a,s,l;for("string"==typeof e&&(e=t(e)),r=3&e.length,n=e.length-r,o=i,l=0;l<n;)s=255&e[l]|(255&e[++l])<<8|(255&e[++l])<<16|(255&e[++l])<<24,++l,o^=s=(65535&(s=(s=(65535&s)*0xcc9e2d51+(((s>>>16)*0xcc9e2d51&65535)<<16)&0xffffffff)<<15|s>>>17))*0x1b873593+(((s>>>16)*0x1b873593&65535)<<16)&0xffffffff,o=(65535&(a=(65535&(o=o<<13|o>>>19))*5+(((o>>>16)*5&65535)<<16)&0xffffffff))+27492+(((a>>>16)+58964&65535)<<16);switch(s=0,r){case 3:s^=(255&e[l+2])<<16;case 2:s^=(255&e[l+1])<<8;case 1:s^=255&e[l],o^=s=(65535&(s=(s=(65535&s)*0xcc9e2d51+(((s>>>16)*0xcc9e2d51&65535)<<16)&0xffffffff)<<15|s>>>17))*0x1b873593+(((s>>>16)*0x1b873593&65535)<<16)&0xffffffff}return o^=e.length,o^=o>>>16,o=(65535&o)*0x85ebca6b+(((o>>>16)*0x85ebca6b&65535)<<16)&0xffffffff,o^=o>>>13,o=(65535&o)*0xc2b2ae35+(((o>>>16)*0xc2b2ae35&65535)<<16)&0xffffffff,(o^=o>>>16)>>>0}i.v2=function(e,i){"string"==typeof e&&(e=t(e));let r=e.length,n=i^r,o=0,a;for(;r>=4;)a=(65535&(a=255&e[o]|(255&e[++o])<<8|(255&e[++o])<<16|(255&e[++o])<<24))*0x5bd1e995+(((a>>>16)*0x5bd1e995&65535)<<16),a^=a>>>24,n=(65535&n)*0x5bd1e995+(((n>>>16)*0x5bd1e995&65535)<<16)^(a=(65535&a)*0x5bd1e995+(((a>>>16)*0x5bd1e995&65535)<<16)),r-=4,++o;switch(r){case 3:n^=(255&e[o+2])<<16;case 2:n^=(255&e[o+1])<<8;case 1:n^=255&e[o],n=(65535&n)*0x5bd1e995+(((n>>>16)*0x5bd1e995&65535)<<16)}return n^=n>>>13,n=(65535&n)*0x5bd1e995+(((n>>>16)*0x5bd1e995&65535)<<16),(n^=n>>>15)>>>0},i.v3=i,e.exports=i}()},54851:function(e,t,i){var r;!function(n,o){"use strict";var a="function",s="undefined",l="object",u="string",c="major",d="model",p="name",f="type",h="vendor",g="version",m="architecture",E="console",_="mobile",v="tablet",y="smarttv",b="wearable",I="embedded",O="Amazon",R="Apple",N="ASUS",T="BlackBerry",A="Browser",D="Chrome",S="Firefox",w="Google",L="Huawei",U="Microsoft",C="Motorola",x="Opera",P="Samsung",z="Sharp",k="Sony",M="Xiaomi",V="Zebra",F="Facebook",j="Chromium OS",B="Mac OS",G=" Browser",K=function(e,t){var i={};for(var r in e)t[r]&&t[r].length%2==0?i[r]=t[r].concat(e[r]):i[r]=e[r];return i},q=function(e){for(var t={},i=0;i<e.length;i++)t[e[i].toUpperCase()]=e[i];return t},H=function(e,t){return typeof e===u&&-1!==Y(t).indexOf(Y(e))},Y=function(e){return e.toLowerCase()},$=function(e,t){if(typeof e===u)return e=e.replace(/^\s\s*/,""),typeof t===s?e:e.substring(0,500)},Z=function(e,t){for(var i,r,n,s,u,c,d=0;d<t.length&&!u;){var p=t[d],f=t[d+1];for(i=r=0;i<p.length&&!u&&p[i];)if(u=p[i++].exec(e))for(n=0;n<f.length;n++)c=u[++r],typeof(s=f[n])===l&&s.length>0?2===s.length?typeof s[1]==a?this[s[0]]=s[1].call(this,c):this[s[0]]=s[1]:3===s.length?typeof s[1]!==a||s[1].exec&&s[1].test?this[s[0]]=c?c.replace(s[1],s[2]):void 0:this[s[0]]=c?s[1].call(this,c,s[2]):void 0:4===s.length&&(this[s[0]]=c?s[3].call(this,c.replace(s[1],s[2])):void 0):this[s]=c||o;d+=2}},X=function(e,t){for(var i in t)if(typeof t[i]===l&&t[i].length>0){for(var r=0;r<t[i].length;r++)if(H(t[i][r],e))return"?"===i?o:i}else if(H(t[i],e))return"?"===i?o:i;return t.hasOwnProperty("*")?t["*"]:e},W={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},J={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[g,[p,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[g,[p,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[p,g],[/opios[\/ ]+([\w\.]+)/i],[g,[p,x+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[g,[p,x+" GX"]],[/\bopr\/([\w\.]+)/i],[g,[p,x]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[g,[p,"Baidu"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim)\s?(?:browser)?[\/ ]?([\w\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[p,g],[/quark(?:pc)?\/([-\w\.]+)/i],[g,[p,"Quark"]],[/\bddg\/([\w\.]+)/i],[g,[p,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[g,[p,"UC"+A]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[g,[p,"WeChat"]],[/konqueror\/([\w\.]+)/i],[g,[p,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[g,[p,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[g,[p,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[g,[p,"Smart Lenovo "+A]],[/(avast|avg)\/([\w\.]+)/i],[[p,/(.+)/,"$1 Secure "+A],g],[/\bfocus\/([\w\.]+)/i],[g,[p,S+" Focus"]],[/\bopt\/([\w\.]+)/i],[g,[p,x+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[g,[p,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[g,[p,"Dolphin"]],[/coast\/([\w\.]+)/i],[g,[p,x+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[g,[p,"MIUI "+A]],[/fxios\/([-\w\.]+)/i],[g,[p,S]],[/\bqihu|(qi?ho?o?|360)browser/i],[[p,"360"+G]],[/\b(qq)\/([\w\.]+)/i],[[p,/(.+)/,"$1Browser"],g],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[p,/(.+)/,"$1"+G],g],[/samsungbrowser\/([\w\.]+)/i],[g,[p,P+" Internet"]],[/(comodo_dragon)\/([\w\.]+)/i],[[p,/_/g," "],g],[/metasr[\/ ]?([\d\.]+)/i],[g,[p,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[p,"Sogou Mobile"],g],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345Explorer)[\/ ]?([\w\.]+)/i],[p,g],[/(lbbrowser|rekonq)/i,/\[(linkedin)app\]/i],[p],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[p,F],g],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[p,g],[/\bgsa\/([\w\.]+) .*safari\//i],[g,[p,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[g,[p,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[g,[p,D+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[p,D+" WebView"],g],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[g,[p,"Android "+A]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[p,g],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[g,[p,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[g,p],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[p,[g,X,{"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[p,g],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[p,"Netscape"],g],[/(wolvic)\/([\w\.]+)/i],[p,g],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[g,[p,S+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[p,[g,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[p,[g,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[m,"amd64"]],[/(ia32(?=;))/i],[[m,Y]],[/((?:i[346]|x)86)[;\)]/i],[[m,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[m,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[m,"armhf"]],[/windows (ce|mobile); ppc;/i],[[m,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[m,/ower/,"",Y]],[/(sun4\w)[;\)]/i],[[m,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[m,Y]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[d,[h,P],[f,v]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr])[-\w]+)/i,/sec-(sgh\w+)/i],[d,[h,P],[f,_]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[d,[h,R],[f,_]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[d,[h,R],[f,v]],[/(macintosh);/i],[d,[h,R]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[d,[h,z],[f,_]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[d,[h,L],[f,v]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[d,[h,L],[f,_]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\))/i],[[d,/_/g," "],[h,M],[f,_]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[d,/_/g," "],[h,M],[f,v]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[d,[h,"OPPO"],[f,_]],[/\b(opd2\d{3}a?) bui/i],[d,[h,"OPPO"],[f,v]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[d,[h,"Vivo"],[f,_]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[d,[h,"Realme"],[f,_]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[d,[h,C],[f,_]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[d,[h,C],[f,v]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[d,[h,"LG"],[f,v]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[d,[h,"LG"],[f,_]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[d,[h,"Lenovo"],[f,v]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[d,/_/g," "],[h,"Nokia"],[f,_]],[/(pixel c)\b/i],[d,[h,w],[f,v]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[d,[h,w],[f,_]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[d,[h,k],[f,_]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[d,"Xperia Tablet"],[h,k],[f,v]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[d,[h,"OnePlus"],[f,_]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[d,[h,O],[f,v]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[d,/(.+)/g,"Fire Phone $1"],[h,O],[f,_]],[/(playbook);[-\w\),; ]+(rim)/i],[d,h,[f,v]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[d,[h,T],[f,_]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[d,[h,N],[f,v]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[d,[h,N],[f,_]],[/(nexus 9)/i],[d,[h,"HTC"],[f,v]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[h,[d,/_/g," "],[f,_]],[/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])\w*(\)| bui)/i],[d,[h,"TCL"],[f,v]],[/(itel) ((\w+))/i],[[h,Y],d,[f,X,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[d,[h,"Acer"],[f,v]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[d,[h,"Meizu"],[f,_]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[d,[h,"Ulefone"],[f,_]],[/droid.+; (a(?:015|06[35]|142p?))/i],[d,[h,"Nothing"],[f,_]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[h,d,[f,_]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[h,d,[f,v]],[/(surface duo)/i],[d,[h,U],[f,v]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[d,[h,"Fairphone"],[f,_]],[/(u304aa)/i],[d,[h,"AT&T"],[f,_]],[/\bsie-(\w*)/i],[d,[h,"Siemens"],[f,_]],[/\b(rct\w+) b/i],[d,[h,"RCA"],[f,v]],[/\b(venue[\d ]{2,7}) b/i],[d,[h,"Dell"],[f,v]],[/\b(q(?:mv|ta)\w+) b/i],[d,[h,"Verizon"],[f,v]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[d,[h,"Barnes & Noble"],[f,v]],[/\b(tm\d{3}\w+) b/i],[d,[h,"NuVision"],[f,v]],[/\b(k88) b/i],[d,[h,"ZTE"],[f,v]],[/\b(nx\d{3}j) b/i],[d,[h,"ZTE"],[f,_]],[/\b(gen\d{3}) b.+49h/i],[d,[h,"Swiss"],[f,_]],[/\b(zur\d{3}) b/i],[d,[h,"Swiss"],[f,v]],[/\b((zeki)?tb.*\b) b/i],[d,[h,"Zeki"],[f,v]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[h,"Dragon Touch"],d,[f,v]],[/\b(ns-?\w{0,9}) b/i],[d,[h,"Insignia"],[f,v]],[/\b((nxa|next)-?\w{0,9}) b/i],[d,[h,"NextBook"],[f,v]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[h,"Voice"],d,[f,_]],[/\b(lvtel\-)?(v1[12]) b/i],[[h,"LvTel"],d,[f,_]],[/\b(ph-1) /i],[d,[h,"Essential"],[f,_]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[d,[h,"Envizen"],[f,v]],[/\b(trio[-\w\. ]+) b/i],[d,[h,"MachSpeed"],[f,v]],[/\btu_(1491) b/i],[d,[h,"Rotor"],[f,v]],[/(shield[\w ]+) b/i],[d,[h,"Nvidia"],[f,v]],[/(sprint) (\w+)/i],[h,d,[f,_]],[/(kin\.[onetw]{3})/i],[[d,/\./g," "],[h,U],[f,_]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[d,[h,V],[f,v]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[d,[h,V],[f,_]],[/smart-tv.+(samsung)/i],[h,[f,y]],[/hbbtv.+maple;(\d+)/i],[[d,/^/,"SmartTV"],[h,P],[f,y]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[h,"LG"],[f,y]],[/(apple) ?tv/i],[h,[d,R+" TV"],[f,y]],[/crkey/i],[[d,D+"cast"],[h,w],[f,y]],[/droid.+aft(\w+)( bui|\))/i],[d,[h,O],[f,y]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[d,[h,z],[f,y]],[/(bravia[\w ]+)( bui|\))/i],[d,[h,k],[f,y]],[/(mitv-\w{5}) bui/i],[d,[h,M],[f,y]],[/Hbbtv.*(technisat) (.*);/i],[h,d,[f,y]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[h,$],[d,$],[f,y]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[f,y]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[h,d,[f,E]],[/droid.+; (shield) bui/i],[d,[h,"Nvidia"],[f,E]],[/(playstation [345portablevi]+)/i],[d,[h,k],[f,E]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[d,[h,U],[f,E]],[/\b(sm-[lr]\d\d[05][fnuw]?s?)\b/i],[d,[h,P],[f,b]],[/((pebble))app/i],[h,d,[f,b]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[d,[h,R],[f,b]],[/droid.+; (glass) \d/i],[d,[h,w],[f,b]],[/droid.+; (wt63?0{2,3})\)/i],[d,[h,V],[f,b]],[/(quest( \d| pro)?)/i],[d,[h,F],[f,b]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[h,[f,I]],[/(aeobc)\b/i],[d,[h,O],[f,I]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[d,[f,_]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[d,[f,v]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[f,v]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[f,_]],[/(android[-\w\. ]{0,9});.+buil/i],[d,[h,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[g,[p,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[g,[p,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[p,g],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[g,p]],os:[[/microsoft (windows) (vista|xp)/i],[p,g],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[p,[g,X,W]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[g,X,W],[p,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[g,/_/g,"."],[p,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[p,B],[g,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[g,p],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[p,g],[/\(bb(10);/i],[g,[p,T]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[g,[p,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[g,[p,S+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[g,[p,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[g,[p,"watchOS"]],[/crkey\/([\d\.]+)/i],[g,[p,D+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[p,j],g],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[p,g],[/(sunos) ?([\w\.\d]*)/i],[[p,"Solaris"],g],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[p,g]]},Q=function(e,t){if(typeof e===l&&(t=e,e=o),!(this instanceof Q))return new Q(e,t).getResult();var i=typeof n!==s&&n.navigator?n.navigator:o,r=e||(i&&i.userAgent?i.userAgent:""),E=i&&i.userAgentData?i.userAgentData:o,y=t?K(J,t):J,b=i&&i.userAgent==r;return this.getBrowser=function(){var e,t={};return t[p]=o,t[g]=o,Z.call(t,r,y.browser),t[c]=typeof(e=t[g])===u?e.replace(/[^\d\.]/g,"").split(".")[0]:o,b&&i&&i.brave&&typeof i.brave.isBrave==a&&(t[p]="Brave"),t},this.getCPU=function(){var e={};return e[m]=o,Z.call(e,r,y.cpu),e},this.getDevice=function(){var e={};return e[h]=o,e[d]=o,e[f]=o,Z.call(e,r,y.device),b&&!e[f]&&E&&E.mobile&&(e[f]=_),b&&"Macintosh"==e[d]&&i&&typeof i.standalone!==s&&i.maxTouchPoints&&i.maxTouchPoints>2&&(e[d]="iPad",e[f]=v),e},this.getEngine=function(){var e={};return e[p]=o,e[g]=o,Z.call(e,r,y.engine),e},this.getOS=function(){var e={};return e[p]=o,e[g]=o,Z.call(e,r,y.os),b&&!e[p]&&E&&E.platform&&"Unknown"!=E.platform&&(e[p]=E.platform.replace(/chrome os/i,j).replace(/macos/i,B)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return r},this.setUA=function(e){return r=typeof e===u&&e.length>500?$(e,500):e,this},this.setUA(r),this};Q.VERSION="1.0.39",Q.BROWSER=q([p,g,c]),Q.CPU=q([m]),Q.DEVICE=q([d,h,f,E,_,y,v,b,I]),Q.ENGINE=Q.OS=q([p,g]),typeof t!==s?(e.exports&&(t=e.exports=Q),t.UAParser=Q):i.amdO?o!==(r=(function(){return Q}).call(t,i,t,e))&&(e.exports=r):typeof n!==s&&(n.UAParser=Q);var ee=typeof n!==s&&(n.jQuery||n.Zepto);if(ee&&!ee.ua){var et=new Q;ee.ua=et.getResult(),ee.ua.get=function(){return et.getUA()},ee.ua.set=function(e){et.setUA(e);var t=et.getResult();for(var i in t)ee.ua[i]=t[i]}}}("object"==typeof window?window:this)},22831:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"NIL",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(t,"v1",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"v3",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"v4",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"v5",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"validate",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"version",{enumerable:!0,get:function(){return l.default}});var r=p(i(13518)),n=p(i(14948)),o=p(i(45073)),a=p(i(77186)),s=p(i(14808)),l=p(i(7775)),u=p(i(37037)),c=p(i(49910)),d=p(i(96792));function p(e){return e&&e.__esModule?e:{default:e}}},44692:(e,t)=>{"use strict";function i(e){return(e+64>>>9<<4)+14+1}function r(e,t){let i=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(i>>16)<<16|65535&i}function n(e,t,i,n,o,a){var s;return r((s=r(r(t,e),r(n,a)))<<o|s>>>32-o,i)}function o(e,t,i,r,o,a,s){return n(t&i|~t&r,e,t,o,a,s)}function a(e,t,i,r,o,a,s){return n(t&r|i&~r,e,t,o,a,s)}function s(e,t,i,r,o,a,s){return n(t^i^r,e,t,o,a,s)}function l(e,t,i,r,o,a,s){return n(i^(t|~r),e,t,o,a,s)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default=function(e){if("string"==typeof e){let t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let i=0;i<t.length;++i)e[i]=t.charCodeAt(i)}return function(e){let t=[],i=32*e.length,r="0123456789abcdef";for(let n=0;n<i;n+=8){let i=e[n>>5]>>>n%32&255,o=parseInt(r.charAt(i>>>4&15)+r.charAt(15&i),16);t.push(o)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[i(t)-1]=t;let n=0x67452301,u=-0x10325477,c=-0x67452302,d=0x10325476;for(let t=0;t<e.length;t+=16){let i=n,p=u,f=c,h=d;n=o(n,u,c,d,e[t],7,-0x28955b88),d=o(d,n,u,c,e[t+1],12,-0x173848aa),c=o(c,d,n,u,e[t+2],17,0x242070db),u=o(u,c,d,n,e[t+3],22,-0x3e423112),n=o(n,u,c,d,e[t+4],7,-0xa83f051),d=o(d,n,u,c,e[t+5],12,0x4787c62a),c=o(c,d,n,u,e[t+6],17,-0x57cfb9ed),u=o(u,c,d,n,e[t+7],22,-0x2b96aff),n=o(n,u,c,d,e[t+8],7,0x698098d8),d=o(d,n,u,c,e[t+9],12,-0x74bb0851),c=o(c,d,n,u,e[t+10],17,-42063),u=o(u,c,d,n,e[t+11],22,-0x76a32842),n=o(n,u,c,d,e[t+12],7,0x6b901122),d=o(d,n,u,c,e[t+13],12,-0x2678e6d),c=o(c,d,n,u,e[t+14],17,-0x5986bc72),u=o(u,c,d,n,e[t+15],22,0x49b40821),n=a(n,u,c,d,e[t+1],5,-0x9e1da9e),d=a(d,n,u,c,e[t+6],9,-0x3fbf4cc0),c=a(c,d,n,u,e[t+11],14,0x265e5a51),u=a(u,c,d,n,e[t],20,-0x16493856),n=a(n,u,c,d,e[t+5],5,-0x29d0efa3),d=a(d,n,u,c,e[t+10],9,0x2441453),c=a(c,d,n,u,e[t+15],14,-0x275e197f),u=a(u,c,d,n,e[t+4],20,-0x182c0438),n=a(n,u,c,d,e[t+9],5,0x21e1cde6),d=a(d,n,u,c,e[t+14],9,-0x3cc8f82a),c=a(c,d,n,u,e[t+3],14,-0xb2af279),u=a(u,c,d,n,e[t+8],20,0x455a14ed),n=a(n,u,c,d,e[t+13],5,-0x561c16fb),d=a(d,n,u,c,e[t+2],9,-0x3105c08),c=a(c,d,n,u,e[t+7],14,0x676f02d9),u=a(u,c,d,n,e[t+12],20,-0x72d5b376),n=s(n,u,c,d,e[t+5],4,-378558),d=s(d,n,u,c,e[t+8],11,-0x788e097f),c=s(c,d,n,u,e[t+11],16,0x6d9d6122),u=s(u,c,d,n,e[t+14],23,-0x21ac7f4),n=s(n,u,c,d,e[t+1],4,-0x5b4115bc),d=s(d,n,u,c,e[t+4],11,0x4bdecfa9),c=s(c,d,n,u,e[t+7],16,-0x944b4a0),u=s(u,c,d,n,e[t+10],23,-0x41404390),n=s(n,u,c,d,e[t+13],4,0x289b7ec6),d=s(d,n,u,c,e[t],11,-0x155ed806),c=s(c,d,n,u,e[t+3],16,-0x2b10cf7b),u=s(u,c,d,n,e[t+6],23,0x4881d05),n=s(n,u,c,d,e[t+9],4,-0x262b2fc7),d=s(d,n,u,c,e[t+12],11,-0x1924661b),c=s(c,d,n,u,e[t+15],16,0x1fa27cf8),u=s(u,c,d,n,e[t+2],23,-0x3b53a99b),n=l(n,u,c,d,e[t],6,-0xbd6ddbc),d=l(d,n,u,c,e[t+7],10,0x432aff97),c=l(c,d,n,u,e[t+14],15,-0x546bdc59),u=l(u,c,d,n,e[t+5],21,-0x36c5fc7),n=l(n,u,c,d,e[t+12],6,0x655b59c3),d=l(d,n,u,c,e[t+3],10,-0x70f3336e),c=l(c,d,n,u,e[t+10],15,-1051523),u=l(u,c,d,n,e[t+1],21,-0x7a7ba22f),n=l(n,u,c,d,e[t+8],6,0x6fa87e4f),d=l(d,n,u,c,e[t+15],10,-0x1d31920),c=l(c,d,n,u,e[t+6],15,-0x5cfebcec),u=l(u,c,d,n,e[t+13],21,0x4e0811a1),n=l(n,u,c,d,e[t+4],6,-0x8ac817e),d=l(d,n,u,c,e[t+11],10,-0x42c50dcb),c=l(c,d,n,u,e[t+2],15,0x2ad7d2bb),u=l(u,c,d,n,e[t+9],21,-0x14792c6f),n=r(n,i),u=r(u,p),c=r(c,f),d=r(d,h)}return[n,u,c,d]}(function(e){if(0===e.length)return[];let t=8*e.length,r=new Uint32Array(i(t));for(let i=0;i<t;i+=8)r[i>>5]|=(255&e[i/8])<<i%32;return r}(e),8*e.length))}},46140:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;let i="undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);t.default={randomUUID:i}},14808:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default="00000000-0000-0000-0000-000000000000"},96792:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){return e&&e.__esModule?e:{default:e}}(i(37037));t.default=function(e){let t;if(!(0,r.default)(e))throw TypeError("Invalid UUID");let i=new Uint8Array(16);return i[0]=(t=parseInt(e.slice(0,8),16))>>>24,i[1]=t>>>16&255,i[2]=t>>>8&255,i[3]=255&t,i[4]=(t=parseInt(e.slice(9,13),16))>>>8,i[5]=255&t,i[6]=(t=parseInt(e.slice(14,18),16))>>>8,i[7]=255&t,i[8]=(t=parseInt(e.slice(19,23),16))>>>8,i[9]=255&t,i[10]=(t=parseInt(e.slice(24,36),16))/0x10000000000&255,i[11]=t/0x100000000&255,i[12]=t>>>24&255,i[13]=t>>>16&255,i[14]=t>>>8&255,i[15]=255&t,i}},27656:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},2858:(e,t)=>{"use strict";let i;Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if(!i&&!(i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(r)};let r=new Uint8Array(16)},9042:(e,t)=>{"use strict";function i(e,t){return e<<t|e>>>32-t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default=function(e){let t=[0x5a827999,0x6ed9eba1,0x8f1bbcdc,0xca62c1d6],r=[0x67452301,0xefcdab89,0x98badcfe,0x10325476,0xc3d2e1f0];if("string"==typeof e){let t=unescape(encodeURIComponent(e));e=[];for(let i=0;i<t.length;++i)e.push(t.charCodeAt(i))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);let n=Math.ceil((e.length/4+2)/16),o=Array(n);for(let t=0;t<n;++t){let i=new Uint32Array(16);for(let r=0;r<16;++r)i[r]=e[64*t+4*r]<<24|e[64*t+4*r+1]<<16|e[64*t+4*r+2]<<8|e[64*t+4*r+3];o[t]=i}o[n-1][14]=(e.length-1)*8/0x100000000,o[n-1][14]=Math.floor(o[n-1][14]),o[n-1][15]=(e.length-1)*8&0xffffffff;for(let e=0;e<n;++e){let n=new Uint32Array(80);for(let t=0;t<16;++t)n[t]=o[e][t];for(let e=16;e<80;++e)n[e]=i(n[e-3]^n[e-8]^n[e-14]^n[e-16],1);let a=r[0],s=r[1],l=r[2],u=r[3],c=r[4];for(let e=0;e<80;++e){let r=Math.floor(e/20),o=i(a,5)+function(e,t,i,r){switch(e){case 0:return t&i^~t&r;case 1:case 3:return t^i^r;case 2:return t&i^t&r^i&r}}(r,s,l,u)+c+t[r]+n[e]>>>0;c=u,u=l,l=i(s,30)>>>0,s=a,a=o}r[0]=r[0]+a>>>0,r[1]=r[1]+s>>>0,r[2]=r[2]+l>>>0,r[3]=r[3]+u>>>0,r[4]=r[4]+c>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]}},49910:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.unsafeStringify=o;var r=function(e){return e&&e.__esModule?e:{default:e}}(i(37037));let n=[];for(let e=0;e<256;++e)n.push((e+256).toString(16).slice(1));function o(e,t=0){return n[e[t+0]]+n[e[t+1]]+n[e[t+2]]+n[e[t+3]]+"-"+n[e[t+4]]+n[e[t+5]]+"-"+n[e[t+6]]+n[e[t+7]]+"-"+n[e[t+8]]+n[e[t+9]]+"-"+n[e[t+10]]+n[e[t+11]]+n[e[t+12]]+n[e[t+13]]+n[e[t+14]]+n[e[t+15]]}t.default=function(e,t=0){let i=o(e,t);if(!(0,r.default)(i))throw TypeError("Stringified UUID is invalid");return i}},13518:(e,t,i)=>{"use strict";let r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(e){return e&&e.__esModule?e:{default:e}}(i(2858)),a=i(49910);let s=0,l=0;t.default=function(e,t,i){let u=t&&i||0,c=t||Array(16),d=(e=e||{}).node||r,p=void 0!==e.clockseq?e.clockseq:n;if(null==d||null==p){let t=e.random||(e.rng||o.default)();null==d&&(d=r=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==p&&(p=n=(t[6]<<8|t[7])&16383)}let f=void 0!==e.msecs?e.msecs:Date.now(),h=void 0!==e.nsecs?e.nsecs:l+1,g=f-s+(h-l)/1e4;if(g<0&&void 0===e.clockseq&&(p=p+1&16383),(g<0||f>s)&&void 0===e.nsecs&&(h=0),h>=1e4)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");s=f,l=h,n=p;let m=((0xfffffff&(f+=122192928e5))*1e4+h)%0x100000000;c[u++]=m>>>24&255,c[u++]=m>>>16&255,c[u++]=m>>>8&255,c[u++]=255&m;let E=f/0x100000000*1e4&0xfffffff;c[u++]=E>>>8&255,c[u++]=255&E,c[u++]=E>>>24&15|16,c[u++]=E>>>16&255,c[u++]=p>>>8|128,c[u++]=255&p;for(let e=0;e<6;++e)c[u+e]=d[e];return t||(0,a.unsafeStringify)(c)}},14948:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(i(59025)),n=o(i(44692));function o(e){return e&&e.__esModule?e:{default:e}}let a=(0,r.default)("v3",48,n.default);t.default=a},59025:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.DNS=void 0,t.default=function(e,t,i){function s(e,o,a,s){var l;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));let t=[];for(let i=0;i<e.length;++i)t.push(e.charCodeAt(i));return t}(e)),"string"==typeof o&&(o=(0,n.default)(o)),(null===(l=o)||void 0===l?void 0:l.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let u=new Uint8Array(16+e.length);if(u.set(o),u.set(e,o.length),(u=i(u))[6]=15&u[6]|t,u[8]=63&u[8]|128,a){s=s||0;for(let e=0;e<16;++e)a[s+e]=u[e];return a}return(0,r.unsafeStringify)(u)}try{s.name=e}catch(e){}return s.DNS=o,s.URL=a,s};var r=i(49910),n=function(e){return e&&e.__esModule?e:{default:e}}(i(96792));let o="6ba7b810-9dad-11d1-80b4-00c04fd430c8";t.DNS=o;let a="6ba7b811-9dad-11d1-80b4-00c04fd430c8";t.URL=a},45073:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(i(46140)),n=a(i(2858)),o=i(49910);function a(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t,i){if(r.default.randomUUID&&!t&&!e)return r.default.randomUUID();let a=(e=e||{}).random||(e.rng||n.default)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){i=i||0;for(let e=0;e<16;++e)t[i+e]=a[e];return t}return(0,o.unsafeStringify)(a)}},77186:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(i(59025)),n=o(i(9042));function o(e){return e&&e.__esModule?e:{default:e}}let a=(0,r.default)("v5",80,n.default);t.default=a},37037:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){return e&&e.__esModule?e:{default:e}}(i(27656));t.default=function(e){return"string"==typeof e&&r.default.test(e)}},7775:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){return e&&e.__esModule?e:{default:e}}(i(37037));t.default=function(e){if(!(0,r.default)(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)}}}]);